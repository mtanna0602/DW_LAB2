[0m22:46:31.445598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f77f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7de710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7dee90>]}


============================== 22:46:31.452931 | 6652863e-0f0c-42d6-8015-0e8b7ee822cb ==============================
[0m22:46:31.452931 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:46:31.453456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jobox/.dbt', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:46:32.209493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105db490>]}
[0m22:46:32.244745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110387d50>]}
[0m22:46:32.245754 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:46:32.268149 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:46:32.269068 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:46:32.269409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110572d90>]}
[0m22:46:33.095480 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_mau.example
[0m22:46:33.103205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11070da10>]}
[0m22:46:33.177677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110958f90>]}
[0m22:46:33.178085 [info ] [MainThread]: Found 2 models, 3 sources, 454 macros
[0m22:46:33.178313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ec810>]}
[0m22:46:33.179486 [info ] [MainThread]: 
[0m22:46:33.179857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:46:33.182792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:46:33.191854 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:46:33.192124 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:46:33.192318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:33.878522 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.686 seconds
[0m22:46:33.880462 [debug] [ThreadPool]: On list_dev: Close
[0m22:46:34.204644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m22:46:34.213322 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:46:34.213674 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:46:34.213873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:34.836237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.622 seconds
[0m22:46:34.845800 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:46:35.016966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110841790>]}
[0m22:46:35.019616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:46:35.020335 [info ] [MainThread]: 
[0m22:46:35.026287 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m22:46:35.032788 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.session_timestamp ........................ [RUN]
[0m22:46:35.034328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev, now model.build_mau.session_timestamp)
[0m22:46:35.035699 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m22:46:35.042513 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m22:46:35.043352 [debug] [Thread-1 (]: Began executing node model.build_mau.session_timestamp
[0m22:46:35.082621 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_timestamp"
[0m22:46:35.084406 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_timestamp"
[0m22:46:35.084716 [debug] [Thread-1 (]: On model.build_mau.session_timestamp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_timestamp"} */
create or replace   view dev.analytics.session_timestamp
  
   as (
    SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
  );
[0m22:46:35.084970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:36.254286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.163 seconds
[0m22:46:36.291398 [debug] [Thread-1 (]: On model.build_mau.session_timestamp: Close
[0m22:46:36.420497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108181d0>]}
[0m22:46:36.423493 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 1.38s]
[0m22:46:36.426559 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m22:46:36.431055 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m22:46:36.432089 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.user_session_channel ..................... [RUN]
[0m22:46:36.432519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m22:46:36.432798 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m22:46:36.435343 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m22:46:36.435912 [debug] [Thread-1 (]: Began executing node model.build_mau.user_session_channel
[0m22:46:36.438473 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.user_session_channel"
[0m22:46:36.439468 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.user_session_channel"
[0m22:46:36.439800 [debug] [Thread-1 (]: On model.build_mau.user_session_channel: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.user_session_channel"} */
create or replace   view dev.analytics.user_session_channel
  
   as (
    SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
  );
[0m22:46:36.440071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:37.278949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.837 seconds
[0m22:46:37.288854 [debug] [Thread-1 (]: On model.build_mau.user_session_channel: Close
[0m22:46:37.432756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6652863e-0f0c-42d6-8015-0e8b7ee822cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e7d50>]}
[0m22:46:37.437077 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 1.00s]
[0m22:46:37.438529 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m22:46:37.446401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:37.447559 [debug] [MainThread]: Connection 'model.build_mau.user_session_channel' was properly closed.
[0m22:46:37.448206 [debug] [MainThread]: Connection 'list_dev_analytics' was properly closed.
[0m22:46:37.449610 [info ] [MainThread]: 
[0m22:46:37.451430 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m22:46:37.452517 [debug] [MainThread]: Command end result
[0m22:46:37.494486 [info ] [MainThread]: 
[0m22:46:37.494984 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:46:37.495280 [info ] [MainThread]: 
[0m22:46:37.495601 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:46:37.501715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.160966, "process_user_time": 2.433416, "process_kernel_time": 0.314914, "process_mem_max_rss": "131489792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:46:37.502529 [debug] [MainThread]: Command `dbt run` succeeded at 22:46:37.502416 after 6.16 seconds
[0m22:46:37.503001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a8790>]}
[0m22:46:37.503355 [debug] [MainThread]: Flushing usage events
[0m22:49:31.163820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112077090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120da690>]}


============================== 22:49:31.170849 | 5a78ea41-6b16-49e7-8e46-cce37f8308c7 ==============================
[0m22:49:31.170849 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:49:31.171386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jobox/.dbt', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:49:31.518245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c23590>]}
[0m22:49:31.550524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ecc90>]}
[0m22:49:31.551398 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:49:31.586557 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:49:31.648353 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:49:31.648872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b565d0>]}
[0m22:49:32.507966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ff8450>]}
[0m22:49:32.589729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331c5d0>]}
[0m22:49:32.590256 [info ] [MainThread]: Found 2 models, 3 sources, 454 macros
[0m22:49:32.590508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11318f150>]}
[0m22:49:32.591885 [info ] [MainThread]: 
[0m22:49:32.592278 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:49:32.595435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:49:32.605066 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:49:32.605386 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:49:32.605582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:34.272688 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.667 seconds
[0m22:49:34.278904 [debug] [ThreadPool]: On list_dev: Close
[0m22:49:34.438230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:49:34.452635 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:49:34.453213 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:49:34.453578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:34.886809 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.433 seconds
[0m22:49:34.892206 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:49:35.030373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fada10>]}
[0m22:49:35.031041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:35.031342 [info ] [MainThread]: 
[0m22:49:35.034539 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m22:49:35.035148 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.session_timestamp ........................ [RUN]
[0m22:49:35.035560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_mau.session_timestamp)
[0m22:49:35.035875 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m22:49:35.042579 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m22:49:35.044196 [debug] [Thread-1 (]: Began executing node model.build_mau.session_timestamp
[0m22:49:35.079775 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_timestamp"
[0m22:49:35.080764 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_timestamp"
[0m22:49:35.081132 [debug] [Thread-1 (]: On model.build_mau.session_timestamp: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_timestamp"} */
create or replace   view dev.analytics.session_timestamp
  
   as (
    SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
  );
[0m22:49:35.081401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:35.819107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m22:49:35.857235 [debug] [Thread-1 (]: On model.build_mau.session_timestamp: Close
[0m22:49:36.116826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eaea10>]}
[0m22:49:36.120117 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.session_timestamp ................... [[32mSUCCESS 1[0m in 1.08s]
[0m22:49:36.122445 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m22:49:36.127881 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m22:49:36.130222 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.user_session_channel ..................... [RUN]
[0m22:49:36.131560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m22:49:36.132464 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m22:49:36.141671 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m22:49:36.143296 [debug] [Thread-1 (]: Began executing node model.build_mau.user_session_channel
[0m22:49:36.148725 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.user_session_channel"
[0m22:49:36.150362 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.user_session_channel"
[0m22:49:36.151001 [debug] [Thread-1 (]: On model.build_mau.user_session_channel: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.user_session_channel"} */
create or replace   view dev.analytics.user_session_channel
  
   as (
    SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
  );
[0m22:49:36.151576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:36.883401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m22:49:36.890287 [debug] [Thread-1 (]: On model.build_mau.user_session_channel: Close
[0m22:49:37.028064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a78ea41-6b16-49e7-8e46-cce37f8308c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113167010>]}
[0m22:49:37.028836 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.user_session_channel ................ [[32mSUCCESS 1[0m in 0.90s]
[0m22:49:37.029358 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m22:49:37.031099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:37.031480 [debug] [MainThread]: Connection 'model.build_mau.user_session_channel' was properly closed.
[0m22:49:37.032963 [info ] [MainThread]: 
[0m22:49:37.034217 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m22:49:37.036787 [debug] [MainThread]: Command end result
[0m22:49:37.091220 [info ] [MainThread]: 
[0m22:49:37.091739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:37.092035 [info ] [MainThread]: 
[0m22:49:37.092345 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:49:37.094826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.00668, "process_user_time": 2.411946, "process_kernel_time": 0.311007, "process_mem_max_rss": "133476352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:49:37.095524 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:37.095419 after 6.01 seconds
[0m22:49:37.095904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ba090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d15c6d0>]}
[0m22:49:37.096244 [debug] [MainThread]: Flushing usage events
[0m23:21:10.733630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d84b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d883fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8aa3d0>]}


============================== 23:21:10.740046 | cf05c342-15b3-4054-8049-e037dd36f6c7 ==============================
[0m23:21:10.740046 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:21:10.740539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jobox/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:11.063670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8aa390>]}
[0m23:21:11.099158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c8c50>]}
[0m23:21:11.100152 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:21:11.119380 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:21:11.179530 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:21:11.180026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3da290>]}
[0m23:21:11.957684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.build_mau.output
[0m23:21:11.965862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea2a950>]}
[0m23:21:12.044653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eae55d0>]}
[0m23:21:12.045114 [info ] [MainThread]: Found 2 models, 3 sources, 454 macros
[0m23:21:12.045379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e76d0>]}
[0m23:21:12.046723 [info ] [MainThread]: 
[0m23:21:12.047148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:21:12.047556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf05c342-15b3-4054-8049-e037dd36f6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea18c50>]}
[0m23:21:12.047941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:12.048162 [info ] [MainThread]: 
[0m23:21:12.050642 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m23:21:12.051111 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.build_mau.session_timestamp'
[0m23:21:12.051385 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m23:21:12.057384 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m23:21:12.058513 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m23:21:12.058829 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m23:21:12.059147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m23:21:12.059392 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m23:21:12.061363 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m23:21:12.062082 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m23:21:12.062851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:12.063063 [debug] [MainThread]: Connection 'model.build_mau.user_session_channel' was properly closed.
[0m23:21:12.063533 [info ] [MainThread]: 
[0m23:21:12.063753 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m23:21:12.064056 [debug] [MainThread]: Command end result
[0m23:21:12.088979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4234886, "process_user_time": 1.945972, "process_kernel_time": 0.231623, "process_mem_max_rss": "129523712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:21:12.089477 [debug] [MainThread]: Command `dbt run` succeeded at 23:21:12.089405 after 1.42 seconds
[0m23:21:12.089781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d711510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108879f90>]}
[0m23:21:12.090025 [debug] [MainThread]: Flushing usage events
[0m23:34:41.033767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e04f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e08dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ae890>]}


============================== 23:34:41.040054 | 8a03bcf6-425e-48ca-993e-f50963dbce87 ==============================
[0m23:34:41.040054 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:34:41.040529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'version_check': 'True', 'profiles_dir': '/Users/jobox/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:34:41.375318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07d290>]}
[0m23:34:41.410493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc0a9d0>]}
[0m23:34:41.411451 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:34:41.438494 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:34:41.528349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:34:41.528860 [debug] [MainThread]: Partial parsing: added file: build_mau://models/output/session_summary.sql
[0m23:34:41.681518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef58190>]}
[0m23:34:41.807494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef71950>]}
[0m23:34:41.807890 [info ] [MainThread]: Found 3 models, 3 sources, 454 macros
[0m23:34:41.808125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f188310>]}
[0m23:34:41.809288 [info ] [MainThread]: 
[0m23:34:41.809684 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:34:41.810318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:34:41.819141 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:34:41.819415 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:34:41.819607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:42.496819 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.677 seconds
[0m23:34:42.499999 [debug] [ThreadPool]: On list_dev: Close
[0m23:34:42.634932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:34:42.642060 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:34:42.642423 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:34:42.642641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:44.112144 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.469 seconds
[0m23:34:44.114897 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:34:44.246297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee698d0>]}
[0m23:34:44.247213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:34:44.247668 [info ] [MainThread]: 
[0m23:34:44.250949 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m23:34:44.251610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_mau.session_timestamp)
[0m23:34:44.252130 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m23:34:44.262445 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m23:34:44.264469 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m23:34:44.265001 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m23:34:44.265555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m23:34:44.265996 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m23:34:44.269045 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m23:34:44.270080 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m23:34:44.270835 [debug] [Thread-1 (]: Began running node model.build_mau.session_summary
[0m23:34:44.271390 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m23:34:44.271854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.user_session_channel, now model.build_mau.session_summary)
[0m23:34:44.272216 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_summary
[0m23:34:44.277664 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_summary"
[0m23:34:44.278486 [debug] [Thread-1 (]: Began executing node model.build_mau.session_summary
[0m23:34:44.306441 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_summary"
[0m23:34:44.307899 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_summary"
[0m23:34:44.308211 [debug] [Thread-1 (]: On model.build_mau.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_summary"} */
create or replace transient table dev.analytics.session_summary
         as
        (WITH  __dbt__cte__user_session_channel as (
SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
),  __dbt__cte__session_timestamp as (
SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
), u AS (
    SELECT * FROM __dbt__cte__user_session_channel
), st AS (
    SELECT * FROM __dbt__cte__session_timestamp
)
SELECT u.userId, u.sessionId, u.channel, st.ts
FROM u
JOIN st ON u.sessionId = st.sessionId
        );
[0m23:34:44.308487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:46.718911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.410 seconds
[0m23:34:46.747801 [debug] [Thread-1 (]: On model.build_mau.session_summary: Close
[0m23:34:46.871841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a03bcf6-425e-48ca-993e-f50963dbce87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efccf90>]}
[0m23:34:46.873576 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.60s]
[0m23:34:46.874676 [debug] [Thread-1 (]: Finished running node model.build_mau.session_summary
[0m23:34:46.877343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:46.877863 [debug] [MainThread]: Connection 'model.build_mau.session_summary' was properly closed.
[0m23:34:46.878370 [info ] [MainThread]: 
[0m23:34:46.878883 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m23:34:46.879933 [debug] [MainThread]: Command end result
[0m23:34:46.922633 [info ] [MainThread]: 
[0m23:34:46.923070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:46.923313 [info ] [MainThread]: 
[0m23:34:46.923572 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:34:46.925545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9578266, "process_user_time": 1.702028, "process_kernel_time": 0.259208, "process_mem_max_rss": "138608640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:46.926584 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:46.926511 after 5.96 seconds
[0m23:34:46.926879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeab650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b9ed0>]}
[0m23:34:46.927127 [debug] [MainThread]: Flushing usage events
[0m23:52:32.428985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e4fd0>]}


============================== 23:52:32.434898 | 7142c4f3-a726-4c8f-a9f7-5e6f18a4da33 ==============================
[0m23:52:32.434898 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:52:32.435367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'profiles_dir': '/Users/jobox/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:52:33.133172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e83010>]}
[0m23:52:33.164914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f18c10>]}
[0m23:52:33.165650 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:52:33.184076 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:52:33.273527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:52:33.273984 [debug] [MainThread]: Partial parsing: added file: build_mau://snapshots/snapshot_session_summary.sql
[0m23:52:33.445138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137413d0>]}
[0m23:52:33.576138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135719d0>]}
[0m23:52:33.576570 [info ] [MainThread]: Found 3 models, 1 snapshot, 3 sources, 454 macros
[0m23:52:33.577000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113742350>]}
[0m23:52:33.578230 [info ] [MainThread]: 
[0m23:52:33.578609 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:52:33.579323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:52:33.588729 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:52:33.589117 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:52:33.589350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:34.126675 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.537 seconds
[0m23:52:34.129520 [debug] [ThreadPool]: On list_dev: Close
[0m23:52:34.268508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m23:52:34.282273 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:52:34.282839 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:52:34.283232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:34.940518 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.657 seconds
[0m23:52:34.944821 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:52:35.076744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m23:52:35.082423 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:52:35.083027 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:52:35.083503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:52:35.725127 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.641 seconds
[0m23:52:35.728193 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:52:35.880455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11338bf90>]}
[0m23:52:35.884998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:52:35.885922 [info ] [MainThread]: 
[0m23:52:35.891210 [debug] [Thread-1 (]: Began running node snapshot.build_mau.snapshot_session_summary
[0m23:52:35.892232 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m23:52:35.894668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.build_mau.snapshot_session_summary)
[0m23:52:35.895012 [debug] [Thread-1 (]: Began compiling node snapshot.build_mau.snapshot_session_summary
[0m23:52:35.917883 [debug] [Thread-1 (]: Began executing node snapshot.build_mau.snapshot_session_summary
[0m23:52:36.033592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m23:52:36.034023 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        nullif(ts, ts) as dbt_valid_to
    from (
        



SELECT * FROM dev.analytics.session_summary

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:52:36.034315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:36.906157 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.871 seconds
[0m23:52:36.913775 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m23:52:36.914277 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m23:52:37.012462 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.097 seconds
[0m23:52:37.015859 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.build_mau.snapshot_session_summary"
[0m23:52:37.018431 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m23:52:37.018987 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
create or replace transient table dev.snapshot.snapshot_session_summary
         as
        (
    

    select *,
        md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id,
        ts as dbt_updated_at,
        ts as dbt_valid_from,
        nullif(ts, ts) as dbt_valid_to
    from (
        



SELECT * FROM dev.analytics.session_summary

    ) sbq



        );
[0m23:52:38.584441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.564 seconds
[0m23:52:38.621519 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: Close
[0m23:52:38.736814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7142c4f3-a726-4c8f-a9f7-5e6f18a4da33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a3450>]}
[0m23:52:38.738194 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 1[0m in 2.84s]
[0m23:52:38.739150 [debug] [Thread-1 (]: Finished running node snapshot.build_mau.snapshot_session_summary
[0m23:52:38.741386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:38.741789 [debug] [MainThread]: Connection 'snapshot.build_mau.snapshot_session_summary' was properly closed.
[0m23:52:38.742187 [info ] [MainThread]: 
[0m23:52:38.742656 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m23:52:38.743706 [debug] [MainThread]: Command end result
[0m23:52:38.779756 [info ] [MainThread]: 
[0m23:52:38.780238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:38.780505 [info ] [MainThread]: 
[0m23:52:38.780770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:52:38.785596 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.445205, "process_user_time": 1.875648, "process_kernel_time": 0.249785, "process_mem_max_rss": "138936320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:52:38.786128 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:52:38.786043 after 6.45 seconds
[0m23:52:38.786454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126054d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112606710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c9e90>]}
[0m23:52:38.786765 [debug] [MainThread]: Flushing usage events
[0m23:59:26.553135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7ff010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7feb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f862510>]}


============================== 23:59:26.559318 | 901c9323-bf8a-40c5-9b9b-69a6fa19ea8f ==============================
[0m23:59:26.559318 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:26.559788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jobox/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:26.909969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '901c9323-bf8a-40c5-9b9b-69a6fa19ea8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f846a10>]}
[0m23:59:26.943913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '901c9323-bf8a-40c5-9b9b-69a6fa19ea8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e37a890>]}
[0m23:59:26.944855 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:59:26.965357 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:27.073498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:59:27.074096 [debug] [MainThread]: Partial parsing: added file: build_mau://models/schema.yml
[0m23:59:27.249112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '901c9323-bf8a-40c5-9b9b-69a6fa19ea8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108f1990>]}
[0m23:59:27.395618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '901c9323-bf8a-40c5-9b9b-69a6fa19ea8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106c1610>]}
[0m23:59:27.396029 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m23:59:27.396272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '901c9323-bf8a-40c5-9b9b-69a6fa19ea8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c2550>]}
[0m23:59:27.397478 [info ] [MainThread]: 
[0m23:59:27.397854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:59:27.398568 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m23:59:27.408845 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:59:27.409089 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:59:27.409281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:28.268567 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.857 seconds
[0m23:59:28.275211 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:59:28.450317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m23:59:28.457921 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:59:28.458469 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:59:28.458866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:28.940015 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.481 seconds
[0m23:59:28.944092 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:59:29.124562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '901c9323-bf8a-40c5-9b9b-69a6fa19ea8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a4850>]}
[0m23:59:29.125852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:59:29.126416 [info ] [MainThread]: 
[0m23:59:29.131662 [debug] [Thread-1 (]: Began running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m23:59:29.132412 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m23:59:29.133147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6)
[0m23:59:29.133732 [debug] [Thread-1 (]: Began compiling node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m23:59:29.155833 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m23:59:29.157200 [debug] [Thread-1 (]: Began executing node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m23:59:29.176117 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m23:59:29.177265 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m23:59:29.177595 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from dev.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m23:59:29.177891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:30.626259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.448 seconds
[0m23:59:30.648309 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m23:59:30.774859 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 1.64s]
[0m23:59:30.776030 [debug] [Thread-1 (]: Finished running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m23:59:30.776569 [debug] [Thread-1 (]: Began running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m23:59:30.777267 [info ] [Thread-1 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m23:59:30.777822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6, now test.build_mau.unique_session_summary_sessionId.9c5e5661a0)
[0m23:59:30.778245 [debug] [Thread-1 (]: Began compiling node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m23:59:30.788128 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m23:59:30.788932 [debug] [Thread-1 (]: Began executing node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m23:59:30.791861 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m23:59:30.792976 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m23:59:30.793409 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from dev.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:59:30.793843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:31.261945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m23:59:31.266549 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: Close
[0m23:59:31.410425 [info ] [Thread-1 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.63s]
[0m23:59:31.411935 [debug] [Thread-1 (]: Finished running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m23:59:31.414668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:31.415235 [debug] [MainThread]: Connection 'test.build_mau.unique_session_summary_sessionId.9c5e5661a0' was properly closed.
[0m23:59:31.415762 [info ] [MainThread]: 
[0m23:59:31.416263 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m23:59:31.417463 [debug] [MainThread]: Command end result
[0m23:59:31.454614 [info ] [MainThread]: 
[0m23:59:31.455067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:31.455333 [info ] [MainThread]: 
[0m23:59:31.455610 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:59:31.458090 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.9695735, "process_user_time": 1.84878, "process_kernel_time": 0.273256, "process_mem_max_rss": "141332480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:59:31.458553 [debug] [MainThread]: Command `dbt test` succeeded at 23:59:31.458477 after 4.97 seconds
[0m23:59:31.458857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9afe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a825e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e4890>]}
[0m23:59:31.459164 [debug] [MainThread]: Flushing usage events
[0m00:01:10.511251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e6ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed2d50>]}


============================== 00:01:10.517573 | 85f21aaa-b0c3-4dc5-92aa-7d395828f4c7 ==============================
[0m00:01:10.517573 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:10.518118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jobox/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:10.843258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85f21aaa-b0c3-4dc5-92aa-7d395828f4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca4cd0>]}
[0m00:01:10.877549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85f21aaa-b0c3-4dc5-92aa-7d395828f4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ea990>]}
[0m00:01:10.878520 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:01:10.898196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:11.012490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:11.012886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:11.049895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85f21aaa-b0c3-4dc5-92aa-7d395828f4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119c4410>]}
[0m00:01:11.072012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85f21aaa-b0c3-4dc5-92aa-7d395828f4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d51010>]}
[0m00:01:11.072418 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m00:01:11.072660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f21aaa-b0c3-4dc5-92aa-7d395828f4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dd5d10>]}
[0m00:01:11.074066 [info ] [MainThread]: 
[0m00:01:11.074480 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:11.075289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m00:01:11.088815 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:01:11.089106 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:01:11.089309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:11.763567 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.674 seconds
[0m00:01:11.767207 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:01:11.893476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:01:11.899906 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:01:11.900463 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:01:11.900936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:12.542138 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.641 seconds
[0m00:01:12.546652 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:01:12.700880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85f21aaa-b0c3-4dc5-92aa-7d395828f4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c78790>]}
[0m00:01:12.702281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:12.702838 [info ] [MainThread]: 
[0m00:01:12.707949 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m00:01:12.708736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_mau.session_timestamp)
[0m00:01:12.709229 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m00:01:12.719765 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m00:01:12.721011 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m00:01:12.721291 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m00:01:12.721532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m00:01:12.721747 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m00:01:12.724571 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m00:01:12.725777 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m00:01:12.726179 [debug] [Thread-1 (]: Began running node snapshot.build_mau.snapshot_session_summary
[0m00:01:12.726647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.user_session_channel, now snapshot.build_mau.snapshot_session_summary)
[0m00:01:12.727011 [debug] [Thread-1 (]: Began compiling node snapshot.build_mau.snapshot_session_summary
[0m00:01:12.730292 [debug] [Thread-1 (]: Began executing node snapshot.build_mau.snapshot_session_summary
[0m00:01:12.730887 [debug] [Thread-1 (]: Finished running node snapshot.build_mau.snapshot_session_summary
[0m00:01:12.731236 [debug] [Thread-1 (]: Began running node model.build_mau.session_summary
[0m00:01:12.731591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.build_mau.snapshot_session_summary, now model.build_mau.session_summary)
[0m00:01:12.731895 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_summary
[0m00:01:12.736792 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_summary"
[0m00:01:12.738203 [debug] [Thread-1 (]: Began executing node model.build_mau.session_summary
[0m00:01:12.738993 [debug] [Thread-1 (]: Finished running node model.build_mau.session_summary
[0m00:01:12.739860 [debug] [Thread-1 (]: Began running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m00:01:12.740384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_summary, now test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6)
[0m00:01:12.740960 [debug] [Thread-1 (]: Began compiling node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m00:01:12.751483 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m00:01:12.752255 [debug] [Thread-1 (]: Began executing node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m00:01:12.752859 [debug] [Thread-1 (]: Finished running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m00:01:12.753165 [debug] [Thread-1 (]: Began running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m00:01:12.753443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6, now test.build_mau.unique_session_summary_sessionId.9c5e5661a0)
[0m00:01:12.753795 [debug] [Thread-1 (]: Began compiling node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m00:01:12.759391 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m00:01:12.759975 [debug] [Thread-1 (]: Began executing node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m00:01:12.760689 [debug] [Thread-1 (]: Finished running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m00:01:12.761466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:12.761788 [debug] [MainThread]: Connection 'test.build_mau.unique_session_summary_sessionId.9c5e5661a0' was properly closed.
[0m00:01:12.762547 [debug] [MainThread]: Command end result
[0m00:01:12.892017 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m00:01:12.892332 [info ] [MainThread]: Building catalog
[0m00:01:12.901221 [debug] [ThreadPool]: Acquiring new snowflake connection 'dev.information_schema'
[0m00:01:12.911826 [debug] [ThreadPool]: Using snowflake connection "dev.information_schema"
[0m00:01:12.912245 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from dev.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_session_summary' and upper("table_name") = upper('snapshot_session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from dev.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'snapshot' and upper("table_schema") = upper('snapshot')

                    and 
    "table_name" ilike 'snapshot_session_summary' and upper("table_name") = upper('snapshot_session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'session_summary' and upper("table_name") = upper('session_summary')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'user_session_channel' and upper("table_name") = upper('user_session_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'raw_data' and upper("table_schema") = upper('raw_data')

                    and 
    "table_name" ilike 'session_timestamp' and upper("table_name") = upper('session_timestamp')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m00:01:12.912630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:17.071430 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 4.158 seconds
[0m00:01:17.098822 [debug] [ThreadPool]: On dev.information_schema: Close
[0m00:01:17.315680 [info ] [MainThread]: Catalog written to /Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/target/catalog.json
[0m00:01:17.318297 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.8743567, "process_user_time": 1.714635, "process_kernel_time": 0.272947, "process_mem_max_rss": "138244096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:01:17.318998 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:01:17.318880 after 6.88 seconds
[0m00:01:17.319410 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:01:17.319870 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m00:01:17.320186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d31710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce95f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf54810>]}
[0m00:01:17.320524 [debug] [MainThread]: Flushing usage events
[0m00:02:52.422480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110474590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d6490>]}


============================== 00:02:52.428522 | 9907027b-490a-4f24-b3dd-3a5bbcb35bf1 ==============================
[0m00:02:52.428522 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:02:52.428980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jobox/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week10/build_mau/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m00:02:52.760051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9907027b-490a-4f24-b3dd-3a5bbcb35bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f46d0>]}
[0m00:02:52.795772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9907027b-490a-4f24-b3dd-3a5bbcb35bf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdf0b10>]}
[0m04:18:13.749450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1235ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2193080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1235e50>]}


============================== 04:18:13.754311 | 5eed7082-53b1-4330-9ad9-08b8de950f71 ==============================
[0m04:18:13.754311 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:18:13.754869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:18:14.316292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b1baa0>]}
[0m04:18:14.342612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f7cf20>]}
[0m04:18:14.343226 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:18:14.349163 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:18:14.422201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:14.422668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:14.450071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf224e0>]}
[0m04:18:14.516286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd79e50>]}
[0m04:18:14.516688 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m04:18:14.517098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90123e30>]}
[0m04:18:14.518496 [info ] [MainThread]: 
[0m04:18:14.519039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:18:14.519664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:18:14.527528 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:18:14.527819 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:18:14.528029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:15.599401 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.071 seconds
[0m04:18:15.602686 [debug] [ThreadPool]: On list_dev: Close
[0m04:18:15.741217 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:18:15.747803 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:18:15.748230 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:18:15.748483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:16.289085 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.540 seconds
[0m04:18:16.292954 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:18:16.470676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:18:16.475718 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:18:16.476375 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:18:16.476955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:17.189546 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.712 seconds
[0m04:18:17.191477 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:18:17.310175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd25850>]}
[0m04:18:17.311265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:18:17.311892 [info ] [MainThread]: 
[0m04:18:17.321442 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m04:18:17.322268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.build_mau.session_timestamp)
[0m04:18:17.322773 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m04:18:17.330007 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m04:18:17.332090 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m04:18:17.332657 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m04:18:17.333209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m04:18:17.333642 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m04:18:17.336078 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m04:18:17.337161 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m04:18:17.337806 [debug] [Thread-1 (]: Began running node model.build_mau.session_summary
[0m04:18:17.338396 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m04:18:17.338891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.user_session_channel, now model.build_mau.session_summary)
[0m04:18:17.339306 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_summary
[0m04:18:17.342980 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_summary"
[0m04:18:17.344376 [debug] [Thread-1 (]: Began executing node model.build_mau.session_summary
[0m04:18:17.364557 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_summary"
[0m04:18:17.366232 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_summary"
[0m04:18:17.366607 [debug] [Thread-1 (]: On model.build_mau.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_summary"} */
create or replace transient table dev.analytics.session_summary
         as
        (WITH  __dbt__cte__user_session_channel as (
SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
),  __dbt__cte__session_timestamp as (
SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
), u AS (
    SELECT * FROM __dbt__cte__user_session_channel
), st AS (
    SELECT * FROM __dbt__cte__session_timestamp
)
SELECT u.userId, u.sessionId, u.channel, st.ts
FROM u
JOIN st ON u.sessionId = st.sessionId
        );
[0m04:18:17.366976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:18:20.178115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.810 seconds
[0m04:18:20.212798 [debug] [Thread-1 (]: On model.build_mau.session_summary: Close
[0m04:18:20.358480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5eed7082-53b1-4330-9ad9-08b8de950f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1995bb0>]}
[0m04:18:20.360198 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.02s]
[0m04:18:20.361484 [debug] [Thread-1 (]: Finished running node model.build_mau.session_summary
[0m04:18:20.363794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:20.364430 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m04:18:20.364836 [debug] [MainThread]: Connection 'model.build_mau.session_summary' was properly closed.
[0m04:18:20.365352 [info ] [MainThread]: 
[0m04:18:20.365918 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m04:18:20.367075 [debug] [MainThread]: Command end result
[0m04:18:20.399753 [info ] [MainThread]: 
[0m04:18:20.400254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:20.400619 [info ] [MainThread]: 
[0m04:18:20.401093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:18:20.402402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.701208, "process_user_time": 2.846367, "process_kernel_time": 0.255142, "process_mem_max_rss": "207636", "process_in_blocks": "2192", "process_out_blocks": "3332"}
[0m04:18:20.403060 [debug] [MainThread]: Command `dbt run` succeeded at 04:18:20.402921 after 6.70 seconds
[0m04:18:20.403521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2193080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf44a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14deb70>]}
[0m04:18:20.403856 [debug] [MainThread]: Flushing usage events
[0m04:18:34.198465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6c2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6c20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6c2480>]}


============================== 04:18:34.202969 | 6f614b9a-8276-4af1-b2b3-11b4af8815c2 ==============================
[0m04:18:34.202969 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:18:34.203493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:18:34.653991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f614b9a-8276-4af1-b2b3-11b4af8815c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69a09c10>]}
[0m04:18:34.680538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f614b9a-8276-4af1-b2b3-11b4af8815c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff696f6270>]}
[0m04:18:34.681307 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:18:34.687482 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:18:34.758037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:34.758505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:34.784973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f614b9a-8276-4af1-b2b3-11b4af8815c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0d9f40>]}
[0m04:18:34.857197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f614b9a-8276-4af1-b2b3-11b4af8815c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff692bb5f0>]}
[0m04:18:34.857627 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m04:18:34.857967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f614b9a-8276-4af1-b2b3-11b4af8815c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6952e990>]}
[0m04:18:34.859149 [info ] [MainThread]: 
[0m04:18:34.859642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:18:34.860413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:18:34.869322 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:18:34.869823 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:18:34.870154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:35.671406 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.801 seconds
[0m04:18:35.673092 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:18:35.855873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:18:35.858850 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:18:35.859221 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:18:35.859512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:36.496951 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.637 seconds
[0m04:18:36.501142 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:18:36.646751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f614b9a-8276-4af1-b2b3-11b4af8815c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d8d700>]}
[0m04:18:36.648476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:18:36.649615 [info ] [MainThread]: 
[0m04:18:36.662563 [debug] [Thread-1 (]: Began running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:18:36.663589 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m04:18:36.664751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6)
[0m04:18:36.665461 [debug] [Thread-1 (]: Began compiling node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:18:36.680507 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m04:18:36.681984 [debug] [Thread-1 (]: Began executing node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:18:36.695171 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m04:18:36.696565 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m04:18:36.697059 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from dev.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m04:18:36.697433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:18:37.379720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m04:18:37.395959 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m04:18:37.517479 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.85s]
[0m04:18:37.518372 [debug] [Thread-1 (]: Finished running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:18:37.518835 [debug] [Thread-1 (]: Began running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:18:37.519332 [info ] [Thread-1 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m04:18:37.519947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6, now test.build_mau.unique_session_summary_sessionId.9c5e5661a0)
[0m04:18:37.520409 [debug] [Thread-1 (]: Began compiling node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:18:37.524972 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m04:18:37.526001 [debug] [Thread-1 (]: Began executing node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:18:37.527633 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m04:18:37.528488 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m04:18:37.528802 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from dev.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m04:18:37.529079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:18:38.024195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m04:18:38.028737 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: Close
[0m04:18:38.167797 [info ] [Thread-1 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.65s]
[0m04:18:38.169273 [debug] [Thread-1 (]: Finished running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:18:38.170739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:38.171196 [debug] [MainThread]: Connection 'test.build_mau.unique_session_summary_sessionId.9c5e5661a0' was properly closed.
[0m04:18:38.171581 [info ] [MainThread]: 
[0m04:18:38.171999 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m04:18:38.172813 [debug] [MainThread]: Command end result
[0m04:18:38.204342 [info ] [MainThread]: 
[0m04:18:38.204907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:38.205394 [info ] [MainThread]: 
[0m04:18:38.205836 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:18:38.206739 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.060503, "process_user_time": 2.700663, "process_kernel_time": 0.154821, "process_mem_max_rss": "207132", "process_out_blocks": "1836", "process_in_blocks": "0"}
[0m04:18:38.207287 [debug] [MainThread]: Command `dbt test` succeeded at 04:18:38.207206 after 4.06 seconds
[0m04:18:38.207639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f00b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abee1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff697015e0>]}
[0m04:18:38.207956 [debug] [MainThread]: Flushing usage events
[0m04:18:45.228683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e97f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb393ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c61c10>]}


============================== 04:18:45.233183 | 1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a ==============================
[0m04:18:45.233183 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:18:45.233611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:18:45.681572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd92a50>]}
[0m04:18:45.709347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd7b980>]}
[0m04:18:45.710066 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:18:45.716464 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:18:45.786227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:18:45.786624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:18:45.813497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b98a4e0>]}
[0m04:18:45.880408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7a2720>]}
[0m04:18:45.880822 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m04:18:45.881121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9a5190>]}
[0m04:18:45.882238 [info ] [MainThread]: 
[0m04:18:45.882836 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:18:45.883641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:18:45.891758 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:18:45.892145 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:18:45.892469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:46.314528 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.422 seconds
[0m04:18:46.316269 [debug] [ThreadPool]: On list_dev: Close
[0m04:18:46.443624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m04:18:46.451962 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:18:46.452511 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:18:46.452829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:46.923436 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.470 seconds
[0m04:18:46.925930 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:18:47.048667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:18:47.051399 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:18:47.051835 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:18:47.052178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:47.611307 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.559 seconds
[0m04:18:47.625741 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:18:47.753359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b751310>]}
[0m04:18:47.754634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:18:47.755120 [info ] [MainThread]: 
[0m04:18:47.768572 [debug] [Thread-1 (]: Began running node snapshot.build_mau.snapshot_session_summary
[0m04:18:47.769725 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m04:18:47.770558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.build_mau.snapshot_session_summary)
[0m04:18:47.771146 [debug] [Thread-1 (]: Began compiling node snapshot.build_mau.snapshot_session_summary
[0m04:18:47.779335 [debug] [Thread-1 (]: Began executing node snapshot.build_mau.snapshot_session_summary
[0m04:18:47.814551 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:47.815071 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m04:18:47.815431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:18:49.236170 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.420 seconds
[0m04:18:49.274135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:49.274803 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.session_summary


    ),

    snapshotted_data as (

        select *,
            sessionId as dbt_unique_key

        from "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            nullif(ts, ts) as dbt_valid_to,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            sessionId as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.ts)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:18:50.761147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.484 seconds
[0m04:18:50.766532 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:50.767368 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m04:18:50.891703 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.124 seconds
[0m04:18:50.895186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:50.895639 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m04:18:51.064620 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.168 seconds
[0m04:18:51.067606 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.068096 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m04:18:51.143794 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.075 seconds
[0m04:18:51.147232 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.147714 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m04:18:51.264830 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.116 seconds
[0m04:18:51.275139 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.276018 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m04:18:51.383566 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.107 seconds
[0m04:18:51.396724 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.397437 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.session_summary


    ),

    snapshotted_data as (

        select *,
            sessionId as dbt_unique_key

        from "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            nullif(ts, ts) as dbt_valid_to,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            sessionId as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.ts)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:18:51.548737 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m04:18:51.551552 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.551942 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:18:51.691677 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.138 seconds
[0m04:18:51.694101 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.695906 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.696213 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
BEGIN
[0m04:18:51.807692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m04:18:51.808171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:51.808427 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:18:52.049624 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.241 seconds
[0m04:18:52.051270 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:18:52.051754 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
COMMIT
[0m04:18:52.193264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m04:18:52.214040 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: Close
[0m04:18:52.343023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aab1fb4-1488-4c51-aeb4-2fe5f848dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12b9b20>]}
[0m04:18:52.343932 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 4.57s]
[0m04:18:52.344594 [debug] [Thread-1 (]: Finished running node snapshot.build_mau.snapshot_session_summary
[0m04:18:52.345937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:52.346246 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m04:18:52.346502 [debug] [MainThread]: Connection 'snapshot.build_mau.snapshot_session_summary' was properly closed.
[0m04:18:52.346771 [info ] [MainThread]: 
[0m04:18:52.347088 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m04:18:52.347678 [debug] [MainThread]: Command end result
[0m04:18:52.371706 [info ] [MainThread]: 
[0m04:18:52.372194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:52.372539 [info ] [MainThread]: 
[0m04:18:52.372884 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:18:52.373653 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.1947603, "process_user_time": 2.865968, "process_kernel_time": 0.143556, "process_mem_max_rss": "206864", "process_out_blocks": "1851", "process_in_blocks": "0"}
[0m04:18:52.374065 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:18:52.373996 after 7.20 seconds
[0m04:18:52.374373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c61ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08735c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0873bf0>]}
[0m04:18:52.374654 [debug] [MainThread]: Flushing usage events
[0m04:32:22.319065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b60f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7343b0>]}


============================== 04:32:22.324064 | e85d2c69-b7d4-43be-a03c-099f62bdc21a ==============================
[0m04:32:22.324064 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:32:22.324602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m04:32:22.794897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79215af0>]}
[0m04:32:22.821521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d4acc0>]}
[0m04:32:22.822488 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:32:22.829411 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:32:22.902729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:32:22.903147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:32:22.930878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7905a3c0>]}
[0m04:32:23.002931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78cdcbf0>]}
[0m04:32:23.003291 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m04:32:23.003512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7905a780>]}
[0m04:32:23.004619 [info ] [MainThread]: 
[0m04:32:23.005271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:32:23.006103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:32:23.014315 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:32:23.014877 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:32:23.015249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:32:23.533970 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.519 seconds
[0m04:32:23.535188 [debug] [ThreadPool]: On list_dev: Close
[0m04:32:23.677963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:32:23.685142 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:32:23.685571 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:32:23.685861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:32:24.064558 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.378 seconds
[0m04:32:24.067073 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:32:24.182963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:32:24.184976 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:32:24.185301 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:32:24.185515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:32:24.649263 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.464 seconds
[0m04:32:24.652128 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:32:24.763800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998ce300>]}
[0m04:32:24.764539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:32:24.764902 [info ] [MainThread]: 
[0m04:32:24.776036 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m04:32:24.776634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.build_mau.session_timestamp)
[0m04:32:24.776914 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m04:32:24.781328 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m04:32:24.783902 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m04:32:24.784239 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m04:32:24.784600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m04:32:24.784863 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m04:32:24.786453 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m04:32:24.787400 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m04:32:24.788203 [debug] [Thread-1 (]: Began running node model.build_mau.session_summary
[0m04:32:24.788800 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m04:32:24.789296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.user_session_channel, now model.build_mau.session_summary)
[0m04:32:24.789686 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_summary
[0m04:32:24.792710 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_summary"
[0m04:32:24.793448 [debug] [Thread-1 (]: Began executing node model.build_mau.session_summary
[0m04:32:24.813582 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_summary"
[0m04:32:24.815186 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_summary"
[0m04:32:24.815646 [debug] [Thread-1 (]: On model.build_mau.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_summary"} */
create or replace transient table dev.analytics.session_summary
         as
        (WITH  __dbt__cte__user_session_channel as (
SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
),  __dbt__cte__session_timestamp as (
SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
), u AS (
    SELECT * FROM __dbt__cte__user_session_channel
), st AS (
    SELECT * FROM __dbt__cte__session_timestamp
)
SELECT u.userId, u.sessionId, u.channel, st.ts
FROM u
JOIN st ON u.sessionId = st.sessionId
        );
[0m04:32:24.816105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:32:27.658629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.842 seconds
[0m04:32:27.683112 [debug] [Thread-1 (]: On model.build_mau.session_summary: Close
[0m04:32:27.804085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e85d2c69-b7d4-43be-a03c-099f62bdc21a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a879610>]}
[0m04:32:27.804775 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 3.01s]
[0m04:32:27.805211 [debug] [Thread-1 (]: Finished running node model.build_mau.session_summary
[0m04:32:27.806782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:32:27.807361 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m04:32:27.807662 [debug] [MainThread]: Connection 'model.build_mau.session_summary' was properly closed.
[0m04:32:27.807923 [info ] [MainThread]: 
[0m04:32:27.808209 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m04:32:27.808931 [debug] [MainThread]: Command end result
[0m04:32:27.839739 [info ] [MainThread]: 
[0m04:32:27.840157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:32:27.840529 [info ] [MainThread]: 
[0m04:32:27.841100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:32:27.841998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.571606, "process_user_time": 2.669781, "process_kernel_time": 0.216608, "process_mem_max_rss": "204736", "process_out_blocks": "1836", "process_in_blocks": "0"}
[0m04:32:27.842475 [debug] [MainThread]: Command `dbt run` succeeded at 04:32:27.842386 after 5.57 seconds
[0m04:32:27.842782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8d57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f5cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0753a0>]}
[0m04:32:27.843051 [debug] [MainThread]: Flushing usage events
[0m04:32:29.680794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867370b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e27080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860db440>]}


============================== 04:32:29.684584 | 15bb7219-7638-4ed8-a481-99fc4743a9dd ==============================
[0m04:32:29.684584 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:32:29.684906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:32:30.105183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15bb7219-7638-4ed8-a481-99fc4743a9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8610f5f0>]}
[0m04:32:30.131138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15bb7219-7638-4ed8-a481-99fc4743a9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65bae2a0>]}
[0m04:32:30.131860 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:32:30.137854 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:32:30.207718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:32:30.208126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:32:30.234435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15bb7219-7638-4ed8-a481-99fc4743a9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64dfa9c0>]}
[0m04:32:30.302332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15bb7219-7638-4ed8-a481-99fc4743a9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649eca40>]}
[0m04:32:30.302679 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m04:32:30.302926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15bb7219-7638-4ed8-a481-99fc4743a9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64a8daf0>]}
[0m04:32:30.304042 [info ] [MainThread]: 
[0m04:32:30.304506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:32:30.305134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m04:32:30.314073 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:32:30.314441 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:32:30.314672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:32:30.797919 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.483 seconds
[0m04:32:30.800679 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:32:30.973272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m04:32:30.976743 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:32:30.977475 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:32:30.977920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:32:31.583687 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.606 seconds
[0m04:32:31.585228 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:32:31.714756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15bb7219-7638-4ed8-a481-99fc4743a9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c7c650>]}
[0m04:32:31.715523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:32:31.716003 [info ] [MainThread]: 
[0m04:32:31.722376 [debug] [Thread-1 (]: Began running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:32:31.723020 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m04:32:31.723556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6)
[0m04:32:31.724090 [debug] [Thread-1 (]: Began compiling node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:32:31.733309 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m04:32:31.734989 [debug] [Thread-1 (]: Began executing node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:32:31.745314 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m04:32:31.747094 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m04:32:31.747484 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from dev.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m04:32:31.747870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:32:32.468671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m04:32:32.475659 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m04:32:32.606717 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.88s]
[0m04:32:32.607467 [debug] [Thread-1 (]: Finished running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m04:32:32.608140 [debug] [Thread-1 (]: Began running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:32:32.608506 [info ] [Thread-1 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m04:32:32.608853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6, now test.build_mau.unique_session_summary_sessionId.9c5e5661a0)
[0m04:32:32.609176 [debug] [Thread-1 (]: Began compiling node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:32:32.613022 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m04:32:32.614850 [debug] [Thread-1 (]: Began executing node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:32:32.616189 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m04:32:32.617117 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m04:32:32.617396 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from dev.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m04:32:32.617625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:32:33.049420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.432 seconds
[0m04:32:33.053183 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: Close
[0m04:32:33.173362 [info ] [Thread-1 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 0.56s]
[0m04:32:33.174080 [debug] [Thread-1 (]: Finished running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m04:32:33.175553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:32:33.175944 [debug] [MainThread]: Connection 'test.build_mau.unique_session_summary_sessionId.9c5e5661a0' was properly closed.
[0m04:32:33.176293 [info ] [MainThread]: 
[0m04:32:33.176568 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m04:32:33.177292 [debug] [MainThread]: Command end result
[0m04:32:33.203300 [info ] [MainThread]: 
[0m04:32:33.203695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:32:33.204071 [info ] [MainThread]: 
[0m04:32:33.204428 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:32:33.205492 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.5694976, "process_user_time": 2.560847, "process_kernel_time": 0.117693, "process_mem_max_rss": "207140", "process_out_blocks": "1836", "process_in_blocks": "0"}
[0m04:32:33.206026 [debug] [MainThread]: Command `dbt test` succeeded at 04:32:33.205943 after 3.57 seconds
[0m04:32:33.206321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e27080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f829f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6480b020>]}
[0m04:32:33.206617 [debug] [MainThread]: Flushing usage events
[0m04:32:35.037996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e67320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e65880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5e67050>]}


============================== 04:32:35.042350 | c8e1fb51-6156-4acf-92c6-05add399b672 ==============================
[0m04:32:35.042350 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:32:35.042800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:32:35.505334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d958b0>]}
[0m04:32:35.533363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6fe71d0>]}
[0m04:32:35.534029 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m04:32:35.540403 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:32:35.641521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:32:35.641944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:32:35.668489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84df4b00>]}
[0m04:32:35.734575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a795b0>]}
[0m04:32:35.734922 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m04:32:35.735145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5980e0>]}
[0m04:32:35.736427 [info ] [MainThread]: 
[0m04:32:35.736968 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:32:35.737626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:32:35.746329 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:32:35.746677 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:32:35.746847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:32:36.147569 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.401 seconds
[0m04:32:36.149504 [debug] [ThreadPool]: On list_dev: Close
[0m04:32:36.270560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m04:32:36.276448 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:32:36.276785 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:32:36.277138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:32:36.787946 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.511 seconds
[0m04:32:36.790419 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:32:37.002393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m04:32:37.007093 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m04:32:37.007822 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m04:32:37.008321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:32:37.480567 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.472 seconds
[0m04:32:37.483885 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m04:32:37.600174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d45160>]}
[0m04:32:37.601716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:32:37.602514 [info ] [MainThread]: 
[0m04:32:37.612489 [debug] [Thread-1 (]: Began running node snapshot.build_mau.snapshot_session_summary
[0m04:32:37.613376 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_session_summary ........................ [RUN]
[0m04:32:37.614090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.build_mau.snapshot_session_summary)
[0m04:32:37.614972 [debug] [Thread-1 (]: Began compiling node snapshot.build_mau.snapshot_session_summary
[0m04:32:37.622795 [debug] [Thread-1 (]: Began executing node snapshot.build_mau.snapshot_session_summary
[0m04:32:37.659696 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:37.660174 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m04:32:37.660461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:32:38.022028 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.361 seconds
[0m04:32:38.059591 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:38.060260 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
         as
        (

    with snapshot_query as (

        



SELECT * FROM dev.analytics.session_summary


    ),

    snapshotted_data as (

        select *,
            sessionId as dbt_unique_key

        from "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            nullif(ts, ts) as dbt_valid_to,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            sessionId as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.ts)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m04:32:39.276955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.216 seconds
[0m04:32:39.279875 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:39.280355 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m04:32:39.368186 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.087 seconds
[0m04:32:39.373726 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:39.374710 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m04:32:39.508062 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.132 seconds
[0m04:32:39.512265 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:39.512743 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m04:32:39.606910 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m04:32:39.612811 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:39.613501 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
[0m04:32:39.708166 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.094 seconds
[0m04:32:39.718692 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:39.719474 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp"
[0m04:32:39.785571 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.065 seconds
[0m04:32:39.804788 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:39.805474 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
select * from (
        

    with snapshot_query as (

        



SELECT * FROM dev.analytics.session_summary


    ),

    snapshotted_data as (

        select *,
            sessionId as dbt_unique_key

        from "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            nullif(ts, ts) as dbt_valid_to,
            md5(coalesce(cast(sessionId as varchar ), '')
         || '|' || coalesce(cast(ts as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            sessionId as dbt_unique_key,
            ts as dbt_updated_at,
            ts as dbt_valid_from,
            ts as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            sessionId as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.ts)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.ts)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m04:32:40.152140 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.346 seconds
[0m04:32:40.160211 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:40.161186 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m04:32:40.251688 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m04:32:40.252850 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.build_mau.snapshot_session_summary"
[0m04:32:40.254519 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:40.254842 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
BEGIN
[0m04:32:40.353923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m04:32:40.354612 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:40.355125 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_SESSION_SUMMARY__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("USERID", "SESSIONID", "CHANNEL", "TS", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m04:32:40.550127 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.194 seconds
[0m04:32:40.550675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.build_mau.snapshot_session_summary"
[0m04:32:40.551016 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "snapshot.build_mau.snapshot_session_summary"} */
COMMIT
[0m04:32:40.726754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m04:32:40.756653 [debug] [Thread-1 (]: On snapshot.build_mau.snapshot_session_summary: Close
[0m04:32:40.861108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8e1fb51-6156-4acf-92c6-05add399b672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65c5730>]}
[0m04:32:40.862861 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_session_summary ........................ [[32mSUCCESS 0[0m in 3.24s]
[0m04:32:40.863922 [debug] [Thread-1 (]: Finished running node snapshot.build_mau.snapshot_session_summary
[0m04:32:40.866150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:32:40.866825 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m04:32:40.867365 [debug] [MainThread]: Connection 'snapshot.build_mau.snapshot_session_summary' was properly closed.
[0m04:32:40.867902 [info ] [MainThread]: 
[0m04:32:40.868412 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m04:32:40.869855 [debug] [MainThread]: Command end result
[0m04:32:40.904424 [info ] [MainThread]: 
[0m04:32:40.904907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:32:40.905411 [info ] [MainThread]: 
[0m04:32:40.905830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:32:40.906720 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.919618, "process_user_time": 2.855783, "process_kernel_time": 0.15751, "process_mem_max_rss": "206876", "process_out_blocks": "1852", "process_in_blocks": "0"}
[0m04:32:40.907111 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:32:40.907048 after 5.92 seconds
[0m04:32:40.907480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b32f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85297b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84dccd40>]}
[0m04:32:40.907790 [debug] [MainThread]: Flushing usage events
[0m04:48:05.956154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecc5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90af9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb0a3c0>]}


============================== 04:48:05.960335 | f66c7375-5a82-483b-95bf-efe9f73de755 ==============================
[0m04:48:05.960335 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:48:05.961033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:48:05.965931 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'TYPE'
[0m04:48:05.966997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.056443416, "process_user_time": 0.985816, "process_kernel_time": 0.080902, "process_mem_max_rss": "194684", "process_in_blocks": "16", "process_out_blocks": "18", "command_success": false}
[0m04:48:05.967409 [debug] [MainThread]: Command `dbt run` failed at 04:48:05.967333 after 0.06 seconds
[0m04:48:05.967657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecc5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8daf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee1a9f0>]}
[0m04:48:05.967883 [debug] [MainThread]: Flushing usage events
[0m05:18:37.201269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbade9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc4f5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd322240>]}


============================== 05:18:37.207962 | d6954af5-99a1-410a-9d9d-9ed66cdcc7e8 ==============================
[0m05:18:37.207962 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:18:37.208711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:18:37.213040 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'TYPE'
[0m05:18:37.214097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.061728667, "process_user_time": 0.990264, "process_kernel_time": 0.083937, "process_mem_max_rss": "184460", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m05:18:37.214447 [debug] [MainThread]: Command `dbt run` failed at 05:18:37.214378 after 0.06 seconds
[0m05:18:37.214672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbade9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc4f5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba63a420>]}
[0m05:18:37.214879 [debug] [MainThread]: Flushing usage events
[0m05:20:52.940116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa194d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa194c2f0>]}


============================== 05:20:52.944127 | e3d4de38-7026-457c-a7be-8b23f4794104 ==============================
[0m05:20:52.944127 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:20:52.944804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:20:53.429593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d4de38-7026-457c-a7be-8b23f4794104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa155ef60>]}
[0m05:20:53.454872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d4de38-7026-457c-a7be-8b23f4794104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f3e390>]}
[0m05:20:53.455484 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:20:53.462295 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:20:53.529149 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:20:53.530071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3d4de38-7026-457c-a7be-8b23f4794104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80585880>]}
[0m05:20:54.261553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3d4de38-7026-457c-a7be-8b23f4794104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80987b90>]}
[0m05:20:54.360627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3d4de38-7026-457c-a7be-8b23f4794104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800824e0>]}
[0m05:20:54.361137 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m05:20:54.362033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d4de38-7026-457c-a7be-8b23f4794104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801654f0>]}
[0m05:20:54.363433 [info ] [MainThread]: 
[0m05:20:54.363983 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:20:54.364840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:20:54.373282 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:20:54.373723 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:20:54.374067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:20:54.918784 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.545 seconds
[0m05:20:54.920501 [debug] [ThreadPool]: On list_dev: Close
[0m05:20:55.069102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_)
[0m05:20:55.071448 [debug] [ThreadPool]: Creating schema "database: "dev"
"
[0m05:20:55.074724 [debug] [ThreadPool]: Using snowflake connection "create_dev_"
[0m05:20:55.075011 [debug] [ThreadPool]: On create_dev_: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "create_dev_"} */
create schema if not exists dev.
[0m05:20:55.075241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:20:55.462317 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b8c0-0003-e083-0001-714b00038a62
[0m05:20:55.462822 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 32 unexpected '<EOF>'.
syntax error line 1 at position 31 unexpected '.'.
[0m05:20:55.463140 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m05:20:55.463380 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:20:55.463644 [debug] [ThreadPool]: On create_dev_: Close
[0m05:20:55.571521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:20:55.572243 [debug] [MainThread]: Connection 'create_dev_' was properly closed.
[0m05:20:55.572676 [info ] [MainThread]: 
[0m05:20:55.573068 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m05:20:55.573722 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 32 unexpected '<EOF>'.
  syntax error line 1 at position 31 unexpected '.'.
[0m05:20:55.575045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6821804, "process_user_time": 3.122271, "process_kernel_time": 0.173459, "process_mem_max_rss": "209168", "process_out_blocks": "1831", "command_success": false, "process_in_blocks": "0"}
[0m05:20:55.575899 [debug] [MainThread]: Command `dbt run` failed at 05:20:55.575758 after 2.68 seconds
[0m05:20:55.576368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa194d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805275c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8041bd70>]}
[0m05:20:55.576868 [debug] [MainThread]: Flushing usage events
[0m05:22:37.377282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac114c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0499a0>]}


============================== 05:22:37.381485 | cf811432-2347-489e-b5a1-51f56a9186bf ==============================
[0m05:22:37.381485 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:22:37.381986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:22:37.431344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf811432-2347-489e-b5a1-51f56a9186bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4b1d00>]}
[0m05:22:37.443968 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.113354295, "process_user_time": 1.051351, "process_kernel_time": 0.057964, "process_mem_max_rss": "98024", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m05:22:37.444393 [debug] [MainThread]: Command `dbt clean` succeeded at 05:22:37.444323 after 0.11 seconds
[0m05:22:37.444710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab3332c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4b22d0>]}
[0m05:22:37.445350 [debug] [MainThread]: Flushing usage events
[0m05:22:52.451447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dd17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30bef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3504bf0>]}


============================== 05:22:52.455190 | 8979d0b7-6314-43e4-9b96-c2a9873f4087 ==============================
[0m05:22:52.455190 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:22:52.455859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:22:52.894952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8979d0b7-6314-43e4-9b96-c2a9873f4087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934216d0>]}
[0m05:22:52.920030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8979d0b7-6314-43e4-9b96-c2a9873f4087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b03ad0>]}
[0m05:22:52.920665 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:22:52.926911 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:22:52.927637 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:22:52.928140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8979d0b7-6314-43e4-9b96-c2a9873f4087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29e7da0>]}
[0m05:22:53.624492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8979d0b7-6314-43e4-9b96-c2a9873f4087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d563c0>]}
[0m05:22:53.738412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8979d0b7-6314-43e4-9b96-c2a9873f4087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d57d10>]}
[0m05:22:53.738789 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m05:22:53.739372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8979d0b7-6314-43e4-9b96-c2a9873f4087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dd6fc0>]}
[0m05:22:53.740576 [info ] [MainThread]: 
[0m05:22:53.741422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:22:53.742164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:22:53.749772 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:22:53.750093 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:22:53.750302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:22:54.366273 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.616 seconds
[0m05:22:54.368151 [debug] [ThreadPool]: On list_dev: Close
[0m05:22:54.493680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_)
[0m05:22:54.494397 [debug] [ThreadPool]: Creating schema "database: "dev"
"
[0m05:22:54.501346 [debug] [ThreadPool]: Using snowflake connection "create_dev_"
[0m05:22:54.502088 [debug] [ThreadPool]: On create_dev_: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "create_dev_"} */
create schema if not exists dev.
[0m05:22:54.502528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:22:55.870707 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b8c2-0003-e125-0001-714b00037c66
[0m05:22:55.871405 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 32 unexpected '<EOF>'.
syntax error line 1 at position 31 unexpected '.'.
[0m05:22:55.871826 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m05:22:55.872106 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:22:55.872445 [debug] [ThreadPool]: On create_dev_: Close
[0m05:22:55.978353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:22:55.978818 [debug] [MainThread]: Connection 'create_dev_' was properly closed.
[0m05:22:55.979121 [info ] [MainThread]: 
[0m05:22:55.979487 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m05:22:55.980048 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 32 unexpected '<EOF>'.
  syntax error line 1 at position 31 unexpected '.'.
[0m05:22:55.981296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5758357, "process_user_time": 3.094216, "process_kernel_time": 0.120252, "process_mem_max_rss": "209532", "process_out_blocks": "1831", "command_success": false, "process_in_blocks": "0"}
[0m05:22:55.981935 [debug] [MainThread]: Command `dbt run` failed at 05:22:55.981856 after 3.58 seconds
[0m05:22:55.982341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30bef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dd3bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9113cda0>]}
[0m05:22:55.982725 [debug] [MainThread]: Flushing usage events
[0m05:27:54.076963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae70fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04523c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6116d0>]}


============================== 05:27:54.081532 | d39377d6-3884-46b3-bdf7-fa7a120a2079 ==============================
[0m05:27:54.081532 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:27:54.081975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m05:27:54.540564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39377d6-3884-46b3-bdf7-fa7a120a2079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6c4fb0>]}
[0m05:27:54.567157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39377d6-3884-46b3-bdf7-fa7a120a2079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d390b60>]}
[0m05:27:54.567784 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:27:54.573777 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:27:54.647456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:27:54.647876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:27:54.674112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39377d6-3884-46b3-bdf7-fa7a120a2079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c51c4d0>]}
[0m05:27:54.742011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39377d6-3884-46b3-bdf7-fa7a120a2079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c424200>]}
[0m05:27:54.742367 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m05:27:54.742625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39377d6-3884-46b3-bdf7-fa7a120a2079', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0d2c90>]}
[0m05:27:54.743817 [info ] [MainThread]: 
[0m05:27:54.744249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:27:54.744930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m05:27:54.754358 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:27:54.754651 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:27:54.754919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:27:55.300505 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.546 seconds
[0m05:27:55.302349 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:27:55.431618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_)
[0m05:27:55.434553 [debug] [ThreadPool]: Using snowflake connection "list_dev_"
[0m05:27:55.434958 [debug] [ThreadPool]: On list_dev_: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_"} */
show objects in dev. limit 10000
[0m05:27:55.435319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:27:55.805634 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b8c7-0003-e125-0001-714b00037c6e
[0m05:27:55.806895 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 27 unexpected '10000'.
[0m05:27:55.807768 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m05:27:55.808240 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:27:55.808850 [debug] [ThreadPool]: On list_dev_: Close
[0m05:27:55.925642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:27:55.926308 [debug] [MainThread]: Connection 'list_dev_' was properly closed.
[0m05:27:55.926740 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 27 unexpected '10000'.
[0m05:27:55.927703 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 1.9000272, "process_user_time": 2.458643, "process_kernel_time": 0.190913, "process_mem_max_rss": "203164", "process_out_blocks": "926", "command_success": false, "process_in_blocks": "0"}
[0m05:27:55.928874 [debug] [MainThread]: Command `dbt compile` failed at 05:27:55.928614 after 1.90 seconds
[0m05:27:55.929543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae70fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c203bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c189d90>]}
[0m05:27:55.929941 [debug] [MainThread]: Flushing usage events
[0m05:39:09.484721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf754f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf834920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4eef30>]}


============================== 05:39:09.489365 | 3791ae89-b7c9-4c35-af4b-73151cf31b79 ==============================
[0m05:39:09.489365 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:39:09.490162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:39:09.943739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e06df40>]}
[0m05:39:09.971067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e412420>]}
[0m05:39:09.971750 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:39:09.978094 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:39:10.040984 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:39:10.041868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dca59d0>]}
[0m05:39:10.757615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7080b0>]}
[0m05:39:10.827604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da949b0>]}
[0m05:39:10.828030 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m05:39:10.828613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d743e30>]}
[0m05:39:10.829782 [info ] [MainThread]: 
[0m05:39:10.830492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:39:10.831342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:39:10.839986 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:39:10.840471 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:39:10.840750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:11.648784 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.808 seconds
[0m05:39:11.650786 [debug] [ThreadPool]: On list_dev: Close
[0m05:39:11.758192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:39:11.764250 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:39:11.764590 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:39:11.764838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:12.330351 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.565 seconds
[0m05:39:12.333112 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:39:12.587951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:39:12.592095 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:39:12.592542 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:39:12.592882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:39:13.053676 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.461 seconds
[0m05:39:13.055843 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:39:13.189466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc1d6d0>]}
[0m05:39:13.190064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:39:13.190339 [info ] [MainThread]: 
[0m05:39:13.196565 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m05:39:13.197370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.build_mau.session_timestamp)
[0m05:39:13.197783 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m05:39:13.204855 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m05:39:13.206977 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m05:39:13.207370 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m05:39:13.207855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m05:39:13.208117 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m05:39:13.209840 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m05:39:13.210912 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m05:39:13.211487 [debug] [Thread-1 (]: Began running node model.build_mau.session_summary
[0m05:39:13.211972 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m05:39:13.212292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.user_session_channel, now model.build_mau.session_summary)
[0m05:39:13.212519 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_summary
[0m05:39:13.216896 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_summary"
[0m05:39:13.218292 [debug] [Thread-1 (]: Began executing node model.build_mau.session_summary
[0m05:39:13.239848 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_summary"
[0m05:39:13.242278 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_summary"
[0m05:39:13.242682 [debug] [Thread-1 (]: On model.build_mau.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_summary"} */
create or replace transient table dev.analytics.session_summary
         as
        (WITH  __dbt__cte__user_session_channel as (
SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
),  __dbt__cte__session_timestamp as (
SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
), u AS (
    SELECT * FROM __dbt__cte__user_session_channel
), st AS (
    SELECT * FROM __dbt__cte__session_timestamp
)
SELECT u.userId, u.sessionId, u.channel, st.ts
FROM u
JOIN st ON u.sessionId = st.sessionId
        );
[0m05:39:13.242998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:39:15.887327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.643 seconds
[0m05:39:15.917869 [debug] [Thread-1 (]: On model.build_mau.session_summary: Close
[0m05:39:16.040989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3791ae89-b7c9-4c35-af4b-73151cf31b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf755520>]}
[0m05:39:16.041939 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.83s]
[0m05:39:16.042752 [debug] [Thread-1 (]: Finished running node model.build_mau.session_summary
[0m05:39:16.044524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:39:16.044912 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m05:39:16.045358 [debug] [MainThread]: Connection 'model.build_mau.session_summary' was properly closed.
[0m05:39:16.045763 [info ] [MainThread]: 
[0m05:39:16.046162 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m05:39:16.046897 [debug] [MainThread]: Command end result
[0m05:39:16.080908 [info ] [MainThread]: 
[0m05:39:16.081409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:39:16.081948 [info ] [MainThread]: 
[0m05:39:16.082446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:39:16.083266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.64659, "process_user_time": 3.341364, "process_kernel_time": 0.209598, "process_mem_max_rss": "211616", "process_out_blocks": "2741", "process_in_blocks": "0"}
[0m05:39:16.083695 [debug] [MainThread]: Command `dbt run` succeeded at 05:39:16.083604 after 6.65 seconds
[0m05:39:16.084050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4eef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2f1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f806750>]}
[0m05:39:16.084351 [debug] [MainThread]: Flushing usage events
[0m05:48:37.026074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d4df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c35ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c359a0>]}


============================== 05:48:37.030838 | 4af7a073-b837-4d96-9e34-0519a9f0a70e ==============================
[0m05:48:37.030838 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:48:37.031673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:48:37.036670 [info ] [MainThread]: dbt version: 1.8.7
[0m05:48:37.037298 [info ] [MainThread]: python version: 3.12.3
[0m05:48:37.037915 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m05:48:37.038355 [info ] [MainThread]: os info: Linux-6.10.0-linuxkit-aarch64-with-glibc2.36
[0m05:48:37.447849 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m05:48:37.448663 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m05:48:37.449180 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m05:48:37.449763 [info ] [MainThread]: adapter type: snowflake
[0m05:48:37.450222 [info ] [MainThread]: adapter version: 1.8.3
[0m05:48:37.490393 [info ] [MainThread]: Configuration:
[0m05:48:37.491181 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:48:37.491642 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:48:37.492082 [info ] [MainThread]: Required dependencies:
[0m05:48:37.492564 [debug] [MainThread]: Executing "git --help"
[0m05:48:37.493300 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:48:37.493784 [info ] [MainThread]: Connection:
[0m05:48:37.494205 [info ] [MainThread]:   account: icduxid-fzb33116
[0m05:48:37.494643 [info ] [MainThread]:   user: keeyonghan
[0m05:48:37.494965 [info ] [MainThread]:   database: dev
[0m05:48:37.495272 [info ] [MainThread]:   warehouse: compute_wh
[0m05:48:37.495665 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m05:48:37.496038 [info ] [MainThread]:   schema: analytics
[0m05:48:37.496399 [info ] [MainThread]:   authenticator: None
[0m05:48:37.496777 [info ] [MainThread]:   oauth_client_id: None
[0m05:48:37.497214 [info ] [MainThread]:   query_tag: None
[0m05:48:37.497869 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:48:37.498323 [info ] [MainThread]:   host: None
[0m05:48:37.498676 [info ] [MainThread]:   port: None
[0m05:48:37.499013 [info ] [MainThread]:   proxy_host: None
[0m05:48:37.499403 [info ] [MainThread]:   proxy_port: None
[0m05:48:37.499872 [info ] [MainThread]:   protocol: None
[0m05:48:37.500258 [info ] [MainThread]:   connect_retries: 1
[0m05:48:37.500634 [info ] [MainThread]:   connect_timeout: None
[0m05:48:37.501016 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:48:37.501394 [info ] [MainThread]:   retry_all: False
[0m05:48:37.501741 [info ] [MainThread]:   insecure_mode: False
[0m05:48:37.502105 [info ] [MainThread]:   reuse_connections: None
[0m05:48:37.502575 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:48:37.504902 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:48:37.505430 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:48:37.505644 [debug] [MainThread]: On debug: select 1 as id
[0m05:48:37.505825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:48:38.198436 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.692 seconds
[0m05:48:38.201094 [debug] [MainThread]: On debug: Close
[0m05:48:38.328330 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:48:38.330120 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:48:38.330920 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:48:38.333160 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.3537947, "process_user_time": 2.248031, "process_kernel_time": 0.148916, "process_mem_max_rss": "197776", "process_out_blocks": "17", "command_success": false, "process_in_blocks": "0"}
[0m05:48:38.333981 [debug] [MainThread]: Command `dbt debug` failed at 05:48:38.333874 after 1.35 seconds
[0m05:48:38.334478 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:48:38.334841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c730b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72796930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83cafb90>]}
[0m05:48:38.335283 [debug] [MainThread]: Flushing usage events
[0m05:49:10.635811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80095550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81762000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9771a0>]}


============================== 05:49:10.640888 | 6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1 ==============================
[0m05:49:10.640888 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:49:10.641671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:49:11.085306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e00e420>]}
[0m05:49:11.110683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60128c50>]}
[0m05:49:11.111288 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:49:11.117602 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:49:11.190321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:49:11.190811 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:49:11.222216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d6f1040>]}
[0m05:49:11.299604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d2d7320>]}
[0m05:49:11.300135 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m05:49:11.300718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d53e570>]}
[0m05:49:11.302023 [info ] [MainThread]: 
[0m05:49:11.302666 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:49:11.303408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m05:49:11.313734 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:49:11.314136 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:49:11.314405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:49:11.811878 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.497 seconds
[0m05:49:11.813809 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:49:11.928837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:49:11.931743 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:49:11.932171 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:49:11.932467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:49:12.342063 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.409 seconds
[0m05:49:12.344705 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:49:12.469847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4ecc9e-0577-4d7f-afdf-7ce96ab3dad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e58f1a0>]}
[0m05:49:12.470670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:49:12.471034 [info ] [MainThread]: 
[0m05:49:12.477977 [debug] [Thread-1 (]: Began running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m05:49:12.478540 [info ] [Thread-1 (]: 1 of 2 START test not_null_session_summary_sessionId ........................... [RUN]
[0m05:49:12.478961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6)
[0m05:49:12.479357 [debug] [Thread-1 (]: Began compiling node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m05:49:12.491236 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m05:49:12.493818 [debug] [Thread-1 (]: Began executing node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m05:49:12.506894 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m05:49:12.509036 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"
[0m05:49:12.509552 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sessionId
from dev.analytics.session_summary
where sessionId is null



      
    ) dbt_internal_test
[0m05:49:12.509918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:49:13.112452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m05:49:13.119776 [debug] [Thread-1 (]: On test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6: Close
[0m05:49:13.244687 [info ] [Thread-1 (]: 1 of 2 PASS not_null_session_summary_sessionId ................................. [[32mPASS[0m in 0.77s]
[0m05:49:13.245418 [debug] [Thread-1 (]: Finished running node test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6
[0m05:49:13.246321 [debug] [Thread-1 (]: Began running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m05:49:13.247087 [info ] [Thread-1 (]: 2 of 2 START test unique_session_summary_sessionId ............................. [RUN]
[0m05:49:13.247574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.build_mau.not_null_session_summary_sessionId.e6aec1a6c6, now test.build_mau.unique_session_summary_sessionId.9c5e5661a0)
[0m05:49:13.247972 [debug] [Thread-1 (]: Began compiling node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m05:49:13.252986 [debug] [Thread-1 (]: Writing injected SQL for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m05:49:13.254183 [debug] [Thread-1 (]: Began executing node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m05:49:13.255895 [debug] [Thread-1 (]: Writing runtime sql for node "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m05:49:13.257082 [debug] [Thread-1 (]: Using snowflake connection "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"
[0m05:49:13.257406 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "test.build_mau.unique_session_summary_sessionId.9c5e5661a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    sessionId as unique_field,
    count(*) as n_records

from dev.analytics.session_summary
where sessionId is not null
group by sessionId
having count(*) > 1



      
    ) dbt_internal_test
[0m05:49:13.257722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:49:14.498215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.240 seconds
[0m05:49:14.500090 [debug] [Thread-1 (]: On test.build_mau.unique_session_summary_sessionId.9c5e5661a0: Close
[0m05:49:14.640611 [info ] [Thread-1 (]: 2 of 2 PASS unique_session_summary_sessionId ................................... [[32mPASS[0m in 1.39s]
[0m05:49:14.641775 [debug] [Thread-1 (]: Finished running node test.build_mau.unique_session_summary_sessionId.9c5e5661a0
[0m05:49:14.644268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:49:14.644770 [debug] [MainThread]: Connection 'test.build_mau.unique_session_summary_sessionId.9c5e5661a0' was properly closed.
[0m05:49:14.645233 [info ] [MainThread]: 
[0m05:49:14.645650 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m05:49:14.646693 [debug] [MainThread]: Command end result
[0m05:49:14.680990 [info ] [MainThread]: 
[0m05:49:14.681678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:49:14.682224 [info ] [MainThread]: 
[0m05:49:14.682684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:49:14.683658 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.092419, "process_user_time": 2.611326, "process_kernel_time": 0.134928, "process_mem_max_rss": "207100", "process_out_blocks": "1837", "process_in_blocks": "0"}
[0m05:49:14.684225 [debug] [MainThread]: Command `dbt test` succeeded at 05:49:14.684102 after 4.09 seconds
[0m05:49:14.684608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80095550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d86ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d80a2a0>]}
[0m05:49:14.684971 [debug] [MainThread]: Flushing usage events
[0m05:57:32.498966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafba9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb003ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7d30b0>]}


============================== 05:57:32.507961 | 05b1a77d-76ad-43b2-adf8-7626ed1e0f04 ==============================
[0m05:57:32.507961 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:57:32.508974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:57:33.057812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05b1a77d-76ad-43b2-adf8-7626ed1e0f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3a29f0>]}
[0m05:57:33.085555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05b1a77d-76ad-43b2-adf8-7626ed1e0f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bfc26c0>]}
[0m05:57:33.086232 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m05:57:33.093481 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:57:33.153279 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:57:33.154219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05b1a77d-76ad-43b2-adf8-7626ed1e0f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fed880>]}
[0m05:57:33.894391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05b1a77d-76ad-43b2-adf8-7626ed1e0f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bfde80>]}
[0m05:57:33.962612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05b1a77d-76ad-43b2-adf8-7626ed1e0f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89708a70>]}
[0m05:57:33.963273 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m05:57:33.963879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05b1a77d-76ad-43b2-adf8-7626ed1e0f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0747440>]}
[0m05:57:33.965306 [info ] [MainThread]: 
[0m05:57:33.965934 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:57:33.966631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:57:33.974621 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:57:33.975098 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:57:33.975469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:57:34.553316 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.578 seconds
[0m05:57:34.556577 [debug] [ThreadPool]: On list_dev: Close
[0m05:57:34.690044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_)
[0m05:57:34.691131 [debug] [ThreadPool]: Creating schema "database: "dev"
"
[0m05:57:34.697251 [debug] [ThreadPool]: Using snowflake connection "create_dev_"
[0m05:57:34.697850 [debug] [ThreadPool]: On create_dev_: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "create_dev_"} */
create schema if not exists dev.
[0m05:57:34.698260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:57:35.090623 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b8e5-0003-e125-0001-714b00037c7e
[0m05:57:35.091328 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 32 unexpected '<EOF>'.
syntax error line 1 at position 31 unexpected '.'.
[0m05:57:35.091696 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m05:57:35.091959 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m05:57:35.092261 [debug] [ThreadPool]: On create_dev_: Close
[0m05:57:35.197608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:57:35.198077 [debug] [MainThread]: Connection 'create_dev_' was properly closed.
[0m05:57:35.198392 [info ] [MainThread]: 
[0m05:57:35.198740 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m05:57:35.199314 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 32 unexpected '<EOF>'.
  syntax error line 1 at position 31 unexpected '.'.
[0m05:57:35.200187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7522993, "process_user_time": 3.306358, "process_kernel_time": 0.251437, "process_mem_max_rss": "209652", "process_out_blocks": "1831", "command_success": false, "process_in_blocks": "0"}
[0m05:57:35.200660 [debug] [MainThread]: Command `dbt run` failed at 05:57:35.200570 after 2.75 seconds
[0m05:57:35.200960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf225e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b8c950>]}
[0m05:57:35.201330 [debug] [MainThread]: Flushing usage events
[0m06:01:11.956432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0c4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b185cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b187e00>]}


============================== 06:01:11.961106 | b11d2ebb-61cd-478f-b965-fc3d70ad7e19 ==============================
[0m06:01:11.961106 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:01:11.961632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --debug --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:01:12.437103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b11d2ebb-61cd-478f-b965-fc3d70ad7e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cdf950>]}
[0m06:01:12.464831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b11d2ebb-61cd-478f-b965-fc3d70ad7e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ca0c20>]}
[0m06:01:12.465873 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m06:01:12.472538 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:01:12.547052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:01:12.547796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:01:12.575294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b11d2ebb-61cd-478f-b965-fc3d70ad7e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff694e7b60>]}
[0m06:01:12.647005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b11d2ebb-61cd-478f-b965-fc3d70ad7e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68c8c650>]}
[0m06:01:12.647799 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m06:01:12.648338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b11d2ebb-61cd-478f-b965-fc3d70ad7e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68c7c9e0>]}
[0m06:01:12.649628 [info ] [MainThread]: 
[0m06:01:12.650250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:01:12.651219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m06:01:12.659731 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m06:01:12.660088 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m06:01:12.660402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:13.350558 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.690 seconds
[0m06:01:13.352740 [debug] [ThreadPool]: On list_dev: Close
[0m06:01:13.461385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_)
[0m06:01:13.462046 [debug] [ThreadPool]: Creating schema "database: "dev"
"
[0m06:01:13.465942 [debug] [ThreadPool]: Using snowflake connection "create_dev_"
[0m06:01:13.466405 [debug] [ThreadPool]: On create_dev_: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "create_dev_"} */
create schema if not exists dev.
[0m06:01:13.467178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:13.851265 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b8e9-0003-e083-0001-714b00038a82
[0m06:01:13.852317 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 32 unexpected '<EOF>'.
syntax error line 1 at position 31 unexpected '.'.
[0m06:01:13.853141 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m06:01:13.853968 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m06:01:13.854532 [debug] [ThreadPool]: On create_dev_: Close
[0m06:01:13.967981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:13.968837 [debug] [MainThread]: Connection 'create_dev_' was properly closed.
[0m06:01:13.969277 [info ] [MainThread]: 
[0m06:01:13.969820 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m06:01:13.970410 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 32 unexpected '<EOF>'.
  syntax error line 1 at position 31 unexpected '.'.
[0m06:01:13.971845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.065211, "process_user_time": 2.48485, "process_kernel_time": 0.213478, "process_mem_max_rss": "203332", "process_out_blocks": "927", "command_success": false, "process_in_blocks": "0"}
[0m06:01:13.972802 [debug] [MainThread]: Command `dbt run` failed at 06:01:13.972531 after 2.07 seconds
[0m06:01:13.973500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0513a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68b51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68be8530>]}
[0m06:01:13.974216 [debug] [MainThread]: Flushing usage events
[0m06:09:59.923232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e27ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0915d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09216d0>]}


============================== 06:09:59.928402 | 0a8a4aa3-9d08-4e13-abcb-5668e089b3b5 ==============================
[0m06:09:59.928402 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:09:59.929039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --debug --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m06:10:00.405537 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "build_mau", target "dev" invalid: 'schema' is a required property
[0m06:10:00.407070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5337203, "process_user_time": 2.174341, "process_kernel_time": 0.196801, "process_mem_max_rss": "190796", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m06:10:00.407876 [debug] [MainThread]: Command `dbt run` failed at 06:10:00.407782 after 0.53 seconds
[0m06:10:00.408445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0915d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e24aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1de270>]}
[0m06:10:00.408990 [debug] [MainThread]: Flushing usage events
[0m06:12:37.048661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838df860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838dfce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838dfb00>]}


============================== 06:12:37.054370 | 70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0 ==============================
[0m06:12:37.054370 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:12:37.054993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --debug --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:12:37.532558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85427470>]}
[0m06:12:37.558111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6440fb00>]}
[0m06:12:37.559271 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m06:12:37.565430 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:12:37.626215 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m06:12:37.626984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8442c6b0>]}
[0m06:12:38.361839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f5a62a0>]}
[0m06:12:38.428953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e37a930>]}
[0m06:12:38.429732 [info ] [MainThread]: Found 3 models, 1 snapshot, 2 data tests, 3 sources, 454 macros
[0m06:12:38.430317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ed65310>]}
[0m06:12:38.431665 [info ] [MainThread]: 
[0m06:12:38.432249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:12:38.433164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m06:12:38.441624 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m06:12:38.442050 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m06:12:38.442387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:39.093497 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.651 seconds
[0m06:12:39.095780 [debug] [ThreadPool]: On list_dev: Close
[0m06:12:39.231140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m06:12:39.242800 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:12:39.243544 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:12:39.244235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:39.733030 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.488 seconds
[0m06:12:39.735796 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:12:39.865835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:12:39.868645 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:12:39.869103 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:12:39.869810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:12:40.266239 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.396 seconds
[0m06:12:40.269622 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:12:40.377585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e80c080>]}
[0m06:12:40.378416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:12:40.378888 [info ] [MainThread]: 
[0m06:12:40.385699 [debug] [Thread-1 (]: Began running node model.build_mau.session_timestamp
[0m06:12:40.386509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.build_mau.session_timestamp)
[0m06:12:40.386886 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_timestamp
[0m06:12:40.392468 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_timestamp"
[0m06:12:40.395193 [debug] [Thread-1 (]: Finished running node model.build_mau.session_timestamp
[0m06:12:40.395704 [debug] [Thread-1 (]: Began running node model.build_mau.user_session_channel
[0m06:12:40.396311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.session_timestamp, now model.build_mau.user_session_channel)
[0m06:12:40.396703 [debug] [Thread-1 (]: Began compiling node model.build_mau.user_session_channel
[0m06:12:40.398543 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.user_session_channel"
[0m06:12:40.399631 [debug] [Thread-1 (]: Finished running node model.build_mau.user_session_channel
[0m06:12:40.400346 [debug] [Thread-1 (]: Began running node model.build_mau.session_summary
[0m06:12:40.400868 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.session_summary ......................... [RUN]
[0m06:12:40.401274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.build_mau.user_session_channel, now model.build_mau.session_summary)
[0m06:12:40.401622 [debug] [Thread-1 (]: Began compiling node model.build_mau.session_summary
[0m06:12:40.405051 [debug] [Thread-1 (]: Writing injected SQL for node "model.build_mau.session_summary"
[0m06:12:40.406094 [debug] [Thread-1 (]: Began executing node model.build_mau.session_summary
[0m06:12:40.425500 [debug] [Thread-1 (]: Writing runtime sql for node "model.build_mau.session_summary"
[0m06:12:40.427118 [debug] [Thread-1 (]: Using snowflake connection "model.build_mau.session_summary"
[0m06:12:40.427418 [debug] [Thread-1 (]: On model.build_mau.session_summary: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "build_mau", "target_name": "dev", "node_id": "model.build_mau.session_summary"} */
create or replace transient table dev.analytics.session_summary
         as
        (WITH  __dbt__cte__user_session_channel as (
SELECT
    userId,
    sessionId,
    channel
FROM dev.raw_data.user_session_channel
),  __dbt__cte__session_timestamp as (
SELECT
    sessionId,
    ts
FROM dev.raw_data.session_timestamp
), u AS (
    SELECT * FROM __dbt__cte__user_session_channel
), st AS (
    SELECT * FROM __dbt__cte__session_timestamp
)
SELECT u.userId, u.sessionId, u.channel, st.ts
FROM u
JOIN st ON u.sessionId = st.sessionId
        );
[0m06:12:40.427714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:12:43.155161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.727 seconds
[0m06:12:43.176418 [debug] [Thread-1 (]: On model.build_mau.session_summary: Close
[0m06:12:43.300039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70e4d3d5-8e69-44ce-aeb9-967b81aa6ee0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d7089e0>]}
[0m06:12:43.301266 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.session_summary .................... [[32mSUCCESS 1[0m in 2.90s]
[0m06:12:43.301955 [debug] [Thread-1 (]: Finished running node model.build_mau.session_summary
[0m06:12:43.303848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:43.304640 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m06:12:43.305135 [debug] [MainThread]: Connection 'model.build_mau.session_summary' was properly closed.
[0m06:12:43.305864 [info ] [MainThread]: 
[0m06:12:43.306499 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m06:12:43.307266 [debug] [MainThread]: Command end result
[0m06:12:43.335784 [info ] [MainThread]: 
[0m06:12:43.336224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:43.336521 [info ] [MainThread]: 
[0m06:12:43.336864 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:12:43.337864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3394094, "process_user_time": 3.301094, "process_kernel_time": 0.267, "process_mem_max_rss": "211388", "process_out_blocks": "2742", "process_in_blocks": "0"}
[0m06:12:43.338464 [debug] [MainThread]: Command `dbt run` succeeded at 06:12:43.338335 after 6.34 seconds
[0m06:12:43.338834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b11b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f889550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e7ef770>]}
[0m06:12:43.339196 [debug] [MainThread]: Flushing usage events
[0m23:19:26.067629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ca150>]}


============================== 23:19:26.074710 | 8ea26e02-3806-4035-a278-ef6eb8b56876 ==============================
[0m23:19:26.074710 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:19:26.075282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jobox/Downloads/SJSU/sjsu-data226/week8/airflow/dbt/logs', 'profiles_dir': '/Users/jobox/Downloads/SJSU/sjsu-data226/week8/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:19:26.222157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ea26e02-3806-4035-a278-ef6eb8b56876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8ad0>]}
[0m23:19:26.266089 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.29786026, "process_user_time": 0.923517, "process_kernel_time": 0.221233, "process_mem_max_rss": "99774464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:19:26.266755 [debug] [MainThread]: Command `dbt clean` succeeded at 23:19:26.266662 after 0.30 seconds
[0m23:19:26.267088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e3150>]}
[0m23:19:26.267384 [debug] [MainThread]: Flushing usage events
[0m19:51:33.228884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A313DA2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A316820190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A316820050>]}


============================== 19:51:33.242710 | 08dfa334-4fd3-47e8-bdb9-91a7b29848a7 ==============================
[0m19:51:33.242710 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:51:33.243649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:51:33.314200 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m19:51:33.317135 [debug] [MainThread]: Command `dbt run` failed at 19:51:33.316695 after 0.26 seconds
[0m19:51:33.318173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A316965CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A316783E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3167C2F10>]}
[0m19:51:33.319327 [debug] [MainThread]: Flushing usage events
[0m20:13:19.126058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACF69EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD2110190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD2110050>]}


============================== 20:13:19.131176 | a471373a-c746-482a-b390-dcb5034dd2d3 ==============================
[0m20:13:19.131176 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:13:19.132110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:13:19.137932 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m20:13:19.139317 [debug] [MainThread]: Command `dbt run` failed at 20:13:19.139139 after 0.17 seconds
[0m20:13:19.139687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD2255CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD2073E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AD20B2F10>]}
[0m20:13:19.140038 [debug] [MainThread]: Flushing usage events
[0m20:20:24.622554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020675032A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020677AA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020677AA0050>]}


============================== 20:20:24.627497 | d6a3cb7a-fc59-4c98-bec6-2efed660dc17 ==============================
[0m20:20:24.627497 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:20:24.628425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:24.633857 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m20:20:24.634924 [debug] [MainThread]: Command `dbt run` failed at 20:20:24.634799 after 0.18 seconds
[0m20:20:24.635255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020677BE5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020677A07E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020677A42F10>]}
[0m20:20:24.635636 [debug] [MainThread]: Flushing usage events
[0m20:21:35.355318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029141EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020293E90190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020293E90050>]}


============================== 20:21:35.359089 | 5e08149f-d11a-4193-bfa6-f86d1c0096c2 ==============================
[0m20:21:35.359089 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:21:35.359750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:21:35.390385 [info ] [MainThread]: dbt version: 1.8.8
[0m20:21:35.390891 [info ] [MainThread]: python version: 3.13.0
[0m20:21:35.391288 [info ] [MainThread]: python path: C:\Users\mtann\AppData\Local\Programs\Python\Python313\python.exe
[0m20:21:35.391688 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m20:21:35.396977 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m20:21:35.398048 [debug] [MainThread]: Command `dbt debug` failed at 20:21:35.397928 after 0.14 seconds
[0m20:21:35.398373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020293FCF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002029404FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202940518C0>]}
[0m20:21:35.398709 [debug] [MainThread]: Flushing usage events
[0m20:22:50.046987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001623E752A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162411C0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162411C0050>]}


============================== 20:22:50.050799 | e43c7f97-5b8d-4250-8d2e-bb06b8ad1788 ==============================
[0m20:22:50.050799 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:22:50.051481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:22:50.072036 [info ] [MainThread]: dbt version: 1.8.8
[0m20:22:50.072571 [info ] [MainThread]: python version: 3.13.0
[0m20:22:50.073005 [info ] [MainThread]: python path: C:\Users\mtann\AppData\Local\Programs\Python\Python313\python.exe
[0m20:22:50.073458 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m20:22:50.078596 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m20:22:50.079701 [debug] [MainThread]: Command `dbt debug` failed at 20:22:50.079563 after 0.14 seconds
[0m20:22:50.080035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162412FF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001624137FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162413818C0>]}
[0m20:22:50.080375 [debug] [MainThread]: Flushing usage events
[0m20:38:31.357309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE4732A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE71A0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE71A0050>]}


============================== 20:38:31.361060 | ddd993b3-8242-421b-9e68-581e70dceb94 ==============================
[0m20:38:31.361060 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:38:31.361661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:38:31.366538 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m20:38:31.367633 [debug] [MainThread]: Command `dbt run` failed at 20:38:31.367501 after 0.10 seconds
[0m20:38:31.367974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE72E5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7103E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AE7142F10>]}
[0m20:38:31.368322 [debug] [MainThread]: Flushing usage events
[0m20:40:39.781377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348C12EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348EBA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348EBA0050>]}


============================== 20:40:39.785148 | dd9380d8-5b63-46e2-b30e-e9894dcc2286 ==============================
[0m20:40:39.785148 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:40:39.785755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:39.791002 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_DATABASE'
[0m20:40:39.792038 [debug] [MainThread]: Command `dbt run` failed at 20:40:39.791894 after 0.14 seconds
[0m20:40:39.792379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348ECE6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348EB03D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002348EB43130>]}
[0m20:40:39.792719 [debug] [MainThread]: Flushing usage events
[0m20:43:33.554216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013376B3EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133795C0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133795C0050>]}


============================== 20:43:33.557881 | ff0e36b9-0b74-40e9-9b8b-59e7d3f37e98 ==============================
[0m20:43:33.557881 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:43:33.558490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:40.514754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff0e36b9-0b74-40e9-9b8b-59e7d3f37e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001330A8C1E00>]}
[0m20:43:40.565769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff0e36b9-0b74-40e9-9b8b-59e7d3f37e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001330A7DE030>]}
[0m20:43:40.567281 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:43:40.591590 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:43:40.592709 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:43:40.593211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff0e36b9-0b74-40e9-9b8b-59e7d3f37e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001330A998250>]}
[0m20:43:42.532500 [error] [MainThread]: Encountered an error:
Compilation Error in model raw_data_model (models\raw_data_model.sql)
  source() takes exactly two arguments (3 given)
[0m20:43:42.533724 [debug] [MainThread]: Command `dbt run` failed at 20:43:42.533592 after 9.12 seconds
[0m20:43:42.534108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001330A9FB020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001330A9FA3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013379603E70>]}
[0m20:43:42.534517 [debug] [MainThread]: Flushing usage events
[0m20:45:47.915861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D6482A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D8F00190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D8F00050>]}


============================== 20:45:47.920393 | 9bb3b01a-cf4b-4b56-86e9-a25b6d98ae19 ==============================
[0m20:45:47.920393 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:45:47.921690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:49.205085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bb3b01a-cf4b-4b56-86e9-a25b6d98ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D824DE00>]}
[0m20:45:49.271745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bb3b01a-cf4b-4b56-86e9-a25b6d98ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D816E030>]}
[0m20:45:49.273438 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:45:49.283973 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:45:49.285090 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:45:49.285573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9bb3b01a-cf4b-4b56-86e9-a25b6d98ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273EA1F0250>]}
[0m20:45:50.492288 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'session_summary' in the 'models' section of file 'models\schema.yml'
[0m20:45:50.668112 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_dbt.raw_data_model' (models\raw_data_model.sql) depends on a source named 'dev.raw_data.stock_data' which was not found
[0m20:45:50.669285 [debug] [MainThread]: Command `dbt run` failed at 20:45:50.669138 after 2.91 seconds
[0m20:45:50.669643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273EA5897C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273EA58A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273D8F43E70>]}
[0m20:45:50.669986 [debug] [MainThread]: Flushing usage events
[0m20:59:24.482507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC8202EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC84A60190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC84A60050>]}


============================== 20:59:24.486234 | d49da4c3-52e2-416d-b795-6742ccb9b824 ==============================
[0m20:59:24.486234 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:59:24.486867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m20:59:25.337350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd49da4c3-52e2-416d-b795-6742ccb9b824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC83DE1E00>]}
[0m20:59:25.389228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd49da4c3-52e2-416d-b795-6742ccb9b824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC83CFE030>]}
[0m20:59:25.390580 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:59:25.398042 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:59:25.398904 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:59:25.399430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd49da4c3-52e2-416d-b795-6742ccb9b824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC95D30250>]}
[0m20:59:26.640861 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_dbt.raw_data_model' (models\raw_data_model.sql) depends on a source named 'dev.raw_data.stock_data' which was not found
[0m20:59:26.642336 [debug] [MainThread]: Command `dbt run` failed at 20:59:26.642119 after 2.29 seconds
[0m20:59:26.642790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC960CC8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC960CC5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC84AA3E70>]}
[0m20:59:26.643211 [debug] [MainThread]: Flushing usage events
[0m21:07:24.374167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CAC7EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CD6F0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CD6F0050>]}


============================== 21:07:24.377823 | e08c744a-3fea-4521-97bc-375346a910c1 ==============================
[0m21:07:24.377823 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:07:24.378449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:07:25.254687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e08c744a-3fea-4521-97bc-375346a910c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCA49E00>]}
[0m21:07:25.305317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e08c744a-3fea-4521-97bc-375346a910c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC96E030>]}
[0m21:07:25.306668 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:07:25.315309 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:07:25.316376 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:07:25.317012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e08c744a-3fea-4521-97bc-375346a910c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DE950250>]}
[0m21:07:26.608868 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_dbt.snapshot_session_summary' (snapshots\snapshot_session_summary.sql) depends on a node named 'session_summary' which was not found
[0m21:07:26.610029 [debug] [MainThread]: Command `dbt run` failed at 21:07:26.609897 after 2.37 seconds
[0m21:07:26.610396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DE9B5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DECEC8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CD733E70>]}
[0m21:07:26.610740 [debug] [MainThread]: Flushing usage events
[0m21:09:37.251932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6B232A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6DCB0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6DCB0050>]}


============================== 21:09:37.255749 | 63590d08-e95b-4fc2-92ee-a346a4f65004 ==============================
[0m21:09:37.255749 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:09:37.256358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:09:38.110870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63590d08-e95b-4fc2-92ee-a346a4f65004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6D001E00>]}
[0m21:09:38.161749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63590d08-e95b-4fc2-92ee-a346a4f65004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6CF1E030>]}
[0m21:09:38.163155 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:09:38.171023 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:09:38.172134 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:09:38.172707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63590d08-e95b-4fc2-92ee-a346a4f65004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7EFB0250>]}
[0m21:09:39.381067 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.stock_dbt.snapshot_session_summary' (snapshots\snapshot_session_summary.sql) depends on a node named 'session_summary' which was not found
[0m21:09:39.382353 [debug] [MainThread]: Command `dbt run` failed at 21:09:39.382189 after 2.26 seconds
[0m21:09:39.382758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F007A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A7F344E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A6DCF3E70>]}
[0m21:09:39.383136 [debug] [MainThread]: Flushing usage events
[0m21:10:15.002500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF4B0EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF7580190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF7580050>]}


============================== 21:10:15.006230 | 1fb6f965-012c-42c3-ae1c-bddbc8fd3656 ==============================
[0m21:10:15.006230 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:10:15.006877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:10:15.891653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fb6f965-012c-42c3-ae1c-bddbc8fd3656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF888A9E00>]}
[0m21:10:15.942810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fb6f965-012c-42c3-ae1c-bddbc8fd3656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF887CE030>]}
[0m21:10:15.944102 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:10:15.951265 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:10:15.952184 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:10:15.952647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fb6f965-012c-42c3-ae1c-bddbc8fd3656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF88984250>]}
[0m21:10:17.097625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fb6f965-012c-42c3-ae1c-bddbc8fd3656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF889716D0>]}
[0m21:10:17.246240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fb6f965-012c-42c3-ae1c-bddbc8fd3656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF88B53AF0>]}
[0m21:10:17.246701 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m21:10:17.247187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fb6f965-012c-42c3-ae1c-bddbc8fd3656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF88A11230>]}
[0m21:10:17.249521 [info ] [MainThread]: 
[0m21:10:17.250289 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:10:17.254491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:10:17.267207 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:10:17.267662 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:10:17.268197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:18.633529 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:10:18.633932 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:10:18.634310 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:10:18.634604 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:10:18.634949 [debug] [ThreadPool]: On list_DEV: No close available on handle
[0m21:10:18.636191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:18.636469 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m21:10:18.636760 [info ] [MainThread]: 
[0m21:10:18.637199 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m21:10:18.637739 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV"
  Database Error
    250001 (08001): Failed to connect to DB: mzuubyx-ctb21060.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m21:10:18.638785 [debug] [MainThread]: Command `dbt run` failed at 21:10:18.638656 after 3.73 seconds
[0m21:10:18.639149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF74AFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF88D92200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF88D92410>]}
[0m21:10:18.639506 [debug] [MainThread]: Flushing usage events
[0m21:18:49.137963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64DAE2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A650550190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A650550050>]}


============================== 21:18:49.143525 | 55ef6f00-5e67-446b-98af-b00811ed0d79 ==============================
[0m21:18:49.143525 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:18:49.144415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m21:18:54.841514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ef6f00-5e67-446b-98af-b00811ed0d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F8B1E00>]}
[0m21:18:54.895870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ef6f00-5e67-446b-98af-b00811ed0d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F7CE030>]}
[0m21:18:54.897273 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:54.918717 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:18:55.929062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:55.929445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:55.963228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ef6f00-5e67-446b-98af-b00811ed0d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6617B6950>]}
[0m21:18:56.094627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ef6f00-5e67-446b-98af-b00811ed0d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6617A1F40>]}
[0m21:18:56.095090 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m21:18:56.095542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ef6f00-5e67-446b-98af-b00811ed0d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F8266D0>]}
[0m21:18:56.097888 [info ] [MainThread]: 
[0m21:18:56.098653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:56.105082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:18:56.118696 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:18:56.119108 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:18:56.119574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:57.052761 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:18:57.053395 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:18:57.053853 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:18:57.054154 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:18:57.054499 [debug] [ThreadPool]: On list_DEV: No close available on handle
[0m21:18:57.055768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:57.056053 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m21:18:57.056343 [info ] [MainThread]: 
[0m21:18:57.056877 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m21:18:57.057658 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "DEV"
  Database Error
    250001 (08001): Failed to connect to DB: mzuubyx-ctb21060.snowflakecomputing.com:443. Role 'ACCOUNT_ADMIN' specified in the connect string does not exist or not authorized. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m21:18:57.058957 [debug] [MainThread]: Command `dbt run` failed at 21:18:57.058821 after 8.10 seconds
[0m21:18:57.059302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6619D24E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65047FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A661A27DD0>]}
[0m21:18:57.059641 [debug] [MainThread]: Flushing usage events
[0m21:19:56.674784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00DFD2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C010A40190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C010A40050>]}


============================== 21:19:56.680217 | 95affc07-44a3-4c48-83cc-8fa4e4096549 ==============================
[0m21:19:56.680217 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:19:56.681250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:57.654137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00FDA1E00>]}
[0m21:19:57.718314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00FCBE030>]}
[0m21:19:57.720056 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:19:57.731406 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:19:57.825650 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:19:57.826348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C021CE4E50>]}
[0m21:19:59.618076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C021CCD130>]}
[0m21:19:59.765133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02202AEB0>]}
[0m21:19:59.765843 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m21:19:59.766592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C021DC6DD0>]}
[0m21:19:59.771587 [info ] [MainThread]: 
[0m21:19:59.773162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:59.780285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:19:59.800069 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:19:59.800655 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:19:59.801134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:00.726708 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.926 seconds
[0m21:20:00.728999 [debug] [ThreadPool]: On list_DEV: Close
[0m21:20:00.851476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m21:20:00.859195 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m21:20:00.859557 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m21:20:00.859846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:01.555673 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.696 seconds
[0m21:20:01.557518 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m21:20:01.659008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0231C9C10>]}
[0m21:20:01.659542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:20:01.659997 [info ] [MainThread]: 
[0m21:20:01.665956 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m21:20:01.666514 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m21:20:01.667187 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m21:20:01.667529 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m21:20:01.675284 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m21:20:01.677118 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m21:20:01.704015 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m21:20:01.706056 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m21:20:01.706838 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        high AS max_value,
        low AS min_value,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This refers to the source in schema.yml
)

SELECT
    date,
    symbol,
    open,
    max_value,
    min_value,
    close,
    volume
FROM raw_data
  );
[0m21:20:01.707269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:20:02.572424 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85be0-0004-2cec-0002-7a6f000133d6
[0m21:20:02.573062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 8
invalid identifier 'HIGH'
[0m21:20:02.573537 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m21:20:02.749397 [debug] [Thread-1 (]: Database Error in model raw_data_model (models\raw_data_model.sql)
  000904 (42000): SQL compilation error: error line 11 at position 8
  invalid identifier 'HIGH'
  compiled code at target\run\stock_dbt\models\raw_data_model.sql
[0m21:20:02.750831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95affc07-44a3-4c48-83cc-8fa4e4096549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C023365440>]}
[0m21:20:02.751493 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model raw_data.raw_data_model ................... [[31mERROR[0m in 1.08s]
[0m21:20:02.752508 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m21:20:02.754259 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m21:20:02.755001 [info ] [Thread-1 (]: 2 of 2 SKIP relation raw_data.transformations .................................. [[33mSKIP[0m]
[0m21:20:02.755647 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m21:20:02.757368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:02.757916 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m21:20:02.758367 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m21:20:02.758774 [debug] [MainThread]: Connection 'model.stock_dbt.raw_data_model' was properly closed.
[0m21:20:02.759265 [info ] [MainThread]: 
[0m21:20:02.760171 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m21:20:02.761877 [debug] [MainThread]: Command end result
[0m21:20:02.787242 [info ] [MainThread]: 
[0m21:20:02.787937 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:20:02.788479 [info ] [MainThread]: 
[0m21:20:02.789007 [error] [MainThread]:   Database Error in model raw_data_model (models\raw_data_model.sql)
  000904 (42000): SQL compilation error: error line 11 at position 8
  invalid identifier 'HIGH'
  compiled code at target\run\stock_dbt\models\raw_data_model.sql
[0m21:20:02.789543 [info ] [MainThread]: 
[0m21:20:02.790092 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m21:20:02.791176 [debug] [MainThread]: Command `dbt run` failed at 21:20:02.791040 after 6.24 seconds
[0m21:20:02.791567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C00CEE0CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0233F3DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02331E4D0>]}
[0m21:20:02.791920 [debug] [MainThread]: Flushing usage events
[0m21:23:47.805479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF12A12A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF15480190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF15480050>]}


============================== 21:23:47.815221 | 57dfd3ad-ad3e-454c-8112-ecee20296142 ==============================
[0m21:23:47.815221 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:23:47.816724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:23:49.904758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF147D9E00>]}
[0m21:23:49.976139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF146FE030>]}
[0m21:23:49.977818 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:23:49.988224 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:23:50.202258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:23:50.202969 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\raw_data_model.sql
[0m21:23:50.578305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF26A88750>]}
[0m21:23:50.701961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF268CF7A0>]}
[0m21:23:50.702551 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m21:23:50.703134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF268B5EF0>]}
[0m21:23:50.705580 [info ] [MainThread]: 
[0m21:23:50.706431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:50.711614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:23:50.728793 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:23:50.729290 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:23:50.729662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:51.582926 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.853 seconds
[0m21:23:51.585237 [debug] [ThreadPool]: On list_DEV: Close
[0m21:23:51.672574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m21:23:51.681029 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m21:23:51.681435 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m21:23:51.681762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:52.360270 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.678 seconds
[0m21:23:52.361940 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m21:23:52.487563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF269572B0>]}
[0m21:23:52.488131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:52.488645 [info ] [MainThread]: 
[0m21:23:52.493751 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m21:23:52.494314 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m21:23:52.495002 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m21:23:52.495362 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m21:23:52.502837 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m21:23:52.504385 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m21:23:52.535275 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m21:23:52.537102 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m21:23:52.537576 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS HIGH,
        min_value AS LOW,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This refers to the source in schema.yml
)

SELECT
    date,
    symbol,
    open,
    HIGH,
    LOW,
    close,
    volume
FROM raw_data
  );
[0m21:23:52.537977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:23:53.432770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m21:23:53.462149 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m21:23:53.564295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF27B990D0>]}
[0m21:23:53.565007 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.07s]
[0m21:23:53.565893 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m21:23:53.566855 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m21:23:53.567341 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m21:23:53.567998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m21:23:53.568382 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m21:23:53.571096 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m21:23:53.572047 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m21:23:53.593510 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m21:23:53.596051 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m21:23:53.596592 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (-- transformations.sql

WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        CASE
            WHEN AVG(CASE WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) ELSE 0 END) = 0 THEN 0
            ELSE
                100 - (100 / (1 + 
                AVG(CASE WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date) ELSE 0 END) / 
                AVG(CASE WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close ELSE 0 END)
                ))
        END AS rsi
    FROM source_data
    GROUP BY date, symbol
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    rsi_calc.rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_calc ON s.date = rsi_calc.date AND s.symbol = rsi_calc.symbol
        );
[0m21:23:53.597103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:54.427942 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85be3-0004-2cf4-0002-7a6f000153ae
[0m21:23:54.428741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002065 (42601): SQL compilation error:
Window function [LAG(SOURCE_DATA.CLOSE) OVER (PARTITION BY SOURCE_DATA.SYMBOL ORDER BY SOURCE_DATA.DATE ASC NULLS LAST)] may not appear inside an aggregate function.
[0m21:23:54.429545 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m21:23:54.517471 [debug] [Thread-1 (]: Database Error in model transformations (models\transformations.sql)
  002065 (42601): SQL compilation error:
  Window function [LAG(SOURCE_DATA.CLOSE) OVER (PARTITION BY SOURCE_DATA.SYMBOL ORDER BY SOURCE_DATA.DATE ASC NULLS LAST)] may not appear inside an aggregate function.
  compiled code at target\run\stock_dbt\models\transformations.sql
[0m21:23:54.518106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57dfd3ad-ad3e-454c-8112-ecee20296142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF27C39180>]}
[0m21:23:54.519200 [error] [Thread-1 (]: 2 of 2 ERROR creating sql table model raw_data.transformations ................. [[31mERROR[0m in 0.95s]
[0m21:23:54.524875 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m21:23:54.527314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:54.527779 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m21:23:54.528162 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m21:23:54.528509 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m21:23:54.528957 [info ] [MainThread]: 
[0m21:23:54.529578 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m21:23:54.530793 [debug] [MainThread]: Command end result
[0m21:23:54.575735 [info ] [MainThread]: 
[0m21:23:54.576501 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:23:54.577020 [info ] [MainThread]: 
[0m21:23:54.577660 [error] [MainThread]:   Database Error in model transformations (models\transformations.sql)
  002065 (42601): SQL compilation error:
  Window function [LAG(SOURCE_DATA.CLOSE) OVER (PARTITION BY SOURCE_DATA.SYMBOL ORDER BY SOURCE_DATA.DATE ASC NULLS LAST)] may not appear inside an aggregate function.
  compiled code at target\run\stock_dbt\models\transformations.sql
[0m21:23:54.578248 [info ] [MainThread]: 
[0m21:23:54.578819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:23:54.580098 [debug] [MainThread]: Command `dbt run` failed at 21:23:54.579938 after 7.03 seconds
[0m21:23:54.580582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF27C88910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF27D9A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF26262D50>]}
[0m21:23:54.581234 [debug] [MainThread]: Flushing usage events
[0m21:26:31.620263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D02432A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D04E60190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D04E60050>]}


============================== 21:26:31.624846 | 78c71ecb-444f-409b-a2f9-0b29792a0458 ==============================
[0m21:26:31.624846 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:26:31.625669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:36.109702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D041E1E00>]}
[0m21:26:36.158857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D040FE030>]}
[0m21:26:36.160270 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:26:36.180354 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:26:37.072263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:37.072953 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\transformations.sql
[0m21:26:37.332617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D164C8750>]}
[0m21:26:37.434631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1630F7A0>]}
[0m21:26:37.435091 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m21:26:37.435707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D162F5E10>]}
[0m21:26:37.438129 [info ] [MainThread]: 
[0m21:26:37.439097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:26:37.443112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m21:26:37.454894 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m21:26:37.455263 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m21:26:37.455546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:38.391999 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.936 seconds
[0m21:26:38.393708 [debug] [ThreadPool]: On list_DEV: Close
[0m21:26:38.479236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m21:26:38.491209 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m21:26:38.491727 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m21:26:38.492182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:39.714802 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.223 seconds
[0m21:26:39.716500 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m21:26:39.831895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D16397520>]}
[0m21:26:39.832531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:39.833142 [info ] [MainThread]: 
[0m21:26:39.838000 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m21:26:39.838645 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m21:26:39.839459 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m21:26:39.839878 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m21:26:39.848462 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m21:26:39.849524 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m21:26:39.879797 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m21:26:39.881126 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m21:26:39.881484 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS HIGH,
        min_value AS LOW,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This refers to the source in schema.yml
)

SELECT
    date,
    symbol,
    open,
    HIGH,
    LOW,
    close,
    volume
FROM raw_data
  );
[0m21:26:39.881816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:26:40.814707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m21:26:40.835726 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m21:26:40.929411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D175DA450>]}
[0m21:26:40.930065 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.09s]
[0m21:26:40.930898 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m21:26:40.931651 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m21:26:40.932115 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m21:26:40.932720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m21:26:40.933099 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m21:26:40.935600 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m21:26:40.936503 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m21:26:40.956166 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m21:26:40.958495 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m21:26:40.958943 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m21:26:40.959370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:42.968208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.008 seconds
[0m21:26:42.971659 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m21:26:43.085395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c71ecb-444f-409b-a2f9-0b29792a0458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D162871D0>]}
[0m21:26:43.087720 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.15s]
[0m21:26:43.090725 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m21:26:43.095121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:43.096362 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m21:26:43.097453 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m21:26:43.098512 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m21:26:43.099755 [info ] [MainThread]: 
[0m21:26:43.101778 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m21:26:43.106158 [debug] [MainThread]: Command end result
[0m21:26:43.145952 [info ] [MainThread]: 
[0m21:26:43.146531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:43.147000 [info ] [MainThread]: 
[0m21:26:43.147485 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:26:43.148512 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:43.148394 after 11.69 seconds
[0m21:26:43.148840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D176CC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D175AD6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D029ADA50>]}
[0m21:26:43.149241 [debug] [MainThread]: Flushing usage events
[0m05:49:05.929354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb029b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb0a8d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb0a8d340>]}


============================== 05:49:05.949020 | 1f1dd47c-3241-41f7-a75b-cd465e8c46da ==============================
[0m05:49:05.949020 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:49:05.950417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:49:10.858712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c950b10d0>]}
[0m05:49:10.927683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8eb72240>]}
[0m05:49:10.929899 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:49:11.057664 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:49:11.307847 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m05:49:11.309597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8e67c0b0>]}
[0m05:49:12.917009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8e795850>]}
[0m05:49:13.131301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8d3bc170>]}
[0m05:49:13.132607 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m05:49:13.133829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8e82d2e0>]}
[0m05:49:13.136678 [info ] [MainThread]: 
[0m05:49:13.138417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:49:13.145652 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:49:13.193920 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:49:13.195563 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:49:13.196838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:49:14.800497 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.604 seconds
[0m05:49:14.803395 [debug] [ThreadPool]: On list_dev: Close
[0m05:49:14.910953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m05:49:14.923527 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m05:49:14.924847 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m05:49:14.925877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:49:15.367697 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.442 seconds
[0m05:49:15.375928 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m05:49:15.501236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb06e6600>]}
[0m05:49:15.502650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:49:15.503804 [info ] [MainThread]: 
[0m05:49:15.514833 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m05:49:15.517765 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m05:49:15.519410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now model.stock_dbt.raw_data_model)
[0m05:49:15.520652 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m05:49:15.529770 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m05:49:15.536766 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m05:49:15.580712 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m05:49:15.591443 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m05:49:15.592703 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view dev.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS HIGH,
        min_value AS LOW,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This refers to the source in schema.yml
)

SELECT
    date,
    symbol,
    open,
    HIGH,
    LOW,
    close,
    volume
FROM raw_data
  );
[0m05:49:15.593805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:49:16.263573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m05:49:16.302429 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m05:49:16.423532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb0a8ed80>]}
[0m05:49:16.426076 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 0.90s]
[0m05:49:16.428473 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m05:49:16.431342 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m05:49:16.432670 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m05:49:16.433878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m05:49:16.434938 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m05:49:16.439034 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m05:49:16.446947 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m05:49:16.474424 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m05:49:16.483637 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m05:49:16.485081 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table dev.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        dev.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m05:49:16.486259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:49:17.942622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.456 seconds
[0m05:49:17.948921 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m05:49:18.214924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f1dd47c-3241-41f7-a75b-cd465e8c46da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8e7383e0>]}
[0m05:49:18.217154 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 1.78s]
[0m05:49:18.218848 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m05:49:18.222320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:49:18.224016 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m05:49:18.225330 [info ] [MainThread]: 
[0m05:49:18.226928 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m05:49:18.229307 [debug] [MainThread]: Command end result
[0m05:49:18.302748 [info ] [MainThread]: 
[0m05:49:18.306128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:49:18.308403 [info ] [MainThread]: 
[0m05:49:18.310136 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:49:18.312831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.46796, "process_user_time": 7.116893, "process_kernel_time": 7.116893, "process_mem_max_rss": "231548", "process_in_blocks": "89224", "process_out_blocks": "3744"}
[0m05:49:18.314529 [debug] [MainThread]: Command `dbt run` succeeded at 05:49:18.314354 after 12.47 seconds
[0m05:49:18.315960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9509ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb06e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8e706810>]}
[0m05:49:18.317418 [debug] [MainThread]: Flushing usage events
[0m05:49:22.699919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d46b3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d46b2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d3ec9f40>]}


============================== 05:49:22.722911 | 58d49e2e-3ae8-4387-b918-f9f44bd1491a ==============================
[0m05:49:22.722911 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:49:22.724534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:49:23.712833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d49e2e-3ae8-4387-b918-f9f44bd1491a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d3afa2a0>]}
[0m05:49:23.771676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58d49e2e-3ae8-4387-b918-f9f44bd1491a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d43734d0>]}
[0m05:49:23.773351 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:49:23.882871 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:49:24.042008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:49:24.043433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:49:24.079754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58d49e2e-3ae8-4387-b918-f9f44bd1491a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b263c710>]}
[0m05:49:24.234087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58d49e2e-3ae8-4387-b918-f9f44bd1491a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b212a690>]}
[0m05:49:24.237412 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m05:49:24.239155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58d49e2e-3ae8-4387-b918-f9f44bd1491a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b20f51f0>]}
[0m05:49:24.242035 [info ] [MainThread]: 
[0m05:49:24.243585 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:49:24.246573 [debug] [MainThread]: Command end result
[0m05:49:24.323287 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7313745, "process_user_time": 3.305204, "process_kernel_time": 1.028507, "process_mem_max_rss": "222268", "process_in_blocks": "6056", "process_out_blocks": "0"}
[0m05:49:24.325012 [debug] [MainThread]: Command `dbt test` succeeded at 05:49:24.324846 after 1.73 seconds
[0m05:49:24.326686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d3f17cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b29b4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b81da510>]}
[0m05:49:24.328350 [debug] [MainThread]: Flushing usage events
[0m05:49:28.026117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327d7a39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327ddc5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327d906ae0>]}


============================== 05:49:28.032818 | 7da7c208-dd7a-4b20-a839-d7675eb21cbc ==============================
[0m05:49:28.032818 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:49:28.034342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:49:29.005320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7da7c208-dd7a-4b20-a839-d7675eb21cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327d45d4c0>]}
[0m05:49:29.063033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7da7c208-dd7a-4b20-a839-d7675eb21cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326793f6b0>]}
[0m05:49:29.064787 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:49:29.160127 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:49:29.304165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:49:29.305365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:49:29.340627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da7c208-dd7a-4b20-a839-d7675eb21cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327e314e60>]}
[0m05:49:29.453471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da7c208-dd7a-4b20-a839-d7675eb21cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325ba88fb0>]}
[0m05:49:29.454609 [info ] [MainThread]: Found 2 models, 1 source, 459 macros
[0m05:49:29.455673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da7c208-dd7a-4b20-a839-d7675eb21cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325bd41610>]}
[0m05:49:29.458074 [info ] [MainThread]: 
[0m05:49:29.459226 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:49:29.461712 [debug] [MainThread]: Command end result
[0m05:49:29.511347 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5847871, "process_user_time": 3.467421, "process_kernel_time": 0.832181, "process_mem_max_rss": "214872", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m05:49:29.512711 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:49:29.512554 after 1.59 seconds
[0m05:49:29.513773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327ff160c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f326793e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f327de97c20>]}
[0m05:49:29.514918 [debug] [MainThread]: Flushing usage events
[0m00:40:38.968661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403B402A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403DE70190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403DE70050>]}


============================== 00:40:38.973783 | 2e0bd2f1-ffd2-463f-95ea-86cfb4c0d10a ==============================
[0m00:40:38.973783 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:40:38.974819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:40:43.416510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e0bd2f1-ffd2-463f-95ea-86cfb4c0d10a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403D1D1E00>]}
[0m00:40:43.468031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e0bd2f1-ffd2-463f-95ea-86cfb4c0d10a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403D0EE030>]}
[0m00:40:43.469450 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:40:43.490632 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:40:43.576531 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:40:43.577139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e0bd2f1-ffd2-463f-95ea-86cfb4c0d10a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F104E50>]}
[0m00:40:45.721943 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m00:40:45.723108 [debug] [MainThread]: Command `dbt run` failed at 00:40:45.722955 after 7.01 seconds
[0m00:40:45.723471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F11EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F11EC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403DEB3E70>]}
[0m00:40:45.723822 [debug] [MainThread]: Flushing usage events
[0m00:42:10.568559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022930A2EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229334A0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229334A0050>]}


============================== 00:42:10.572486 | 0029d9b7-eba8-4c2b-a79b-4a4791afcfaa ==============================
[0m00:42:10.572486 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:42:10.573149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:11.454266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0029d9b7-eba8-4c2b-a79b-4a4791afcfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229327F9E00>]}
[0m00:42:11.505842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0029d9b7-eba8-4c2b-a79b-4a4791afcfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293271E030>]}
[0m00:42:11.507231 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:42:11.514628 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:42:11.587528 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:42:11.588089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0029d9b7-eba8-4c2b-a79b-4a4791afcfaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022944710E50>]}
[0m00:42:12.640914 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  invalid syntax for function call expression
    line 3
      config(
[0m00:42:12.642118 [debug] [MainThread]: Command `dbt run` failed at 00:42:12.641982 after 2.21 seconds
[0m00:42:12.642524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002294473EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002294473EC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229334E3E70>]}
[0m00:42:12.642884 [debug] [MainThread]: Flushing usage events
[0m00:44:39.741789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B02EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095DAA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095DAA0050>]}


============================== 00:44:39.748672 | f557b6bc-3efe-45da-ad3d-c020790b7a4a ==============================
[0m00:44:39.748672 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:44:39.749936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:44:41.011978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f557b6bc-3efe-45da-ad3d-c020790b7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095CE01E00>]}
[0m00:44:41.063532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f557b6bc-3efe-45da-ad3d-c020790b7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095CD1E030>]}
[0m00:44:41.064956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:44:41.072809 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:44:41.147701 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:44:41.148325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f557b6bc-3efe-45da-ad3d-c020790b7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096EDD4E50>]}
[0m00:44:42.198741 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m00:44:42.199917 [debug] [MainThread]: Command `dbt run` failed at 00:44:42.199780 after 2.68 seconds
[0m00:44:42.200303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096EF56E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002096EF56C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095DAE3E70>]}
[0m00:44:42.200648 [debug] [MainThread]: Flushing usage events
[0m00:49:27.721654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B993EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BC3B0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BC3B0050>]}


============================== 00:49:27.726179 | 9d99745b-c3db-40fa-99ea-d62d645841e8 ==============================
[0m00:49:27.726179 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:49:27.727091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:49:28.986233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d99745b-c3db-40fa-99ea-d62d645841e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BB709E00>]}
[0m00:49:29.038719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d99745b-c3db-40fa-99ea-d62d645841e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BB62E030>]}
[0m00:49:29.040108 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:49:29.049163 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:49:29.123325 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:49:29.123861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d99745b-c3db-40fa-99ea-d62d645841e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CD698E50>]}
[0m00:49:30.237801 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  invalid syntax for function call expression
    line 4
      config(
[0m00:49:30.239001 [debug] [MainThread]: Command `dbt run` failed at 00:49:30.238849 after 2.68 seconds
[0m00:49:30.239380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CD6CEE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CD6CEC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8BC3F3E70>]}
[0m00:49:30.239764 [debug] [MainThread]: Flushing usage events
[0m00:50:53.481937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62851EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62AFA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62AFA0050>]}


============================== 00:50:53.486043 | cab6d9c3-8bfa-494d-a71e-e91f7856d475 ==============================
[0m00:50:53.486043 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:50:53.486742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:50:54.400186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab6d9c3-8bfa-494d-a71e-e91f7856d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62A2F1E00>]}
[0m00:50:54.452255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cab6d9c3-8bfa-494d-a71e-e91f7856d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62A20E030>]}
[0m00:50:54.453529 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:50:54.461464 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:50:54.536130 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:50:54.536646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cab6d9c3-8bfa-494d-a71e-e91f7856d475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63C200E50>]}
[0m00:50:55.638267 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  Encountered unknown tag 'config'.
    line 3
      {%- config(
[0m00:50:55.640001 [debug] [MainThread]: Command `dbt run` failed at 00:50:55.639732 after 2.27 seconds
[0m00:50:55.640499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63C23EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63C23EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E62AFE3E70>]}
[0m00:50:55.640919 [debug] [MainThread]: Flushing usage events
[0m00:55:54.815271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B4FFEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B7A74190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B7A74050>]}


============================== 00:55:54.819948 | beeea1fb-7fa0-4fea-993c-c7bf6e3b148d ==============================
[0m00:55:54.819948 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:55:54.820650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:55:54.853189 [info ] [MainThread]: dbt version: 1.8.8
[0m00:55:54.853740 [info ] [MainThread]: python version: 3.13.0
[0m00:55:54.854161 [info ] [MainThread]: python path: C:\Users\mtann\AppData\Local\Programs\Python\Python313\python.exe
[0m00:55:54.854585 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m00:55:55.637403 [info ] [MainThread]: Using profiles dir at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt
[0m00:55:55.638012 [info ] [MainThread]: Using profiles.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\profiles.yml
[0m00:55:55.638456 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\dbt_project.yml
[0m00:55:55.639864 [info ] [MainThread]: adapter type: snowflake
[0m00:55:55.640480 [info ] [MainThread]: adapter version: 1.8.4
[0m00:55:55.724583 [info ] [MainThread]: Configuration:
[0m00:55:55.725170 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:55:55.725654 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:55:55.726187 [info ] [MainThread]: Required dependencies:
[0m00:55:55.726755 [debug] [MainThread]: Executing "git --help"
[0m00:55:55.786150 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:55:55.786612 [debug] [MainThread]: STDERR: "b''"
[0m00:55:55.786969 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:55:55.787422 [info ] [MainThread]: Connection:
[0m00:55:55.787883 [info ] [MainThread]:   account: mzuubyx-ctb21060
[0m00:55:55.788327 [info ] [MainThread]:   user: Mansi06
[0m00:55:55.788787 [info ] [MainThread]:   database: DEV
[0m00:55:55.789226 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m00:55:55.789666 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:55:55.790107 [info ] [MainThread]:   schema: raw_data
[0m00:55:55.790556 [info ] [MainThread]:   authenticator: None
[0m00:55:55.791008 [info ] [MainThread]:   oauth_client_id: None
[0m00:55:55.791456 [info ] [MainThread]:   query_tag: None
[0m00:55:55.791916 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:55:55.792363 [info ] [MainThread]:   host: None
[0m00:55:55.792856 [info ] [MainThread]:   port: None
[0m00:55:55.793309 [info ] [MainThread]:   proxy_host: None
[0m00:55:55.793757 [info ] [MainThread]:   proxy_port: None
[0m00:55:55.794214 [info ] [MainThread]:   protocol: None
[0m00:55:55.794665 [info ] [MainThread]:   connect_retries: 1
[0m00:55:55.795114 [info ] [MainThread]:   connect_timeout: None
[0m00:55:55.795567 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:55:55.796021 [info ] [MainThread]:   retry_all: False
[0m00:55:55.796523 [info ] [MainThread]:   insecure_mode: False
[0m00:55:55.796900 [info ] [MainThread]:   reuse_connections: None
[0m00:55:55.797582 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:55:55.798245 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:55:55.798875 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:55:55.799181 [debug] [MainThread]: On debug: select 1 as id
[0m00:55:55.799483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:56.787327 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.988 seconds
[0m00:55:56.788620 [debug] [MainThread]: On debug: Close
[0m00:55:56.902594 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:55:56.903332 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:55:56.904909 [debug] [MainThread]: Command `dbt debug` succeeded at 00:55:56.904708 after 2.18 seconds
[0m00:55:56.905409 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:55:56.905953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C8D48180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C8D0E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184B6D98AF0>]}
[0m00:55:56.906514 [debug] [MainThread]: Flushing usage events
[0m00:56:03.269990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A366EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A60E0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A60E0050>]}


============================== 00:56:03.273619 | 788b2a1e-d41e-4bca-ae7c-5dc695c76992 ==============================
[0m00:56:03.273619 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:56:03.274238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:04.145397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '788b2a1e-d41e-4bca-ae7c-5dc695c76992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A5441E00>]}
[0m00:56:04.195806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '788b2a1e-d41e-4bca-ae7c-5dc695c76992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A535E030>]}
[0m00:56:04.197155 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:56:04.208144 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:56:04.281537 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:56:04.282088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '788b2a1e-d41e-4bca-ae7c-5dc695c76992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293B73F0E50>]}
[0m00:56:05.288631 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  Encountered unknown tag 'snapshot_config'.
    line 4
      {% snapshot_config(
[0m00:56:05.289993 [debug] [MainThread]: Command `dbt run` failed at 00:56:05.289837 after 2.11 seconds
[0m00:56:05.290368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293B740D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293B740EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A6123E70>]}
[0m00:56:05.290722 [debug] [MainThread]: Flushing usage events
[0m00:59:19.886919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147223FEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014724E80190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014724E80050>]}


============================== 00:59:19.890912 | 184ed27c-2333-4dc0-bd81-c51a7cc7fbda ==============================
[0m00:59:19.890912 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:59:19.891524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:20.864933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '184ed27c-2333-4dc0-bd81-c51a7cc7fbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147241D1E00>]}
[0m00:59:20.917353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '184ed27c-2333-4dc0-bd81-c51a7cc7fbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000147240EE030>]}
[0m00:59:20.918723 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:59:20.926465 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:59:20.999762 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:59:21.000368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '184ed27c-2333-4dc0-bd81-c51a7cc7fbda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014736130E50>]}
[0m00:59:22.001367 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  Encountered unknown tag 'snapshot_config'.
    line 3
      {% snapshot_config(
[0m00:59:22.002808 [debug] [MainThread]: Command `dbt run` failed at 00:59:22.002667 after 2.25 seconds
[0m00:59:22.003216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473616D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001473616EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014724EC3E70>]}
[0m00:59:22.003580 [debug] [MainThread]: Flushing usage events
[0m00:59:28.517868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6AC13EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6AEBC0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6AEBC0050>]}


============================== 00:59:28.521721 | cbffd50b-f889-4a5c-859d-414128ecac69 ==============================
[0m00:59:28.521721 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:59:28.522386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:59:28.541295 [info ] [MainThread]: dbt version: 1.8.8
[0m00:59:28.541818 [info ] [MainThread]: python version: 3.13.0
[0m00:59:28.542239 [info ] [MainThread]: python path: C:\Users\mtann\AppData\Local\Programs\Python\Python313\python.exe
[0m00:59:28.542665 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m00:59:29.275175 [info ] [MainThread]: Using profiles dir at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt
[0m00:59:29.275713 [info ] [MainThread]: Using profiles.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\profiles.yml
[0m00:59:29.276115 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\dbt_project.yml
[0m00:59:29.277294 [info ] [MainThread]: adapter type: snowflake
[0m00:59:29.277794 [info ] [MainThread]: adapter version: 1.8.4
[0m00:59:29.359353 [info ] [MainThread]: Configuration:
[0m00:59:29.359985 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:59:29.360461 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:59:29.360921 [info ] [MainThread]: Required dependencies:
[0m00:59:29.361421 [debug] [MainThread]: Executing "git --help"
[0m00:59:29.392144 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:59:29.392629 [debug] [MainThread]: STDERR: "b''"
[0m00:59:29.392983 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:59:29.393469 [info ] [MainThread]: Connection:
[0m00:59:29.393932 [info ] [MainThread]:   account: mzuubyx-ctb21060
[0m00:59:29.394365 [info ] [MainThread]:   user: Mansi06
[0m00:59:29.394791 [info ] [MainThread]:   database: DEV
[0m00:59:29.395223 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m00:59:29.395649 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:59:29.396077 [info ] [MainThread]:   schema: raw_data
[0m00:59:29.396503 [info ] [MainThread]:   authenticator: None
[0m00:59:29.396929 [info ] [MainThread]:   oauth_client_id: None
[0m00:59:29.397354 [info ] [MainThread]:   query_tag: None
[0m00:59:29.397794 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:59:29.398221 [info ] [MainThread]:   host: None
[0m00:59:29.398647 [info ] [MainThread]:   port: None
[0m00:59:29.399095 [info ] [MainThread]:   proxy_host: None
[0m00:59:29.399524 [info ] [MainThread]:   proxy_port: None
[0m00:59:29.399949 [info ] [MainThread]:   protocol: None
[0m00:59:29.400386 [info ] [MainThread]:   connect_retries: 1
[0m00:59:29.400759 [info ] [MainThread]:   connect_timeout: None
[0m00:59:29.401183 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:59:29.401646 [info ] [MainThread]:   retry_all: False
[0m00:59:29.402113 [info ] [MainThread]:   insecure_mode: False
[0m00:59:29.402525 [info ] [MainThread]:   reuse_connections: None
[0m00:59:29.403165 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:59:29.403742 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:59:29.404345 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:59:29.404641 [debug] [MainThread]: On debug: select 1 as id
[0m00:59:29.404919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:30.343283 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.938 seconds
[0m00:59:30.344286 [debug] [MainThread]: On debug: Close
[0m00:59:30.473680 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:59:30.474355 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:59:30.475538 [debug] [MainThread]: Command `dbt debug` succeeded at 00:59:30.475397 after 2.05 seconds
[0m00:59:30.476035 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:59:30.476583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BFE88180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6BFE4E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6ADED8AF0>]}
[0m00:59:30.477094 [debug] [MainThread]: Flushing usage events
[0m01:01:04.340602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DEFDEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7E1A60190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7E1A60050>]}


============================== 01:01:04.344357 | 6985cfcc-05c7-4ddf-a7fa-a9d356e241f8 ==============================
[0m01:01:04.344357 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:01:04.344976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --exclude snapshot:*', 'send_anonymous_usage_stats': 'True'}
[0m01:01:05.185175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6985cfcc-05c7-4ddf-a7fa-a9d356e241f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7E0DB1E00>]}
[0m01:01:05.236603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6985cfcc-05c7-4ddf-a7fa-a9d356e241f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7E0CCE030>]}
[0m01:01:05.237982 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:01:05.245945 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:01:05.318672 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:01:05.319257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6985cfcc-05c7-4ddf-a7fa-a9d356e241f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F2D28E50>]}
[0m01:01:06.363466 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  Encountered unknown tag 'snapshot_config'.
    line 3
      {% snapshot_config(
[0m01:01:06.364673 [debug] [MainThread]: Command `dbt run` failed at 01:01:06.364529 after 2.16 seconds
[0m01:01:06.365037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F2D3D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F2D3EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7E1AA3E70>]}
[0m01:01:06.365405 [debug] [MainThread]: Flushing usage events
[0m01:01:32.133176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92EBDEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E931650190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E931650050>]}


============================== 01:01:32.137068 | fc2ce93c-3429-4245-abcc-766a4060c0e8 ==============================
[0m01:01:32.137068 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:01:32.137776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:01:33.068855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9309B1E00>]}
[0m01:01:33.121989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9308CE030>]}
[0m01:01:33.123249 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:01:33.130581 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:01:33.202755 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:01:33.203312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9428B4E50>]}
[0m01:01:34.306702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94289D130>]}
[0m01:01:34.437135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E942BFAEB0>]}
[0m01:01:34.437586 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m01:01:34.438080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9429F2DD0>]}
[0m01:01:34.440453 [info ] [MainThread]: 
[0m01:01:34.441351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:01:34.445558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m01:01:34.457050 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m01:01:34.457438 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m01:01:34.457736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:35.380260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.922 seconds
[0m01:01:35.382012 [debug] [ThreadPool]: On list_DEV: Close
[0m01:01:35.505977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m01:01:35.522883 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:01:35.523535 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:01:35.524028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:36.346011 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.822 seconds
[0m01:01:36.347723 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:01:36.452491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E943D99C10>]}
[0m01:01:36.453432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:01:36.454195 [info ] [MainThread]: 
[0m01:01:36.461441 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m01:01:36.462011 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m01:01:36.462748 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m01:01:36.463108 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m01:01:36.470239 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m01:01:36.471363 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m01:01:36.498447 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m01:01:36.500514 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m01:01:36.501030 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m01:01:36.501507 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:01:37.766339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.264 seconds
[0m01:01:37.812781 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m01:01:37.956530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E943F352E0>]}
[0m01:01:37.958992 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.49s]
[0m01:01:37.961909 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m01:01:37.964195 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m01:01:37.965378 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m01:01:37.966714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m01:01:37.967560 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m01:01:37.972399 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m01:01:37.973901 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m01:01:37.997403 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m01:01:37.999961 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m01:01:38.000388 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m01:01:38.000802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:40.301369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.300 seconds
[0m01:01:40.303910 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m01:01:40.425684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc2ce93c-3429-4245-abcc-766a4060c0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E943E35C70>]}
[0m01:01:40.426331 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.46s]
[0m01:01:40.427057 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m01:01:40.428569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:40.428917 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m01:01:40.429169 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m01:01:40.429412 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m01:01:40.429711 [info ] [MainThread]: 
[0m01:01:40.430214 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m01:01:40.431293 [debug] [MainThread]: Command end result
[0m01:01:40.456712 [info ] [MainThread]: 
[0m01:01:40.457398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:01:40.457949 [info ] [MainThread]: 
[0m01:01:40.458414 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:01:40.459485 [debug] [MainThread]: Command `dbt run` succeeded at 01:01:40.459350 after 8.42 seconds
[0m01:01:40.459856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9309648D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E942B05850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E931696C80>]}
[0m01:01:40.460198 [debug] [MainThread]: Flushing usage events
[0m01:02:03.330437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241588C2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415B340190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415B340050>]}


============================== 01:02:03.334971 | 67c70009-02ea-4687-a5ca-e56fc27d084e ==============================
[0m01:02:03.334971 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:02:03.335646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:04.189518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67c70009-02ea-4687-a5ca-e56fc27d084e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415A689E00>]}
[0m01:02:04.240984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67c70009-02ea-4687-a5ca-e56fc27d084e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415A5AE030>]}
[0m01:02:04.242318 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:02:04.250551 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:02:04.386649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:04.387015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:04.417268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67c70009-02ea-4687-a5ca-e56fc27d084e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416C5B6950>]}
[0m01:02:04.568765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67c70009-02ea-4687-a5ca-e56fc27d084e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416C90C8C0>]}
[0m01:02:04.569237 [info ] [MainThread]: Found 2 models, 1 source, 454 macros
[0m01:02:04.569814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67c70009-02ea-4687-a5ca-e56fc27d084e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416C5CFCB0>]}
[0m01:02:04.571367 [info ] [MainThread]: 
[0m01:02:04.571922 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:02:04.573962 [debug] [MainThread]: Command end result
[0m01:02:04.595895 [debug] [MainThread]: Command `dbt test` succeeded at 01:02:04.595733 after 1.36 seconds
[0m01:02:04.596261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416C907EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002415B26FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002416C7A2990>]}
[0m01:02:04.596633 [debug] [MainThread]: Flushing usage events
[0m01:05:39.585639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628B73EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628E1B0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628E1B0050>]}


============================== 01:05:39.589373 | a61ffd3e-5fe8-44d0-bbe1-44a72636a506 ==============================
[0m01:05:39.589373 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:05:39.590036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:05:40.461228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a61ffd3e-5fe8-44d0-bbe1-44a72636a506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628D509E00>]}
[0m01:05:40.523578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a61ffd3e-5fe8-44d0-bbe1-44a72636a506', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002628D42E030>]}
[0m01:05:40.525521 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:05:40.538994 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:05:40.695132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:05:40.695622 [debug] [MainThread]: Partial parsing: added file: stock_dbt://snapshots\raw_data_snapshot.sql
[0m01:05:40.849376 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  Encountered unknown tag 'snapshot_config'.
    line 3
      {% snapshot_config(
[0m01:05:40.850606 [debug] [MainThread]: Command `dbt snapshot` failed at 01:05:40.850448 after 1.40 seconds
[0m01:05:40.851061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629F44EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629F44ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002629F63CC80>]}
[0m01:05:40.851607 [debug] [MainThread]: Flushing usage events
[0m01:09:04.239680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215C5B6EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215C85F0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215C85F0050>]}


============================== 01:09:04.243508 | a128d762-dea2-4a1e-976c-adf139362664 ==============================
[0m01:09:04.243508 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:09:04.244200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:09:05.103554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a128d762-dea2-4a1e-976c-adf139362664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215C7939E00>]}
[0m01:09:05.154476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a128d762-dea2-4a1e-976c-adf139362664', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215C785E030>]}
[0m01:09:05.155766 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:09:05.163356 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:09:05.286076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:09:05.286571 [debug] [MainThread]: Partial parsing: added file: stock_dbt://snapshots\raw_data_snapshot.sql
[0m01:09:05.448393 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: Snapshots must be configured with a 'strategy', 'unique_key', and 'target_schema'.
[0m01:09:05.449548 [debug] [MainThread]: Command `dbt run` failed at 01:09:05.449407 after 1.30 seconds
[0m01:09:05.449907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D98DAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D98DAE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215D9ABD5E0>]}
[0m01:09:05.450255 [debug] [MainThread]: Flushing usage events
[0m01:10:18.749345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F7082EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F732A0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F732A0050>]}


============================== 01:10:18.753249 | 6a0a0e69-f3bf-4dbd-bad4-d43dcd15a4d4 ==============================
[0m01:10:18.753249 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:10:18.753917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:10:18.859567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a0a0e69-f3bf-4dbd-bad4-d43dcd15a4d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F7216F230>]}
[0m01:10:18.884525 [debug] [MainThread]: Command `dbt clean` succeeded at 01:10:18.884400 after 0.27 seconds
[0m01:10:18.884886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F73243BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F734E9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F73295D50>]}
[0m01:10:18.885231 [debug] [MainThread]: Flushing usage events
[0m01:14:02.428432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BDAC42A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BDD6B0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BDD6B0050>]}


============================== 01:14:02.432212 | 1b069b46-0458-4a2c-aaf5-fc4954608bd0 ==============================
[0m01:14:02.432212 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:14:02.432887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:03.271294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b069b46-0458-4a2c-aaf5-fc4954608bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BDCA09E00>]}
[0m01:14:03.322854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b069b46-0458-4a2c-aaf5-fc4954608bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BDC92E030>]}
[0m01:14:03.324186 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:14:03.331984 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:14:03.333126 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:14:03.333686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b069b46-0458-4a2c-aaf5-fc4954608bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BEE960250>]}
[0m01:14:04.383267 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot raw_data_snapshot (snapshots\raw_data_snapshot.sql)
  Encountered unknown tag 'config'.
    line 3
      {% config(
[0m01:14:04.384483 [debug] [MainThread]: Command `dbt snapshot` failed at 01:14:04.384328 after 2.09 seconds
[0m01:14:04.384854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BEE9C6B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BEE9C75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BDD6F3E70>]}
[0m01:14:04.385202 [debug] [MainThread]: Flushing usage events
[0m01:20:06.835971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F301EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F5A90190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F5A90050>]}


============================== 01:20:06.839989 | 028be7a0-072c-491d-87ff-09867ae3fcc5 ==============================
[0m01:20:06.839989 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:20:06.840667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:20:07.755136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D286DF1E00>]}
[0m01:20:07.806393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D286D0E030>]}
[0m01:20:07.807860 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:20:07.816039 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:20:07.816986 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:20:07.817473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D286EC0250>]}
[0m01:20:09.150836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D286F23890>]}
[0m01:20:09.257042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288375710>]}
[0m01:20:09.257508 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 454 macros
[0m01:20:09.258011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288343860>]}
[0m01:20:09.259624 [info ] [MainThread]: 
[0m01:20:09.260387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:20:09.261486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m01:20:09.275508 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m01:20:09.275897 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m01:20:09.276189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:10.177615 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.901 seconds
[0m01:20:10.179492 [debug] [ThreadPool]: On list_DEV: Close
[0m01:20:10.310070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now create_DEV_snapshot)
[0m01:20:10.310978 [debug] [ThreadPool]: Creating schema "database: "DEV"
schema: "snapshot"
"
[0m01:20:10.315390 [debug] [ThreadPool]: Using snowflake connection "create_DEV_snapshot"
[0m01:20:10.315798 [debug] [ThreadPool]: On create_DEV_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "create_DEV_snapshot"} */
create schema if not exists DEV.snapshot
[0m01:20:10.316122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:11.221397 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.905 seconds
[0m01:20:11.222855 [debug] [ThreadPool]: On create_DEV_snapshot: Close
[0m01:20:11.350839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_snapshot'
[0m01:20:11.358375 [debug] [ThreadPool]: Using snowflake connection "list_DEV_snapshot"
[0m01:20:11.358739 [debug] [ThreadPool]: On list_DEV_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_snapshot"} */
show objects in DEV.snapshot limit 10000
[0m01:20:11.359030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:12.170825 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.811 seconds
[0m01:20:12.176546 [debug] [ThreadPool]: On list_DEV_snapshot: Close
[0m01:20:12.313775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_snapshot, now list_DEV_raw_data)
[0m01:20:12.315722 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:20:12.316088 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:20:12.316419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:13.017762 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.701 seconds
[0m01:20:13.021296 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:20:13.130194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288508C50>]}
[0m01:20:13.130736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:13.131257 [info ] [MainThread]: 
[0m01:20:13.135081 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.snapshot_stock_data
[0m01:20:13.135665 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_stock_data ............................. [RUN]
[0m01:20:13.136399 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.stock_dbt.snapshot_stock_data'
[0m01:20:13.136766 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.snapshot_stock_data
[0m01:20:13.146068 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.snapshot_stock_data
[0m01:20:13.241630 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_stock_data"
[0m01:20:13.242370 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_stock_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_stock_data"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_stock_data"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    date,
    symbol,
    open,
    max_value,
    min_value,
    close,
    volume
FROM dev.raw_data.stock_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m01:20:13.243215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:14.605774 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.362 seconds
[0m01:20:14.618476 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_stock_data"
[0m01:20:14.619674 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_stock_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_stock_data"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_stock_data"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:20:14.750059 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.129 seconds
[0m01:20:14.752213 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.snapshot_stock_data"
[0m01:20:14.759633 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.snapshot_stock_data"
[0m01:20:14.761330 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_stock_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.snapshot_stock_data"} */
create or replace transient table DEV.snapshot.snapshot_stock_data
         as
        (
    

    select *,
        md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))) as dbt_valid_to
    from (
        



SELECT 
    date,
    symbol,
    open,
    max_value,
    min_value,
    close,
    volume
FROM dev.raw_data.stock_data

    ) sbq



        );
[0m01:20:15.965607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m01:20:15.989788 [debug] [Thread-1 (]: On snapshot.stock_dbt.snapshot_stock_data: Close
[0m01:20:16.123281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028be7a0-072c-491d-87ff-09867ae3fcc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D28866CF70>]}
[0m01:20:16.124583 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_stock_data ............................. [[32mSUCCESS 1[0m in 2.99s]
[0m01:20:16.125915 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.snapshot_stock_data
[0m01:20:16.128197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:16.128721 [debug] [MainThread]: Connection 'create_DEV_snapshot' was properly closed.
[0m01:20:16.129187 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m01:20:16.129646 [debug] [MainThread]: Connection 'snapshot.stock_dbt.snapshot_stock_data' was properly closed.
[0m01:20:16.130231 [info ] [MainThread]: 
[0m01:20:16.131053 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m01:20:16.132446 [debug] [MainThread]: Command end result
[0m01:20:16.166795 [info ] [MainThread]: 
[0m01:20:16.167480 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:16.167929 [info ] [MainThread]: 
[0m01:20:16.168438 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:20:16.169626 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:20:16.169499 after 9.50 seconds
[0m01:20:16.169985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288587B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D288693C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2881DE9D0>]}
[0m01:20:16.170337 [debug] [MainThread]: Flushing usage events
[0m01:20:23.975681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544D3DEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FE60190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FE60050>]}


============================== 01:20:23.979607 | 802aaa42-9460-4236-bc1b-12dc9bb4a1eb ==============================
[0m01:20:23.979607 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:20:23.980248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:20:24.889826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544F1B1E00>]}
[0m01:20:24.941126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544F0CE030>]}
[0m01:20:24.942451 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:20:24.950034 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:20:25.108127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:25.108498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:25.149829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025461190450>]}
[0m01:20:25.257823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546117DF40>]}
[0m01:20:25.258512 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 454 macros
[0m01:20:25.259191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544F126EB0>]}
[0m01:20:25.261764 [info ] [MainThread]: 
[0m01:20:25.262721 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:20:25.268433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m01:20:25.284198 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m01:20:25.284637 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m01:20:25.284968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:26.317611 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.033 seconds
[0m01:20:26.320014 [debug] [ThreadPool]: On list_DEV: Close
[0m01:20:26.459529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_snapshot'
[0m01:20:26.476307 [debug] [ThreadPool]: Using snowflake connection "list_DEV_snapshot"
[0m01:20:26.476976 [debug] [ThreadPool]: On list_DEV_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_snapshot"} */
show objects in DEV.snapshot limit 10000
[0m01:20:26.477499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:27.304823 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.827 seconds
[0m01:20:27.307640 [debug] [ThreadPool]: On list_DEV_snapshot: Close
[0m01:20:27.411866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_snapshot, now list_DEV_raw_data)
[0m01:20:27.413848 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:20:27.414212 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:20:27.414551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:28.171071 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.756 seconds
[0m01:20:28.177164 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:20:28.334802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254613B8E20>]}
[0m01:20:28.335670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:28.336508 [info ] [MainThread]: 
[0m01:20:28.342558 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m01:20:28.343463 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m01:20:28.344626 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m01:20:28.345311 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m01:20:28.357099 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m01:20:28.359018 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m01:20:28.389888 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m01:20:28.391677 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m01:20:28.392142 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m01:20:28.392505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:29.388580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m01:20:29.423731 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m01:20:29.558214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025461588D10>]}
[0m01:20:29.558915 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m01:20:29.559798 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m01:20:29.560579 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m01:20:29.561284 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m01:20:29.562099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m01:20:29.562616 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m01:20:29.568274 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m01:20:29.570049 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m01:20:29.593087 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m01:20:29.595733 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m01:20:29.596429 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m01:20:29.596890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:31.495495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.899 seconds
[0m01:20:31.498860 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m01:20:31.649327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802aaa42-9460-4236-bc1b-12dc9bb4a1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025461513D80>]}
[0m01:20:31.651326 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.09s]
[0m01:20:31.653864 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m01:20:31.657739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:31.658931 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m01:20:31.659884 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m01:20:31.660778 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m01:20:31.661984 [info ] [MainThread]: 
[0m01:20:31.663446 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m01:20:31.667874 [debug] [MainThread]: Command end result
[0m01:20:31.707880 [info ] [MainThread]: 
[0m01:20:31.708558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:31.709062 [info ] [MainThread]: 
[0m01:20:31.709573 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:20:31.710699 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:31.710566 after 7.85 seconds
[0m01:20:31.711079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254613B7930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025461663D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544EBAE250>]}
[0m01:20:31.711467 [debug] [MainThread]: Flushing usage events
[0m01:20:39.429233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A44EB4EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4515C0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4515C0050>]}


============================== 01:20:39.432976 | 071eed60-d9b5-4023-8190-73bfc735b7c8 ==============================
[0m01:20:39.432976 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:20:39.433602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:20:40.365262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '071eed60-d9b5-4023-8190-73bfc735b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A450921E00>]}
[0m01:20:40.417739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '071eed60-d9b5-4023-8190-73bfc735b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A45083E030>]}
[0m01:20:40.419017 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:20:40.426750 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:20:40.567140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:40.567510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:40.608295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '071eed60-d9b5-4023-8190-73bfc735b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A462874450>]}
[0m01:20:40.725391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '071eed60-d9b5-4023-8190-73bfc735b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A462BEC8C0>]}
[0m01:20:40.725846 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 454 macros
[0m01:20:40.726312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071eed60-d9b5-4023-8190-73bfc735b7c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A462A57BD0>]}
[0m01:20:40.727955 [info ] [MainThread]: 
[0m01:20:40.728518 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:20:40.730467 [debug] [MainThread]: Command end result
[0m01:20:40.754720 [debug] [MainThread]: Command `dbt test` succeeded at 01:20:40.754530 after 1.42 seconds
[0m01:20:40.755109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A462BCFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4514EFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A462A87110>]}
[0m01:20:40.755457 [debug] [MainThread]: Flushing usage events
[0m01:21:57.560063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE203B2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE22E20190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE22E20050>]}


============================== 01:21:57.563891 | ef30d833-c0ae-4394-9f8f-0e0d46786166 ==============================
[0m01:21:57.563891 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:21:57.564503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:21:58.461505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE22179E00>]}
[0m01:21:58.513547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2209E030>]}
[0m01:21:58.514932 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:21:58.522793 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:21:58.664265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:21:58.664813 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://snapshots\raw_data_snapshot.sql
[0m01:21:58.907753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE34116A50>]}
[0m01:21:59.010616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE340FDF40>]}
[0m01:21:59.011072 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 454 macros
[0m01:21:59.011548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE343AF770>]}
[0m01:21:59.013418 [info ] [MainThread]: 
[0m01:21:59.014286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:21:59.018593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m01:21:59.031837 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m01:21:59.032234 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m01:21:59.032524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:59.935805 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.903 seconds
[0m01:21:59.941314 [debug] [ThreadPool]: On list_DEV: Close
[0m01:22:00.077610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m01:22:00.090213 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:22:00.090704 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:22:00.091069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:00.784321 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.693 seconds
[0m01:22:00.788027 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:22:00.915685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m01:22:00.917492 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m01:22:00.917828 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m01:22:00.918139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:22:01.730810 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.813 seconds
[0m01:22:01.734614 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m01:22:01.899037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3452FEE0>]}
[0m01:22:01.901079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:22:01.903156 [info ] [MainThread]: 
[0m01:22:01.914663 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m01:22:01.916447 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m01:22:01.918399 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m01:22:01.919400 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m01:22:01.932294 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m01:22:01.933585 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m01:22:01.962330 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m01:22:01.963481 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m01:22:01.963872 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m01:22:01.964223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:22:03.182381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.218 seconds
[0m01:22:03.205984 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m01:22:03.350254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE345D9310>]}
[0m01:22:03.352761 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.43s]
[0m01:22:03.356122 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m01:22:03.359311 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m01:22:03.361119 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m01:22:03.363532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m01:22:03.364720 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m01:22:03.373600 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m01:22:03.375531 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m01:22:03.400999 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m01:22:03.404008 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m01:22:03.404745 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m01:22:03.405198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:22:05.058136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.652 seconds
[0m01:22:05.065852 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m01:22:05.192401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef30d833-c0ae-4394-9f8f-0e0d46786166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE356E9BD0>]}
[0m01:22:05.195160 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 1.83s]
[0m01:22:05.198319 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m01:22:05.203373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:05.204546 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m01:22:05.205404 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m01:22:05.206219 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m01:22:05.207155 [info ] [MainThread]: 
[0m01:22:05.208497 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m01:22:05.210922 [debug] [MainThread]: Command end result
[0m01:22:05.243760 [info ] [MainThread]: 
[0m01:22:05.244460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:22:05.244974 [info ] [MainThread]: 
[0m01:22:05.245510 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:22:05.246713 [debug] [MainThread]: Command `dbt run` succeeded at 01:22:05.246587 after 7.79 seconds
[0m01:22:05.247065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE35663570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE3572BC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE341E8450>]}
[0m01:22:05.247422 [debug] [MainThread]: Flushing usage events
[0m01:22:29.831161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD728AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75320190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD75320050>]}


============================== 01:22:29.835068 | c6f9f105-61b5-4325-a5c9-eba577c98a8d ==============================
[0m01:22:29.835068 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:22:29.835700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:22:30.748194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6f9f105-61b5-4325-a5c9-eba577c98a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD066ADE00>]}
[0m01:22:30.800757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6f9f105-61b5-4325-a5c9-eba577c98a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD065CE030>]}
[0m01:22:30.802166 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:22:30.809858 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:22:30.959839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:22:30.960205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:22:31.000362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6f9f105-61b5-4325-a5c9-eba577c98a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06784450>]}
[0m01:22:31.120418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6f9f105-61b5-4325-a5c9-eba577c98a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06AF88C0>]}
[0m01:22:31.120885 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 454 macros
[0m01:22:31.121366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6f9f105-61b5-4325-a5c9-eba577c98a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0696BBD0>]}
[0m01:22:31.123045 [info ] [MainThread]: 
[0m01:22:31.123694 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:22:31.125682 [debug] [MainThread]: Command end result
[0m01:22:31.148419 [debug] [MainThread]: Command `dbt test` succeeded at 01:22:31.148245 after 1.41 seconds
[0m01:22:31.148813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06AE3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7524FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0699F110>]}
[0m01:22:31.149190 [debug] [MainThread]: Flushing usage events
[0m01:34:56.207774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C75BB2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C78630190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C78630050>]}


============================== 01:34:56.212677 | 0832b580-b271-4eab-be11-7adb23a23ced ==============================
[0m01:34:56.212677 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:34:56.213669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:34:57.486455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0832b580-b271-4eab-be11-7adb23a23ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C098E9E00>]}
[0m01:34:57.538711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0832b580-b271-4eab-be11-7adb23a23ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C0980E030>]}
[0m01:34:57.539971 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:34:57.547624 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:34:57.710807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:34:57.711175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:34:57.751030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0832b580-b271-4eab-be11-7adb23a23ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C099C0450>]}
[0m01:34:57.892829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0832b580-b271-4eab-be11-7adb23a23ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C09D3C8C0>]}
[0m01:34:57.893291 [info ] [MainThread]: Found 2 models, 1 snapshot, 1 source, 454 macros
[0m01:34:57.893816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0832b580-b271-4eab-be11-7adb23a23ced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C09BABBD0>]}
[0m01:34:57.895354 [info ] [MainThread]: 
[0m01:34:57.895881 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:34:57.897744 [debug] [MainThread]: Command end result
[0m01:34:57.920212 [debug] [MainThread]: Command `dbt test` succeeded at 01:34:57.920027 after 1.81 seconds
[0m01:34:57.920595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C09D1FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7855BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C09BDF110>]}
[0m01:34:57.921030 [debug] [MainThread]: Flushing usage events
[0m01:42:42.819119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002118212EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021184BA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021184BA0050>]}


============================== 01:42:42.823773 | 4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e ==============================
[0m01:42:42.823773 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:42:42.824776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:42:44.088389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021183EE9E00>]}
[0m01:42:44.140538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021183E0E030>]}
[0m01:42:44.142027 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:42:44.149976 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:42:44.323899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:42:44.324666 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m01:42:44.540392 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:42:44.541083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021195ED7B50>]}
[0m01:42:44.784460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021195EBF3E0>]}
[0m01:42:44.909643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211960F4590>]}
[0m01:42:44.910094 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m01:42:44.910608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211961628F0>]}
[0m01:42:44.912715 [info ] [MainThread]: 
[0m01:42:44.913573 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:42:44.917747 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m01:42:44.929814 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m01:42:44.930190 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m01:42:44.930481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:45.945987 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.015 seconds
[0m01:42:45.951126 [debug] [ThreadPool]: On list_DEV: Close
[0m01:42:46.077418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m01:42:46.093283 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m01:42:46.093840 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m01:42:46.094314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:46.817101 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.723 seconds
[0m01:42:46.818817 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m01:42:46.934893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m01:42:46.936685 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:42:46.937020 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:42:46.937327 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:42:47.694059 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.756 seconds
[0m01:42:47.700845 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:42:47.838566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197406150>]}
[0m01:42:47.840167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:42:47.841569 [info ] [MainThread]: 
[0m01:42:47.851759 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m01:42:47.853272 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m01:42:47.855277 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m01:42:47.856478 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m01:42:47.872617 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m01:42:47.874200 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m01:42:47.906013 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m01:42:47.907203 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m01:42:47.907582 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m01:42:47.907945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:42:48.901500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m01:42:48.923491 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m01:42:49.078454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021184D094F0>]}
[0m01:42:49.079502 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.22s]
[0m01:42:49.080806 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m01:42:49.082371 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m01:42:49.083471 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m01:42:49.084482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m01:42:49.085090 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m01:42:49.089905 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m01:42:49.091120 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m01:42:49.119484 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m01:42:49.122794 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m01:42:49.123456 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m01:42:49.124005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:51.178953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.055 seconds
[0m01:42:51.183110 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m01:42:51.294400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dc9e1d3-fa59-48ac-ab5f-8e32aa24c49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211974DBCF0>]}
[0m01:42:51.295262 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.21s]
[0m01:42:51.296327 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m01:42:51.298424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:51.298890 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m01:42:51.299310 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m01:42:51.299680 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m01:42:51.300128 [info ] [MainThread]: 
[0m01:42:51.300810 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.39 seconds (6.39s).
[0m01:42:51.302274 [debug] [MainThread]: Command end result
[0m01:42:51.336067 [info ] [MainThread]: 
[0m01:42:51.336998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:42:51.337497 [info ] [MainThread]: 
[0m01:42:51.338001 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:42:51.339077 [debug] [MainThread]: Command `dbt run` succeeded at 01:42:51.338954 after 8.68 seconds
[0m01:42:51.339434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021195A42F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021197309E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FE9E6200>]}
[0m01:42:51.339775 [debug] [MainThread]: Flushing usage events
[0m01:43:01.537216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011336C6EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113396E0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113396E0050>]}


============================== 01:43:01.541058 | 242501df-4888-4ac7-b3b8-0c1b61179d0c ==============================
[0m01:43:01.541058 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:43:01.541745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:43:02.437397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '242501df-4888-4ac7-b3b8-0c1b61179d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011338A39E00>]}
[0m01:43:02.488646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '242501df-4888-4ac7-b3b8-0c1b61179d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001133895E030>]}
[0m01:43:02.489945 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:43:02.497350 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:43:02.683383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:43:02.683780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:43:02.735615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '242501df-4888-4ac7-b3b8-0c1b61179d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001134A9A4350>]}
[0m01:43:02.870080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '242501df-4888-4ac7-b3b8-0c1b61179d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001134AD29220>]}
[0m01:43:02.870567 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m01:43:02.871107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242501df-4888-4ac7-b3b8-0c1b61179d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001134AD6DFD0>]}
[0m01:43:02.873790 [info ] [MainThread]: 
[0m01:43:02.874595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:43:02.878819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m01:43:02.895086 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m01:43:02.895487 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m01:43:02.895780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:03.805313 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.909 seconds
[0m01:43:03.808265 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m01:43:03.932166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m01:43:03.936283 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:43:03.936626 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:43:03.936930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:04.725008 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.788 seconds
[0m01:43:04.731391 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:43:04.884634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '242501df-4888-4ac7-b3b8-0c1b61179d0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001134AD47450>]}
[0m01:43:04.886058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:04.886566 [info ] [MainThread]: 
[0m01:43:04.890831 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa
[0m01:43:04.891310 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__10000 .............. [RUN]
[0m01:43:04.891987 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa'
[0m01:43:04.892364 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa
[0m01:43:04.907618 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa"
[0m01:43:04.908763 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa
[0m01:43:04.930150 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa"
[0m01:43:04.931919 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa"
[0m01:43:04.932352 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','10000'
)



      
    ) dbt_internal_test
[0m01:43:04.932707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:05.875712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m01:43:05.890415 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa: Close
[0m01:43:06.033047 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__10000 ................ [[31mFAIL 198[0m in 1.14s]
[0m01:43:06.033961 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa
[0m01:43:06.034443 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c
[0m01:43:06.034851 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__10000 .......... [RUN]
[0m01:43:06.035512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__10000.88270c62aa, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c)
[0m01:43:06.035931 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c
[0m01:43:06.039581 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c"
[0m01:43:06.040510 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c
[0m01:43:06.042946 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c"
[0m01:43:06.044114 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c"
[0m01:43:06.044516 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','10000'
)



      
    ) dbt_internal_test
[0m01:43:06.044898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:07.016014 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce7-0004-2cf4-0002-7a6f000153d6
[0m01:43:07.016455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m01:43:07.016886 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c: Close
[0m01:43:07.216394 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__10000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__10000.sql
[0m01:43:07.217139 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__10000 ............... [[31mERROR[0m in 1.18s]
[0m01:43:07.218197 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c
[0m01:43:07.218775 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6
[0m01:43:07.219277 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__10000 .......... [RUN]
[0m01:43:07.221120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__10000.faae4f777c, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6)
[0m01:43:07.221606 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6
[0m01:43:07.225595 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6"
[0m01:43:07.226683 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6
[0m01:43:07.228661 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6"
[0m01:43:07.230229 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6"
[0m01:43:07.230795 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','10000'
)



      
    ) dbt_internal_test
[0m01:43:07.231152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:07.986049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce7-0004-2cef-0000-00027a6fe469
[0m01:43:07.986503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m01:43:07.986958 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6: Close
[0m01:43:08.100055 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__10000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__10000.sql
[0m01:43:08.100594 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__10000 ............... [[31mERROR[0m in 0.88s]
[0m01:43:08.101433 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6
[0m01:43:08.101920 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796
[0m01:43:08.102437 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__10000 ............... [RUN]
[0m01:43:08.103151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__10000.cdff4821a6, now test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796)
[0m01:43:08.103627 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796
[0m01:43:08.107128 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796"
[0m01:43:08.107975 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796
[0m01:43:08.109886 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796"
[0m01:43:08.111005 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796"
[0m01:43:08.111386 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','10000'
)



      
    ) dbt_internal_test
[0m01:43:08.111900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:09.175583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.064 seconds
[0m01:43:09.178091 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796: Close
[0m01:43:09.311797 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__10000 ................. [[31mFAIL 199[0m in 1.21s]
[0m01:43:09.312784 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796
[0m01:43:09.313273 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:43:09.313696 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__10000000 .......... [RUN]
[0m01:43:09.314327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__10000.6ef90f4796, now test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07)
[0m01:43:09.314792 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:43:09.318691 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m01:43:09.319682 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:43:09.321826 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m01:43:09.323065 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m01:43:09.323508 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','10000000'
)



      
    ) dbt_internal_test
[0m01:43:09.323949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:10.046843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m01:43:10.053729 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: Close
[0m01:43:10.190879 [error] [Thread-1 (]: 5 of 23 FAIL 200 accepted_values_raw_data_model_volume__0__10000000 ............ [[31mFAIL 200[0m in 0.88s]
[0m01:43:10.192409 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:43:10.192911 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1
[0m01:43:10.193308 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__10000 . [RUN]
[0m01:43:10.193941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1)
[0m01:43:10.194363 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1
[0m01:43:10.198005 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1"
[0m01:43:10.198926 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1
[0m01:43:10.200878 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1"
[0m01:43:10.202039 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1"
[0m01:43:10.202449 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','10000'
)



      
    ) dbt_internal_test
[0m01:43:10.202834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:11.276051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m01:43:11.278278 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1: Close
[0m01:43:11.405889 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__10000 ... [[31mFAIL 200[0m in 1.21s]
[0m01:43:11.409166 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1
[0m01:43:11.411123 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce
[0m01:43:11.412272 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__10000 . [RUN]
[0m01:43:11.412980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__10000.a499b03bf1, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce)
[0m01:43:11.413402 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce
[0m01:43:11.417034 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce"
[0m01:43:11.417927 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce
[0m01:43:11.419875 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce"
[0m01:43:11.421037 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce"
[0m01:43:11.421435 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','10000'
)



      
    ) dbt_internal_test
[0m01:43:11.421812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:12.310804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m01:43:12.313064 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce: Close
[0m01:43:12.441784 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__10000 ... [[31mFAIL 200[0m in 1.03s]
[0m01:43:12.445016 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce
[0m01:43:12.446980 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:43:12.448939 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m01:43:12.451260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__10000.cad7b9c8ce, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m01:43:12.452795 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:43:12.456904 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m01:43:12.457737 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:43:12.459577 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m01:43:12.460851 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m01:43:12.461339 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m01:43:12.461704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:13.500513 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.038 seconds
[0m01:43:13.507271 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m01:43:13.708103 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 1.26s]
[0m01:43:13.708998 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:43:13.709543 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:43:13.709964 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m01:43:13.710674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m01:43:13.711098 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:43:13.717376 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m01:43:13.718321 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:43:13.720353 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m01:43:13.721381 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m01:43:13.721789 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m01:43:13.722170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:14.689264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.967 seconds
[0m01:43:14.692806 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m01:43:14.816931 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 1.11s]
[0m01:43:14.819102 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:43:14.819546 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:43:14.819963 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m01:43:14.820638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m01:43:14.821028 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:43:14.824545 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m01:43:14.825431 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:43:14.827594 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m01:43:14.828879 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m01:43:14.829326 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m01:43:14.829731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:15.524525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m01:43:15.531280 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m01:43:15.655173 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.83s]
[0m01:43:15.656461 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:43:15.657119 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:43:15.657756 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m01:43:15.658659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m01:43:15.659295 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:43:15.664617 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m01:43:15.665964 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:43:15.669205 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m01:43:15.670932 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m01:43:15.671484 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m01:43:15.671982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:16.343022 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce7-0004-2ce7-0000-00027a6ff43d
[0m01:43:16.344691 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m01:43:16.346499 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m01:43:16.483466 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m01:43:16.484023 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.83s]
[0m01:43:16.484794 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:43:16.485290 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:43:16.485682 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m01:43:16.486460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m01:43:16.487107 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:43:16.491402 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m01:43:16.492459 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:43:16.494581 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m01:43:16.495664 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m01:43:16.496071 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m01:43:16.496486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:17.268947 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce7-0004-2cec-0002-7a6f00016aa2
[0m01:43:17.269411 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m01:43:17.269868 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m01:43:17.400567 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m01:43:17.401130 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.91s]
[0m01:43:17.401973 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:43:17.402414 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:43:17.402803 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m01:43:17.403445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m01:43:17.403868 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:43:17.407475 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m01:43:17.408503 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:43:17.410596 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m01:43:17.411709 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m01:43:17.412111 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m01:43:17.412485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:18.167412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m01:43:18.171019 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m01:43:18.292969 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.89s]
[0m01:43:18.293892 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:43:18.294332 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:43:18.294714 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m01:43:18.295320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m01:43:18.295709 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:43:18.299267 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m01:43:18.300433 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:43:18.302380 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m01:43:18.304844 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m01:43:18.305339 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m01:43:18.305713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:19.173163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m01:43:19.175581 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m01:43:19.299209 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 1.00s]
[0m01:43:19.300253 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:43:19.300797 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:43:19.301266 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m01:43:19.302004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m01:43:19.302559 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:43:19.307316 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m01:43:19.308512 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:43:19.311150 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m01:43:19.312534 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m01:43:19.313057 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m01:43:19.313612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:20.337026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.023 seconds
[0m01:43:20.342508 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m01:43:20.463692 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 1.16s]
[0m01:43:20.464553 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:43:20.464999 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:43:20.465358 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m01:43:20.465930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m01:43:20.466324 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:43:20.469825 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m01:43:20.470721 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:43:20.472604 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m01:43:20.474043 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m01:43:20.474498 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m01:43:20.474857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:21.240595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m01:43:21.244599 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m01:43:21.391868 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 0.93s]
[0m01:43:21.395182 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:43:21.397063 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:43:21.398943 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m01:43:21.401204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m01:43:21.402949 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:43:21.415345 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m01:43:21.417552 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:43:21.421614 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m01:43:21.423631 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m01:43:21.424405 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m01:43:21.425090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:22.466785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m01:43:22.469958 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m01:43:22.589544 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 1.19s]
[0m01:43:22.590512 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:43:22.591021 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:43:22.591417 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m01:43:22.592054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m01:43:22.592443 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:43:22.596772 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m01:43:22.597684 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:43:22.599743 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m01:43:22.600981 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m01:43:22.601376 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m01:43:22.601739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:23.323114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m01:43:23.326002 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m01:43:23.463980 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.87s]
[0m01:43:23.466739 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:43:23.468252 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:43:23.470042 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m01:43:23.472547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m01:43:23.473072 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:43:23.476817 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m01:43:23.477732 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:43:23.479652 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m01:43:23.480662 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m01:43:23.481045 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m01:43:23.481414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:24.163867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m01:43:24.174734 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m01:43:24.322872 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 0.85s]
[0m01:43:24.326119 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:43:24.327987 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:43:24.329890 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m01:43:24.332048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m01:43:24.333188 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:43:24.341690 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m01:43:24.343209 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:43:24.346583 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m01:43:24.348739 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m01:43:24.349453 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m01:43:24.350026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:25.027457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m01:43:25.034305 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m01:43:25.181769 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.85s]
[0m01:43:25.185001 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:43:25.186851 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:43:25.188715 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m01:43:25.190969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m01:43:25.192653 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:43:25.213149 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m01:43:25.215456 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:43:25.219192 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m01:43:25.221213 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m01:43:25.221955 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:25.222526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:26.079971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m01:43:26.083714 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m01:43:26.212860 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 1.02s]
[0m01:43:26.213798 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:43:26.214240 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:43:26.214629 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m01:43:26.215264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m01:43:26.215684 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:43:26.219381 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m01:43:26.220789 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:43:26.222965 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m01:43:26.225621 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m01:43:26.226115 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:26.226490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:27.229517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m01:43:27.232792 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m01:43:27.361962 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 1.15s]
[0m01:43:27.362856 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:43:27.363320 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:43:27.363780 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m01:43:27.364355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m01:43:27.364716 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:43:27.367978 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m01:43:27.369086 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:43:27.371094 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m01:43:27.372721 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m01:43:27.373170 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:43:27.373516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:28.194743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m01:43:28.197937 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m01:43:28.305843 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.94s]
[0m01:43:28.309321 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:43:28.314052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:28.315351 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m01:43:28.316468 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m01:43:28.317686 [info ] [MainThread]: 
[0m01:43:28.319013 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 25.44 seconds (25.44s).
[0m01:43:28.329526 [debug] [MainThread]: Command end result
[0m01:43:28.364193 [info ] [MainThread]: 
[0m01:43:28.364935 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m01:43:28.365450 [info ] [MainThread]: 
[0m01:43:28.366047 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__10000 (models\schema.yml)[0m
[0m01:43:28.366647 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m01:43:28.367083 [info ] [MainThread]: 
[0m01:43:28.367620 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__10000.sql
[0m01:43:28.368103 [info ] [MainThread]: 
[0m01:43:28.368634 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__10000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__10000.sql
[0m01:43:28.369141 [info ] [MainThread]: 
[0m01:43:28.369729 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__10000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__10000.sql
[0m01:43:28.370210 [info ] [MainThread]: 
[0m01:43:28.370832 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__10000 (models\schema.yml)[0m
[0m01:43:28.371477 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m01:43:28.371968 [info ] [MainThread]: 
[0m01:43:28.372491 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__10000.sql
[0m01:43:28.372959 [info ] [MainThread]: 
[0m01:43:28.373479 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__10000000 (models\schema.yml)[0m
[0m01:43:28.374015 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m01:43:28.374468 [info ] [MainThread]: 
[0m01:43:28.375026 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__10000000.sql
[0m01:43:28.375503 [info ] [MainThread]: 
[0m01:43:28.376050 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__10000 (models\schema.yml)[0m
[0m01:43:28.376580 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m01:43:28.377083 [info ] [MainThread]: 
[0m01:43:28.377747 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__10000.sql
[0m01:43:28.378338 [info ] [MainThread]: 
[0m01:43:28.379056 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__10000 (models\schema.yml)[0m
[0m01:43:28.379622 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m01:43:28.380043 [info ] [MainThread]: 
[0m01:43:28.380673 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__10000.sql
[0m01:43:28.381259 [info ] [MainThread]: 
[0m01:43:28.381907 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m01:43:28.382486 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m01:43:28.382963 [info ] [MainThread]: 
[0m01:43:28.383489 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m01:43:28.383950 [info ] [MainThread]: 
[0m01:43:28.384478 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m01:43:28.385153 [info ] [MainThread]: 
[0m01:43:28.385854 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m01:43:28.386655 [info ] [MainThread]: 
[0m01:43:28.388158 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m01:43:28.389163 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m01:43:28.389973 [info ] [MainThread]: 
[0m01:43:28.390580 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m01:43:28.391078 [info ] [MainThread]: 
[0m01:43:28.391578 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m01:43:28.392126 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m01:43:28.392630 [info ] [MainThread]: 
[0m01:43:28.393201 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m01:43:28.393692 [info ] [MainThread]: 
[0m01:43:28.394319 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m01:43:28.394870 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m01:43:28.395447 [info ] [MainThread]: 
[0m01:43:28.395962 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m01:43:28.396561 [info ] [MainThread]: 
[0m01:43:28.397203 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m01:43:28.398361 [debug] [MainThread]: Command `dbt test` failed at 01:43:28.398224 after 26.96 seconds
[0m01:43:28.398726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001133960FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001134AC8B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001134AFCEAF0>]}
[0m01:43:28.399061 [debug] [MainThread]: Flushing usage events
[0m01:45:12.089914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCBFC32A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC26B0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC26B0050>]}


============================== 01:45:12.094539 | e0a2b93b-6c52-449b-b9d0-a214069b12ea ==============================
[0m01:45:12.094539 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:45:12.095389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:45:13.308504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC1A01E00>]}
[0m01:45:13.360742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCC191E030>]}
[0m01:45:13.362330 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:45:13.378435 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:45:13.595599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:45:13.596504 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m01:45:13.802545 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:45:13.803235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD3936650>]}
[0m01:45:14.037717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD3B67B60>]}
[0m01:45:14.179415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD3CD3770>]}
[0m01:45:14.179971 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m01:45:14.180502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD3DE3EE0>]}
[0m01:45:14.183491 [info ] [MainThread]: 
[0m01:45:14.184383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:45:14.189287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m01:45:14.204131 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m01:45:14.204503 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m01:45:14.204791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:45:15.177136 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.972 seconds
[0m01:45:15.179570 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m01:45:15.296523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m01:45:15.298933 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m01:45:15.299262 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m01:45:15.299551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:45:16.068032 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.768 seconds
[0m01:45:16.070939 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m01:45:16.189479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0a2b93b-6c52-449b-b9d0-a214069b12ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD4EE1010>]}
[0m01:45:16.191583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:45:16.193444 [info ] [MainThread]: 
[0m01:45:16.201417 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m01:45:16.201878 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__100000 ............. [RUN]
[0m01:45:16.202573 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04'
[0m01:45:16.202936 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m01:45:16.211562 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m01:45:16.212516 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m01:45:16.232470 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m01:45:16.233827 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m01:45:16.234228 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m01:45:16.234622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:45:16.957663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m01:45:16.974598 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: Close
[0m01:45:17.103583 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__100000 ............... [[31mFAIL 198[0m in 0.90s]
[0m01:45:17.104606 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m01:45:17.105227 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m01:45:17.105659 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__100000 ......... [RUN]
[0m01:45:17.106477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d)
[0m01:45:17.107105 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m01:45:17.110839 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m01:45:17.111737 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m01:45:17.113726 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m01:45:17.114944 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m01:45:17.115574 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m01:45:17.115981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:17.837304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce9-0004-2cf4-0002-7a6f000153e6
[0m01:45:17.837739 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m01:45:17.838185 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: Close
[0m01:45:17.962418 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m01:45:17.962973 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__100000 .............. [[31mERROR[0m in 0.86s]
[0m01:45:17.963762 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m01:45:17.964231 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m01:45:17.964602 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__100000 ......... [RUN]
[0m01:45:17.965746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd)
[0m01:45:17.966107 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m01:45:17.969349 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m01:45:17.970236 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m01:45:17.972411 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m01:45:17.973649 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m01:45:17.974042 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m01:45:17.974401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:18.691316 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce9-0004-2ced-0002-7a6f0001046e
[0m01:45:18.693151 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m01:45:18.694995 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: Close
[0m01:45:18.840390 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m01:45:18.841818 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__100000 .............. [[31mERROR[0m in 0.88s]
[0m01:45:18.843629 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m01:45:18.844629 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m01:45:18.845820 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__100000 .............. [RUN]
[0m01:45:18.846933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd, now test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d)
[0m01:45:18.847371 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m01:45:18.851294 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m01:45:18.852474 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m01:45:18.855502 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m01:45:18.856967 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m01:45:18.857393 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m01:45:18.857810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:19.755026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m01:45:19.757842 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: Close
[0m01:45:19.870859 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__100000 ................ [[31mFAIL 199[0m in 1.02s]
[0m01:45:19.871957 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m01:45:19.872482 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:45:19.873089 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__10000000 .......... [RUN]
[0m01:45:19.873937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d, now test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07)
[0m01:45:19.874363 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:45:19.878787 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m01:45:19.880221 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:45:19.883743 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m01:45:19.885156 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m01:45:19.885613 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','10000000'
)



      
    ) dbt_internal_test
[0m01:45:19.886018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:20.620256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m01:45:20.627069 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: Close
[0m01:45:20.749973 [error] [Thread-1 (]: 5 of 23 FAIL 200 accepted_values_raw_data_model_volume__0__10000000 ............ [[31mFAIL 200[0m in 0.88s]
[0m01:45:20.750848 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m01:45:20.751285 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m01:45:20.751650 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__100000  [RUN]
[0m01:45:20.752272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e)
[0m01:45:20.752650 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m01:45:20.756094 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m01:45:20.756984 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m01:45:20.758800 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m01:45:20.759864 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m01:45:20.760257 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m01:45:20.760616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:21.600612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.840 seconds
[0m01:45:21.605524 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: Close
[0m01:45:21.725584 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__100000 .. [[31mFAIL 200[0m in 0.97s]
[0m01:45:21.726530 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m01:45:21.727009 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m01:45:21.727422 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__100000  [RUN]
[0m01:45:21.728116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b)
[0m01:45:21.728544 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m01:45:21.732095 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m01:45:21.732979 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m01:45:21.734915 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m01:45:21.736154 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m01:45:21.736611 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m01:45:21.737008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:22.789052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.052 seconds
[0m01:45:22.792535 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: Close
[0m01:45:22.928206 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__100000 .. [[31mFAIL 200[0m in 1.20s]
[0m01:45:22.930693 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m01:45:22.931896 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:45:22.932880 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m01:45:22.934013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m01:45:22.934706 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:45:22.941170 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m01:45:22.942450 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:45:22.945042 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m01:45:22.946573 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m01:45:22.947130 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m01:45:22.947590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:23.672660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m01:45:23.679567 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m01:45:23.803411 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 0.87s]
[0m01:45:23.804358 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m01:45:23.804847 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:45:23.805278 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m01:45:23.805932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m01:45:23.806337 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:45:23.812473 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m01:45:23.813334 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:45:23.815346 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m01:45:23.816384 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m01:45:23.816790 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m01:45:23.817171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:24.483946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m01:45:24.486358 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m01:45:24.604763 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.80s]
[0m01:45:24.607135 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m01:45:24.608152 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:45:24.609173 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m01:45:24.610494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m01:45:24.611351 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:45:24.617572 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m01:45:24.619460 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:45:24.622401 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m01:45:24.623688 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m01:45:24.624198 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m01:45:24.624673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:25.321104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m01:45:25.322760 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m01:45:25.435863 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.83s]
[0m01:45:25.438912 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m01:45:25.440832 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:45:25.442542 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m01:45:25.444650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m01:45:25.446068 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:45:25.454931 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m01:45:25.456600 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:45:25.459958 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m01:45:25.461617 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m01:45:25.462286 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m01:45:25.462813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:26.283472 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce9-0004-2cec-0002-7a6f00016aaa
[0m01:45:26.285530 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m01:45:26.287307 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m01:45:26.418562 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m01:45:26.419547 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.98s]
[0m01:45:26.421127 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m01:45:26.421963 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:45:26.422678 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m01:45:26.423624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m01:45:26.424297 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:45:26.429429 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m01:45:26.430675 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:45:26.433169 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m01:45:26.434493 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m01:45:26.435032 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m01:45:26.435487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:27.138297 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85ce9-0004-2cec-0002-7a6f00016aae
[0m01:45:27.138756 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m01:45:27.139207 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m01:45:27.290813 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m01:45:27.291334 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.87s]
[0m01:45:27.292106 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m01:45:27.292495 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:45:27.292857 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m01:45:27.293540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m01:45:27.293966 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:45:27.297323 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m01:45:27.298124 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:45:27.299960 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m01:45:27.301058 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m01:45:27.301456 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m01:45:27.301801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:27.998037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m01:45:28.003113 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m01:45:28.125793 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.83s]
[0m01:45:28.129152 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m01:45:28.131159 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:45:28.133175 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m01:45:28.135528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m01:45:28.137237 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:45:28.145701 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m01:45:28.147415 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:45:28.151303 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m01:45:28.153060 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m01:45:28.153666 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m01:45:28.154221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:28.831004 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m01:45:28.833817 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m01:45:28.938688 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.80s]
[0m01:45:28.939947 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m01:45:28.940612 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:45:28.941184 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m01:45:28.941850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m01:45:28.942257 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:45:28.945781 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m01:45:28.946599 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:45:28.948446 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m01:45:28.949475 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m01:45:28.949967 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m01:45:28.950354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:29.709938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m01:45:29.715671 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m01:45:29.824717 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.88s]
[0m01:45:29.825651 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m01:45:29.826115 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:45:29.826524 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m01:45:29.827138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m01:45:29.827565 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:45:29.831287 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m01:45:29.832287 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:45:29.834376 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m01:45:29.835443 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m01:45:29.835848 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m01:45:29.836219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:30.625770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m01:45:30.632746 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m01:45:30.768552 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 0.94s]
[0m01:45:30.771746 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m01:45:30.773613 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:45:30.775516 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m01:45:30.777884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m01:45:30.779462 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:45:30.789843 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m01:45:30.790813 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:45:30.792758 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m01:45:30.793837 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m01:45:30.794267 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m01:45:30.794635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:31.465878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m01:45:31.472810 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m01:45:31.633537 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 0.86s]
[0m01:45:31.634398 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m01:45:31.634834 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:45:31.635206 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m01:45:31.635822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m01:45:31.636205 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:45:31.639617 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m01:45:31.640448 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:45:31.642297 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m01:45:31.643373 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m01:45:31.643781 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m01:45:31.644146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:32.396067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m01:45:32.397940 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m01:45:32.511916 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.88s]
[0m01:45:32.512805 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m01:45:32.513299 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:45:32.513721 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m01:45:32.514492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m01:45:32.514935 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:45:32.518834 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m01:45:32.519760 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:45:32.522036 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m01:45:32.523144 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m01:45:32.523570 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m01:45:32.523978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:33.211968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m01:45:33.215490 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m01:45:33.323693 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 0.81s]
[0m01:45:33.324610 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m01:45:33.325056 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:45:33.325456 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m01:45:33.326113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m01:45:33.326511 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:45:33.330098 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m01:45:33.331075 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:45:33.333201 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m01:45:33.334273 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m01:45:33.334671 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m01:45:33.335053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:34.104407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m01:45:34.107042 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m01:45:34.300450 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.97s]
[0m01:45:34.301487 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m01:45:34.302207 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:45:34.302862 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m01:45:34.303656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m01:45:34.304111 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:45:34.310299 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m01:45:34.311150 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:45:34.313120 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m01:45:34.314446 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m01:45:34.314921 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:34.315343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:35.060684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m01:45:35.067569 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m01:45:35.186537 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 0.88s]
[0m01:45:35.187934 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m01:45:35.188428 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:45:35.188826 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m01:45:35.189498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m01:45:35.189876 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:45:35.194706 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m01:45:35.195863 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:45:35.199388 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m01:45:35.201022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m01:45:35.201684 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:35.202232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:35.900980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m01:45:35.907961 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m01:45:36.036372 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 0.85s]
[0m01:45:36.037249 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m01:45:36.037655 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:45:36.038022 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m01:45:36.038728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m01:45:36.039220 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:45:36.043177 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m01:45:36.044036 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:45:36.046213 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m01:45:36.047441 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m01:45:36.047835 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m01:45:36.048303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:45:36.712929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m01:45:36.714841 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m01:45:36.816979 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.78s]
[0m01:45:36.822385 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m01:45:36.823866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:45:36.824169 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m01:45:36.824514 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m01:45:36.824843 [info ] [MainThread]: 
[0m01:45:36.825353 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 22.64 seconds (22.64s).
[0m01:45:36.829765 [debug] [MainThread]: Command end result
[0m01:45:36.860811 [info ] [MainThread]: 
[0m01:45:36.861372 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m01:45:36.861780 [info ] [MainThread]: 
[0m01:45:36.862310 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__100000 (models\schema.yml)[0m
[0m01:45:36.862948 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m01:45:36.863585 [info ] [MainThread]: 
[0m01:45:36.864224 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__100000.sql
[0m01:45:36.864669 [info ] [MainThread]: 
[0m01:45:36.865234 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m01:45:36.865710 [info ] [MainThread]: 
[0m01:45:36.866273 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m01:45:36.866889 [info ] [MainThread]: 
[0m01:45:36.867415 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__100000 (models\schema.yml)[0m
[0m01:45:36.867901 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m01:45:36.868321 [info ] [MainThread]: 
[0m01:45:36.868813 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__100000.sql
[0m01:45:36.869248 [info ] [MainThread]: 
[0m01:45:36.869744 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__10000000 (models\schema.yml)[0m
[0m01:45:36.870282 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m01:45:36.870736 [info ] [MainThread]: 
[0m01:45:36.871252 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__10000000.sql
[0m01:45:36.871727 [info ] [MainThread]: 
[0m01:45:36.872256 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__100000 (models\schema.yml)[0m
[0m01:45:36.872777 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m01:45:36.873298 [info ] [MainThread]: 
[0m01:45:36.873812 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__100000.sql
[0m01:45:36.874279 [info ] [MainThread]: 
[0m01:45:36.874799 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__100000 (models\schema.yml)[0m
[0m01:45:36.875447 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m01:45:36.876008 [info ] [MainThread]: 
[0m01:45:36.876609 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__100000.sql
[0m01:45:36.877090 [info ] [MainThread]: 
[0m01:45:36.877629 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m01:45:36.878153 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m01:45:36.878587 [info ] [MainThread]: 
[0m01:45:36.879133 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m01:45:36.879628 [info ] [MainThread]: 
[0m01:45:36.880241 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m01:45:36.880721 [info ] [MainThread]: 
[0m01:45:36.881288 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m01:45:36.881754 [info ] [MainThread]: 
[0m01:45:36.882288 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m01:45:36.882775 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m01:45:36.883159 [info ] [MainThread]: 
[0m01:45:36.883650 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m01:45:36.884068 [info ] [MainThread]: 
[0m01:45:36.884538 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m01:45:36.885006 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m01:45:36.885417 [info ] [MainThread]: 
[0m01:45:36.885883 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m01:45:36.886284 [info ] [MainThread]: 
[0m01:45:36.886785 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m01:45:36.887255 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m01:45:36.887671 [info ] [MainThread]: 
[0m01:45:36.888146 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m01:45:36.888584 [info ] [MainThread]: 
[0m01:45:36.889035 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m01:45:36.890216 [debug] [MainThread]: Command `dbt test` failed at 01:45:36.890084 after 24.90 seconds
[0m01:45:36.890628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD50A3E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD50ED630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCD50EEF30>]}
[0m01:45:36.890975 [debug] [MainThread]: Flushing usage events
[0m02:00:22.621307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832909EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832BB20190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832BB20050>]}


============================== 02:00:22.629019 | afb1469d-5154-4248-8928-1dcb7de93b93 ==============================
[0m02:00:22.629019 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:00:22.630257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:00:23.936392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832AE69E00>]}
[0m02:00:23.987848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002832AD8E030>]}
[0m02:00:23.989115 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:00:23.997333 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:00:24.198401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:00:24.199203 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m02:00:24.411273 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:00:24.411935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833D094450>]}
[0m02:00:24.621942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833CD7FF20>]}
[0m02:00:24.761857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833CD8E270>]}
[0m02:00:24.762387 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m02:00:24.762952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833D23BEE0>]}
[0m02:00:24.765812 [info ] [MainThread]: 
[0m02:00:24.766698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:00:24.771460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m02:00:24.793375 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m02:00:24.793795 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m02:00:24.794122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:25.718757 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.925 seconds
[0m02:00:25.720663 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m02:00:25.846099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m02:00:25.852824 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m02:00:25.853818 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m02:00:25.854715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:00:26.590067 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.735 seconds
[0m02:00:26.596343 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m02:00:26.730896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb1469d-5154-4248-8928-1dcb7de93b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833E485B50>]}
[0m02:00:26.731733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:00:26.732409 [info ] [MainThread]: 
[0m02:00:26.738004 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:00:26.738659 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__100000 ............. [RUN]
[0m02:00:26.739568 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04'
[0m02:00:26.739996 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:00:26.749271 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:00:26.750326 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:00:26.776337 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:00:26.778092 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:00:26.778786 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:00:26.779267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:00:27.502176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m02:00:27.525690 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: Close
[0m02:00:27.666396 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__100000 ............... [[31mFAIL 198[0m in 0.93s]
[0m02:00:27.669739 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:00:27.671801 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:00:27.673749 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__100000 ......... [RUN]
[0m02:00:27.676037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d)
[0m02:00:27.677602 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:00:27.686197 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:00:27.687087 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:00:27.689081 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:00:27.690260 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:00:27.690675 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:00:27.691061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:28.402399 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cf8-0004-2cee-0002-7a6f00017042
[0m02:00:28.402868 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m02:00:28.403333 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: Close
[0m02:00:28.545351 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m02:00:28.546501 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__100000 .............. [[31mERROR[0m in 0.87s]
[0m02:00:28.548188 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:00:28.549146 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:00:28.549886 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__100000 ......... [RUN]
[0m02:00:28.551918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd)
[0m02:00:28.552632 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:00:28.557884 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:00:28.559049 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:00:28.561648 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:00:28.563171 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:00:28.563761 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:00:28.564272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:29.321805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cf8-0004-2cec-0002-7a6f00016aba
[0m02:00:29.322463 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m02:00:29.323106 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: Close
[0m02:00:29.500142 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m02:00:29.501283 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__100000 .............. [[31mERROR[0m in 0.95s]
[0m02:00:29.502981 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:00:29.504240 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:00:29.505235 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__100000 .............. [RUN]
[0m02:00:29.506318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd, now test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d)
[0m02:00:29.507085 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:00:29.512499 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:00:29.514237 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:00:29.517327 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:00:29.518771 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:00:29.519203 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:00:29.519564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:30.380023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m02:00:30.386867 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: Close
[0m02:00:30.500238 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__100000 ................ [[31mFAIL 199[0m in 0.99s]
[0m02:00:30.503334 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:00:30.505136 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:00:30.506978 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__10000000 .......... [RUN]
[0m02:00:30.509207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d, now test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07)
[0m02:00:30.510728 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:00:30.519932 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:00:30.521644 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:00:30.525132 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:00:30.527069 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:00:30.527718 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','10000000'
)



      
    ) dbt_internal_test
[0m02:00:30.528269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:31.265362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m02:00:31.267299 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: Close
[0m02:00:31.374515 [error] [Thread-1 (]: 5 of 23 FAIL 200 accepted_values_raw_data_model_volume__0__10000000 ............ [[31mFAIL 200[0m in 0.87s]
[0m02:00:31.375500 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:00:31.375975 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:00:31.376399 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__100000  [RUN]
[0m02:00:31.377087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e)
[0m02:00:31.377529 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:00:31.381469 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:00:31.382429 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:00:31.384577 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:00:31.385889 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:00:31.386340 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:00:31.386759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:32.053313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m02:00:32.055048 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: Close
[0m02:00:32.183097 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__100000 .. [[31mFAIL 200[0m in 0.81s]
[0m02:00:32.184543 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:00:32.185548 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:00:32.186436 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__100000  [RUN]
[0m02:00:32.187433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b)
[0m02:00:32.187880 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:00:32.191551 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:00:32.192558 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:00:32.194615 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:00:32.196667 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:00:32.197413 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:00:32.198044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:32.915409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m02:00:32.918636 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: Close
[0m02:00:33.039614 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__100000 .. [[31mFAIL 200[0m in 0.85s]
[0m02:00:33.042698 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:00:33.043903 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:00:33.045311 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m02:00:33.046953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m02:00:33.047920 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:00:33.054685 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:00:33.056160 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:00:33.059113 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:00:33.060760 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:00:33.061630 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m02:00:33.062529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:33.748846 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m02:00:33.750934 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m02:00:33.872125 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 0.82s]
[0m02:00:33.875294 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:00:33.877245 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:00:33.879171 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m02:00:33.881417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m02:00:33.882956 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:00:33.899174 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:00:33.900625 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:00:33.903799 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:00:33.905319 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:00:33.905956 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m02:00:33.906499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:34.563824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m02:00:34.566019 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m02:00:34.682888 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.80s]
[0m02:00:34.684586 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:00:34.685472 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:00:34.686295 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m02:00:34.687456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m02:00:34.688245 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:00:34.695160 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:00:34.696814 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:00:34.701500 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:00:34.703470 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:00:34.704142 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m02:00:34.704793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:35.427604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m02:00:35.431407 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m02:00:35.572142 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.88s]
[0m02:00:35.575385 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:00:35.577074 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:00:35.579107 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m02:00:35.580676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m02:00:35.581073 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:00:35.584516 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:00:35.585332 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:00:35.587175 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:00:35.588148 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:00:35.588571 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m02:00:35.588926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:36.287758 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cf8-0004-2cef-0000-00027a6fe481
[0m02:00:36.289451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m02:00:36.291275 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m02:00:36.426940 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m02:00:36.427491 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.85s]
[0m02:00:36.428309 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:00:36.428747 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:00:36.429124 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m02:00:36.429738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m02:00:36.430135 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:00:36.433642 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:00:36.434529 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:00:36.436360 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:00:36.437347 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:00:36.437709 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m02:00:36.438053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:37.155213 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cf8-0004-2ced-0002-7a6f0001047e
[0m02:00:37.155725 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m02:00:37.156210 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m02:00:37.335362 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m02:00:37.336448 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.91s]
[0m02:00:37.337961 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:00:37.338712 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:00:37.339395 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m02:00:37.340662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m02:00:37.341341 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:00:37.345728 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:00:37.346534 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:00:37.348284 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:00:37.349240 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:00:37.349679 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m02:00:37.350031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:38.070036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m02:00:38.073733 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m02:00:38.190981 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.85s]
[0m02:00:38.191838 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:00:38.192322 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:00:38.192718 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m02:00:38.193333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m02:00:38.193723 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:00:38.197241 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:00:38.198068 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:00:38.200023 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:00:38.201048 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:00:38.201437 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m02:00:38.201800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:38.858458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m02:00:38.865414 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m02:00:39.017150 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.82s]
[0m02:00:43.228512 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:00:43.229517 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:00:43.230145 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m02:00:43.231109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m02:00:43.231702 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:00:43.236101 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:00:43.237022 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:00:43.239042 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:00:43.240442 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:00:43.241243 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m02:00:43.241875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:43.998438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m02:00:44.002331 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m02:00:44.113705 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.88s]
[0m02:00:44.114631 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:00:44.115079 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:00:44.115464 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m02:00:44.116110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m02:00:44.116585 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:00:44.120164 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:00:44.120999 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:00:44.122855 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:00:44.123964 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:00:44.124374 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m02:00:44.124735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:44.855899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m02:00:44.862544 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m02:00:44.996368 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 0.88s]
[0m02:00:45.001019 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:00:45.001914 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:00:45.002401 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m02:00:45.003050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m02:00:45.003421 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:00:45.007080 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:00:45.008000 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:00:45.009956 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:00:45.011022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:00:45.011421 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m02:00:45.011781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:45.741396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m02:00:45.748063 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m02:00:45.877035 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 0.87s]
[0m02:00:45.880118 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:00:45.881957 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:00:45.883815 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m02:00:45.886139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m02:00:45.887683 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:00:45.901073 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:00:45.903611 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:00:45.908790 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:00:45.911018 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:00:45.911879 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m02:00:45.912618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:46.616858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m02:00:46.620475 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m02:00:46.739969 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.85s]
[0m02:00:46.743100 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:00:46.744951 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:00:46.746438 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m02:00:46.747113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m02:00:46.747487 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:00:46.750952 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:00:46.751743 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:00:46.753720 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:00:46.754792 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:00:46.755415 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m02:00:46.755945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:47.460316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m02:00:47.465428 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m02:00:47.578233 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 0.83s]
[0m02:00:47.579127 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:00:47.579554 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:00:47.579940 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m02:00:47.580486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m02:00:47.580884 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:00:47.584415 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:00:47.585368 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:00:47.587393 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:00:47.588451 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:00:47.588919 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m02:00:47.589330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:48.236468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m02:00:48.240447 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m02:00:48.372479 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.79s]
[0m02:00:48.373404 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:00:48.373860 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:00:48.374245 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m02:00:48.374900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m02:00:48.375320 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:00:48.381819 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:00:48.382725 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:00:48.384631 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:00:48.385651 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:00:48.386046 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m02:00:48.386409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:49.128697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m02:00:49.130515 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m02:00:49.245257 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 0.87s]
[0m02:00:49.249473 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:00:49.251347 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:00:49.252905 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m02:00:49.255102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m02:00:49.256768 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:00:49.268026 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:00:49.269990 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:00:49.274302 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:00:49.276269 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:00:49.276957 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m02:00:49.277558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:50.033166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m02:00:50.035188 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m02:00:50.149432 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 0.89s]
[0m02:00:50.152482 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:00:50.154090 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:00:50.155872 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m02:00:50.157964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m02:00:50.159454 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:00:50.175827 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:00:50.179104 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:00:50.185794 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:00:50.189293 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:00:50.190600 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m02:00:50.191584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:00:50.906733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m02:00:50.910445 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m02:00:51.024425 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.87s]
[0m02:00:51.025350 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:00:51.033595 [error] [MainThread]: CANCEL query list_dev_raw_data ................................................. [[31mCANCEL[0m]
[0m02:00:51.034286 [error] [MainThread]: CANCEL query test.stock_dbt.unique_transformations_symbol.2bcfbcf557 ........... [[31mCANCEL[0m]
[0m02:00:51.034962 [info ] [MainThread]: 
[0m02:00:51.035604 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m02:00:51.036279 [info ] [MainThread]: 
[0m02:00:51.037030 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__100000 (models\schema.yml)[0m
[0m02:00:51.038008 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m02:00:51.038788 [info ] [MainThread]: 
[0m02:00:51.039293 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__100000.sql
[0m02:00:51.039764 [info ] [MainThread]: 
[0m02:00:51.040326 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m02:00:51.040811 [info ] [MainThread]: 
[0m02:00:51.041380 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m02:00:51.041833 [info ] [MainThread]: 
[0m02:00:51.042356 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__100000 (models\schema.yml)[0m
[0m02:00:51.042862 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m02:00:51.043292 [info ] [MainThread]: 
[0m02:00:51.043792 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__100000.sql
[0m02:00:51.044261 [info ] [MainThread]: 
[0m02:00:51.044773 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__10000000 (models\schema.yml)[0m
[0m02:00:51.045279 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:00:51.045705 [info ] [MainThread]: 
[0m02:00:51.046184 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__10000000.sql
[0m02:00:51.046644 [info ] [MainThread]: 
[0m02:00:51.047161 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__100000 (models\schema.yml)[0m
[0m02:00:51.047661 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:00:51.048084 [info ] [MainThread]: 
[0m02:00:51.048615 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__100000.sql
[0m02:00:51.049039 [info ] [MainThread]: 
[0m02:00:51.049528 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__100000 (models\schema.yml)[0m
[0m02:00:51.049999 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:00:51.050403 [info ] [MainThread]: 
[0m02:00:51.050880 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__100000.sql
[0m02:00:51.051301 [info ] [MainThread]: 
[0m02:00:51.051781 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m02:00:51.052247 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m02:00:51.052648 [info ] [MainThread]: 
[0m02:00:51.053070 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m02:00:51.053499 [info ] [MainThread]: 
[0m02:00:51.054032 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m02:00:51.054511 [info ] [MainThread]: 
[0m02:00:51.055027 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m02:00:51.055499 [info ] [MainThread]: 
[0m02:00:51.056049 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m02:00:51.056553 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m02:00:51.056976 [info ] [MainThread]: 
[0m02:00:51.057448 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m02:00:51.057848 [info ] [MainThread]: 
[0m02:00:51.058324 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m02:00:51.058825 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m02:00:51.059244 [info ] [MainThread]: 
[0m02:00:51.059713 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m02:00:51.060130 [info ] [MainThread]: 
[0m02:00:51.060609 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m02:00:51.061083 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m02:00:51.061496 [info ] [MainThread]: 
[0m02:00:51.061969 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m02:00:51.062406 [info ] [MainThread]: 
[0m02:00:51.062845 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m02:00:51.063283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:51.063536 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m02:00:51.063783 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m02:00:51.064093 [info ] [MainThread]: 
[0m02:00:51.064532 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 26.30 seconds (26.30s).
[0m02:00:51.065065 [error] [MainThread]: Encountered an error:

[0m02:00:51.121567 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\task\runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\task\runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
    ~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\task\runnable.py", line 315, in run_queue
    self.job_queue.join()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\graph\queue.py", line 198, in join
    self.inner.join()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\queue.py", line 108, in join
    self.all_tasks_done.wait()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\mtann\AppData\Local\Programs\Python\Python313\Lib\threading.py", line 359, in wait
    waiter.acquire()
    ~~~~~~~~~~~~~~^^
KeyboardInterrupt

[0m02:00:51.124398 [debug] [MainThread]: Command `dbt test` failed at 02:00:51.124146 after 28.67 seconds
[0m02:00:51.124804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833E30C9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833E8137F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002833E811450>]}
[0m02:00:51.125143 [debug] [MainThread]: Flushing usage events
[0m02:04:25.509340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B87E3AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B800E70190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B800E70050>]}


============================== 02:04:25.513025 | 4eb400c3-b5eb-4865-9f64-d75232342706 ==============================
[0m02:04:25.513025 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:04:25.513671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:04:26.355765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B800201E00>]}
[0m02:04:26.407566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80011E030>]}
[0m02:04:26.408974 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:04:26.416673 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:04:26.583042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:04:26.583680 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\raw_data_model.sql
[0m02:04:26.785847 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:04:26.786438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8123F4450>]}
[0m02:04:26.994561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8120E3D40>]}
[0m02:04:27.123650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8120F6C10>]}
[0m02:04:27.124137 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m02:04:27.124671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81356BEE0>]}
[0m02:04:27.127371 [info ] [MainThread]: 
[0m02:04:27.128185 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:04:27.132389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m02:04:27.146696 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m02:04:27.147078 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m02:04:27.147372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:28.029267 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.882 seconds
[0m02:04:28.031042 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m02:04:28.150918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m02:04:28.154626 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m02:04:28.154971 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m02:04:28.155272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:28.817856 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.662 seconds
[0m02:04:28.821176 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m02:04:28.944213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eb400c3-b5eb-4865-9f64-d75232342706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8137E1C10>]}
[0m02:04:28.946351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:28.948212 [info ] [MainThread]: 
[0m02:04:28.960313 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:04:28.962069 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__100000 ............. [RUN]
[0m02:04:28.964072 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04'
[0m02:04:28.965177 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:04:28.981340 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:04:28.983560 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:04:29.007299 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:04:29.008582 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:04:29.008972 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:04:29.009329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:29.825255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.815 seconds
[0m02:04:29.835262 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: Close
[0m02:04:29.958782 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__100000 ............... [[31mFAIL 198[0m in 0.99s]
[0m02:04:29.961015 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:04:29.961518 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:04:29.961940 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__100000 ......... [RUN]
[0m02:04:29.962765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d)
[0m02:04:29.963214 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:04:29.967389 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:04:29.968192 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:04:29.970160 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:04:29.971383 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:04:29.972004 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:04:29.972426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:30.810751 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfc-0004-2ceb-0002-7a6f00014432
[0m02:04:30.812432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m02:04:30.813779 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: Close
[0m02:04:30.984664 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m02:04:30.985860 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__100000 .............. [[31mERROR[0m in 1.02s]
[0m02:04:30.987681 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:04:30.988575 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:04:30.990571 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__100000 ......... [RUN]
[0m02:04:30.991660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd)
[0m02:04:30.992370 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:04:30.997875 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:04:30.999383 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:04:31.003163 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:04:31.004795 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:04:31.005404 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:04:31.005938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:31.781739 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfc-0004-2cf3-0000-00027a6fc449
[0m02:04:31.782239 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m02:04:31.782695 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: Close
[0m02:04:31.928839 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m02:04:31.929378 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__100000 .............. [[31mERROR[0m in 0.94s]
[0m02:04:31.930221 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:04:31.930636 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:04:31.931010 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__100000 .............. [RUN]
[0m02:04:31.931656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd, now test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d)
[0m02:04:31.932046 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:04:31.935491 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:04:31.936277 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:04:31.938266 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:04:31.939411 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:04:31.939799 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:04:31.940163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:32.631091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m02:04:32.633731 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: Close
[0m02:04:32.759513 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__100000 ................ [[31mFAIL 199[0m in 0.83s]
[0m02:04:32.760690 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:04:32.761403 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:04:32.762014 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__10000000 .......... [RUN]
[0m02:04:32.762929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d, now test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07)
[0m02:04:32.763432 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:04:32.766884 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:04:32.767758 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:04:32.769726 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:04:32.771267 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:04:32.771987 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','10000000'
)



      
    ) dbt_internal_test
[0m02:04:32.772609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:33.538189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m02:04:33.541126 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: Close
[0m02:04:33.676815 [error] [Thread-1 (]: 5 of 23 FAIL 200 accepted_values_raw_data_model_volume__0__10000000 ............ [[31mFAIL 200[0m in 0.91s]
[0m02:04:33.679997 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:04:33.681827 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:04:33.683466 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__100000  [RUN]
[0m02:04:33.685912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e)
[0m02:04:33.688288 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:04:33.702714 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:04:33.706716 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:04:33.711449 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:04:33.713652 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:04:33.714418 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:04:33.715136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:34.466179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m02:04:34.468669 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: Close
[0m02:04:34.615770 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__100000 .. [[31mFAIL 200[0m in 0.93s]
[0m02:04:34.618968 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:04:34.620992 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:04:34.622880 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__100000  [RUN]
[0m02:04:34.624614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b)
[0m02:04:34.625758 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:04:34.630485 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:04:34.631293 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:04:34.633236 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:04:34.634389 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:04:34.634799 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:04:34.635166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:35.304474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m02:04:35.307880 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: Close
[0m02:04:35.431107 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__100000 .. [[31mFAIL 200[0m in 0.81s]
[0m02:04:35.432007 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:04:35.432489 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:04:35.432862 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m02:04:35.433571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m02:04:35.433997 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:04:35.437884 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:04:35.439059 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:04:35.441817 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:04:35.443004 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:04:35.443422 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m02:04:35.443785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:36.191879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m02:04:36.194180 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m02:04:36.322219 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 0.89s]
[0m02:04:36.325155 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:04:36.326909 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:04:36.328675 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m02:04:36.329360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m02:04:36.329756 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:04:36.335747 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:04:36.336644 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:04:36.338759 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:04:36.339816 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:04:36.340202 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m02:04:36.340551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:37.028764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m02:04:37.030838 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m02:04:37.139751 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.81s]
[0m02:04:37.142950 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:04:37.144778 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:04:37.146698 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m02:04:37.148595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m02:04:37.149745 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:04:37.157797 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:04:37.159286 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:04:37.162800 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:04:37.164248 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:04:37.164828 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m02:04:37.165388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:37.865428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m02:04:37.868841 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m02:04:37.992775 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.84s]
[0m02:04:37.995939 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:04:37.998116 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:04:38.000173 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m02:04:38.002808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m02:04:38.003362 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:04:38.007240 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:04:38.008242 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:04:38.010400 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:04:38.011421 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:04:38.011817 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m02:04:38.012192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:38.700930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfc-0004-2cee-0002-7a6f0001705a
[0m02:04:38.702610 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m02:04:38.704405 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m02:04:38.868631 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m02:04:38.869766 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.87s]
[0m02:04:38.871456 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:04:38.872454 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:04:38.873188 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m02:04:38.874346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m02:04:38.875047 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:04:38.878567 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:04:38.879748 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:04:38.881657 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:04:38.882715 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:04:38.883073 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m02:04:38.883408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:39.619596 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfc-0004-2cf5-0002-7a6f000113ba
[0m02:04:39.620025 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m02:04:39.620438 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m02:04:39.764078 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m02:04:39.765179 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.89s]
[0m02:04:39.766867 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:04:39.767780 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:04:39.768716 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m02:04:39.769820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m02:04:39.770525 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:04:39.775977 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:04:39.777157 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:04:39.779704 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:04:39.780958 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:04:39.781459 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m02:04:39.781935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:40.497219 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m02:04:40.503239 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m02:04:40.615667 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.85s]
[0m02:04:40.619102 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:04:40.621106 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:04:40.623181 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m02:04:40.625285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m02:04:40.626393 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:04:40.634979 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:04:40.636606 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:04:40.640140 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:04:40.641707 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:04:40.642389 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m02:04:40.642954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:41.347167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m02:04:41.349178 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m02:04:41.459395 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.83s]
[0m02:04:41.461252 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:04:41.462212 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:04:41.463282 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m02:04:41.464528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m02:04:41.465207 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:04:41.471967 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:04:41.473193 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:04:41.475873 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:04:41.477172 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:04:41.477739 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m02:04:41.478352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:42.164677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m02:04:42.169402 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m02:04:42.303582 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.84s]
[0m02:04:42.304878 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:04:42.305606 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:04:42.306038 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m02:04:42.306786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m02:04:42.307221 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:04:42.312389 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:04:42.313713 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:04:42.316101 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:04:42.317803 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:04:42.318482 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m02:04:42.319128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:43.136550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.817 seconds
[0m02:04:43.143197 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m02:04:43.262752 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 0.96s]
[0m02:04:43.265922 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:04:43.267820 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:04:43.269698 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m02:04:43.271940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m02:04:43.274331 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:04:43.280530 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:04:43.281344 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:04:43.283486 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:04:43.284579 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:04:43.284980 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m02:04:43.285344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:43.992928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m02:04:43.995356 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m02:04:44.170542 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 0.90s]
[0m02:04:44.173900 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:04:44.175695 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:04:44.177609 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m02:04:44.179802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m02:04:44.180906 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:04:44.189132 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:04:44.190608 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:04:44.193990 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:04:44.195575 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:04:44.196161 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m02:04:44.196712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:44.827680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m02:04:44.829549 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m02:04:44.990113 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.81s]
[0m02:04:44.993475 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:04:44.995439 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:04:44.997359 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m02:04:44.999533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m02:04:45.001088 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:04:45.012907 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:04:45.014640 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:04:45.018312 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:04:45.020103 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:04:45.020724 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m02:04:45.021287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:45.743201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m02:04:45.745836 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m02:04:45.862048 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 0.86s]
[0m02:04:45.864065 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:04:45.865403 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:04:45.866725 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m02:04:45.868251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m02:04:45.869204 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:04:45.876979 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:04:45.878571 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:04:45.881935 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:04:45.884011 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:04:45.884682 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m02:04:45.885196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:46.571929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m02:04:46.573704 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m02:04:46.680802 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.81s]
[0m02:04:46.681701 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:04:46.682127 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:04:46.682504 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m02:04:46.683189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m02:04:46.683597 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:04:46.689113 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:04:46.689915 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:04:46.691723 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:04:46.692758 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:04:46.693131 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m02:04:46.693479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:47.412584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m02:04:47.419223 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m02:04:47.527787 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 0.84s]
[0m02:04:47.531970 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:04:47.533988 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:04:47.535513 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m02:04:47.536208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m02:04:47.536590 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:04:47.540182 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:04:47.541006 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:04:47.542980 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:04:47.544167 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:04:47.544582 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m02:04:47.544956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:48.305895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m02:04:48.308949 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m02:04:48.412967 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 0.88s]
[0m02:04:48.416537 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:04:48.418329 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:04:48.420055 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m02:04:48.421710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m02:04:48.422791 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:04:48.430527 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:04:48.431991 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:04:48.435362 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:04:48.436920 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:04:48.437514 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m02:04:48.438066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:04:49.109139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m02:04:49.112646 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m02:04:49.229585 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.81s]
[0m02:04:49.232846 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:04:49.238194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:49.239522 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m02:04:49.240640 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m02:04:49.242001 [info ] [MainThread]: 
[0m02:04:49.244021 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 22.11 seconds (22.11s).
[0m02:04:49.255437 [debug] [MainThread]: Command end result
[0m02:04:49.291446 [info ] [MainThread]: 
[0m02:04:49.292289 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m02:04:49.292852 [info ] [MainThread]: 
[0m02:04:49.293420 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__100000 (models\schema.yml)[0m
[0m02:04:49.294076 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m02:04:49.294520 [info ] [MainThread]: 
[0m02:04:49.295028 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__100000.sql
[0m02:04:49.295474 [info ] [MainThread]: 
[0m02:04:49.296007 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m02:04:49.296450 [info ] [MainThread]: 
[0m02:04:49.296978 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m02:04:49.297587 [info ] [MainThread]: 
[0m02:04:49.298170 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__100000 (models\schema.yml)[0m
[0m02:04:49.298687 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m02:04:49.299143 [info ] [MainThread]: 
[0m02:04:49.299772 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__100000.sql
[0m02:04:49.300231 [info ] [MainThread]: 
[0m02:04:49.300746 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__10000000 (models\schema.yml)[0m
[0m02:04:49.301259 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:04:49.301719 [info ] [MainThread]: 
[0m02:04:49.302235 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__10000000.sql
[0m02:04:49.302750 [info ] [MainThread]: 
[0m02:04:49.303450 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__100000 (models\schema.yml)[0m
[0m02:04:49.303991 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:04:49.304438 [info ] [MainThread]: 
[0m02:04:49.305042 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__100000.sql
[0m02:04:49.305651 [info ] [MainThread]: 
[0m02:04:49.306192 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__100000 (models\schema.yml)[0m
[0m02:04:49.306714 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:04:49.307196 [info ] [MainThread]: 
[0m02:04:49.307697 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__100000.sql
[0m02:04:49.308196 [info ] [MainThread]: 
[0m02:04:49.308707 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m02:04:49.309216 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m02:04:49.309653 [info ] [MainThread]: 
[0m02:04:49.310177 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m02:04:49.310622 [info ] [MainThread]: 
[0m02:04:49.311136 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m02:04:49.311631 [info ] [MainThread]: 
[0m02:04:49.312144 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m02:04:49.312619 [info ] [MainThread]: 
[0m02:04:49.313276 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m02:04:49.313937 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m02:04:49.314655 [info ] [MainThread]: 
[0m02:04:49.315254 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m02:04:49.315800 [info ] [MainThread]: 
[0m02:04:49.316350 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m02:04:49.316862 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m02:04:49.317300 [info ] [MainThread]: 
[0m02:04:49.317795 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m02:04:49.318235 [info ] [MainThread]: 
[0m02:04:49.318813 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m02:04:49.319322 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m02:04:49.319755 [info ] [MainThread]: 
[0m02:04:49.320253 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m02:04:49.320724 [info ] [MainThread]: 
[0m02:04:49.321210 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m02:04:49.322312 [debug] [MainThread]: Command `dbt test` failed at 02:04:49.322187 after 23.95 seconds
[0m02:04:49.322664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B81366C9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B813B32C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B813B33750>]}
[0m02:04:49.323069 [debug] [MainThread]: Flushing usage events
[0m02:04:55.796386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40B7A2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40E220190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40E220050>]}


============================== 02:04:55.800291 | 40142a5c-3d54-40c8-8a8a-21fcf13cbee8 ==============================
[0m02:04:55.800291 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:04:55.800961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:04:56.668254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40D569E00>]}
[0m02:04:56.719618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40D48E030>]}
[0m02:04:56.720913 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:04:56.728592 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:04:56.886614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:56.886970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:56.940603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F514350>]}
[0m02:04:57.054492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F5028A0>]}
[0m02:04:57.054967 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m02:04:57.055458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40D4E4830>]}
[0m02:04:57.057415 [info ] [MainThread]: 
[0m02:04:57.058095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:04:57.062290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m02:04:57.075578 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m02:04:57.076121 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m02:04:57.076433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:57.866714 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.790 seconds
[0m02:04:57.870515 [debug] [ThreadPool]: On list_DEV: Close
[0m02:04:58.011661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m02:04:58.019602 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m02:04:58.019986 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m02:04:58.020275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:58.727204 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.707 seconds
[0m02:04:58.729912 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m02:04:58.842380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m02:04:58.844564 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m02:04:58.844958 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m02:04:58.845332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:59.565992 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.720 seconds
[0m02:04:59.568800 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m02:04:59.682491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F897520>]}
[0m02:04:59.683079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:59.683681 [info ] [MainThread]: 
[0m02:04:59.688210 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m02:04:59.688785 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m02:04:59.689513 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m02:04:59.689879 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m02:04:59.697303 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m02:04:59.698395 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m02:04:59.725765 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m02:04:59.727391 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m02:04:59.727801 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        COALESCE(open, 0) AS open,  -- Replace NULL with 0 for open price
        COALESCE(max_value, 0) AS high,  -- Replace NULL with 0 for max price
        COALESCE(min_value, 0) AS low,  -- Replace NULL with 0 for min price
        COALESCE(close, 0) AS close,  -- Replace NULL with 0 for close price
        CASE 
            WHEN volume < 0 THEN 0  -- Ensure volume is non-negative
            WHEN volume > 10000000 THEN 10000000  -- Cap volume to a max value of 10M
            ELSE volume 
        END AS volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data;
[0m02:04:59.728163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:05:00.466847 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfd-0004-2ced-0002-7a6f0001048e
[0m02:05:00.467416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 13 unexpected ';'.
[0m02:05:00.467996 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m02:05:00.597705 [debug] [Thread-1 (]: Database Error in model raw_data_model (models\raw_data_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 13 unexpected ';'.
  compiled code at target\run\stock_dbt\models\raw_data_model.sql
[0m02:05:00.599077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40142a5c-3d54-40c8-8a8a-21fcf13cbee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F8F9250>]}
[0m02:05:00.599738 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model raw_data.raw_data_model ................... [[31mERROR[0m in 0.91s]
[0m02:05:00.600981 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m02:05:00.602790 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m02:05:00.603412 [info ] [Thread-1 (]: 2 of 2 SKIP relation raw_data.transformations .................................. [[33mSKIP[0m]
[0m02:05:00.604076 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m02:05:00.605525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:05:00.605844 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m02:05:00.606101 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m02:05:00.606354 [debug] [MainThread]: Connection 'model.stock_dbt.raw_data_model' was properly closed.
[0m02:05:00.606658 [info ] [MainThread]: 
[0m02:05:00.607176 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m02:05:00.608133 [debug] [MainThread]: Command end result
[0m02:05:00.636191 [info ] [MainThread]: 
[0m02:05:00.636825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:05:00.637280 [info ] [MainThread]: 
[0m02:05:00.637837 [error] [MainThread]:   Database Error in model raw_data_model (models\raw_data_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 13 unexpected ';'.
  compiled code at target\run\stock_dbt\models\raw_data_model.sql
[0m02:05:00.638324 [info ] [MainThread]: 
[0m02:05:00.638798 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m02:05:00.639829 [debug] [MainThread]: Command `dbt run` failed at 02:05:00.639698 after 4.94 seconds
[0m02:05:00.640178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F72D180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F966AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41F966D50>]}
[0m02:05:00.640515 [debug] [MainThread]: Flushing usage events
[0m02:05:56.882881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F759D8EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75C800190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75C800050>]}


============================== 02:05:56.888101 | 8fd6e39e-5964-43c8-b779-ced5ee3cd3df ==============================
[0m02:05:56.888101 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:05:56.888790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:05:57.745512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BB61E00>]}
[0m02:05:57.797590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BA7E030>]}
[0m02:05:57.798921 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:05:57.806424 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:05:57.960025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:05:57.960695 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\raw_data_model.sql
[0m02:05:58.164260 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:05:58.164859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76DDE4450>]}
[0m02:05:58.374642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76DACFD40>]}
[0m02:05:58.487827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BB48E50>]}
[0m02:05:58.488295 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m02:05:58.488772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76DD86D00>]}
[0m02:05:58.490876 [info ] [MainThread]: 
[0m02:05:58.491707 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:05:58.495826 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m02:05:58.508353 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m02:05:58.508739 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m02:05:58.509027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:05:59.363420 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.854 seconds
[0m02:05:59.366426 [debug] [ThreadPool]: On list_DEV: Close
[0m02:05:59.491119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m02:05:59.520399 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m02:05:59.521066 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m02:05:59.521603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:00.287588 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.766 seconds
[0m02:06:00.291734 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m02:06:00.422052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m02:06:00.431347 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m02:06:00.432765 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m02:06:00.434039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:01.153871 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.720 seconds
[0m02:06:01.157523 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m02:06:01.295470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76DF14A10>]}
[0m02:06:01.296806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:06:01.298180 [info ] [MainThread]: 
[0m02:06:01.302236 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m02:06:01.302786 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m02:06:01.303472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m02:06:01.303832 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m02:06:01.310253 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m02:06:01.311084 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m02:06:01.338725 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m02:06:01.340069 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m02:06:01.340486 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        COALESCE(open, 0) AS open,  -- Replace NULL with 0 for open price
        COALESCE(max_value, 0) AS high,  -- Replace NULL with 0 for max price
        COALESCE(min_value, 0) AS low,  -- Replace NULL with 0 for min price
        COALESCE(close, 0) AS close,  -- Replace NULL with 0 for close price
        CASE 
            WHEN volume < 0 THEN 0  -- Ensure volume is non-negative
            WHEN volume > 10000000 THEN 10000000  -- Cap volume to a max value of 10M
            ELSE volume 
        END AS volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m02:06:01.340864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:06:02.353857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m02:06:02.382826 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m02:06:02.501412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F17AA40>]}
[0m02:06:02.502105 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.20s]
[0m02:06:02.503004 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m02:06:02.503823 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m02:06:02.504434 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m02:06:02.505102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m02:06:02.505501 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m02:06:02.508431 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m02:06:02.509354 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m02:06:02.528647 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m02:06:02.531158 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m02:06:02.531671 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m02:06:02.532117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:04.934388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.402 seconds
[0m02:06:04.941987 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m02:06:05.078572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fd6e39e-5964-43c8-b779-ced5ee3cd3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F121770>]}
[0m02:06:05.079274 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.57s]
[0m02:06:05.080186 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m02:06:05.081574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:05.081904 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m02:06:05.082177 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m02:06:05.082442 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m02:06:05.082773 [info ] [MainThread]: 
[0m02:06:05.083352 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m02:06:05.084452 [debug] [MainThread]: Command end result
[0m02:06:05.112776 [info ] [MainThread]: 
[0m02:06:05.113554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:06:05.114118 [info ] [MainThread]: 
[0m02:06:05.114626 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:06:05.115696 [debug] [MainThread]: Command `dbt run` succeeded at 02:06:05.115564 after 8.34 seconds
[0m02:06:05.116040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76DECEFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75BAFDA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75C846C80>]}
[0m02:06:05.116380 [debug] [MainThread]: Flushing usage events
[0m02:06:11.135837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF2541EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF27EA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF27EA0050>]}


============================== 02:06:11.139473 | e97f3509-66d2-4bf4-8611-925b176c2b1d ==============================
[0m02:06:11.139473 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:06:11.140046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:06:12.083314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97f3509-66d2-4bf4-8611-925b176c2b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF271EDE00>]}
[0m02:06:12.134897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e97f3509-66d2-4bf4-8611-925b176c2b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF2710E030>]}
[0m02:06:12.136244 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:06:12.143762 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:06:12.305520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:06:12.305934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:06:12.358469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e97f3509-66d2-4bf4-8611-925b176c2b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF39108350>]}
[0m02:06:12.491406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e97f3509-66d2-4bf4-8611-925b176c2b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF39489220>]}
[0m02:06:12.491887 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m02:06:12.492389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97f3509-66d2-4bf4-8611-925b176c2b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF394D1E10>]}
[0m02:06:12.495081 [info ] [MainThread]: 
[0m02:06:12.495858 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:06:12.500016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m02:06:12.515465 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m02:06:12.515845 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m02:06:12.516130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:13.477314 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.961 seconds
[0m02:06:13.479146 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m02:06:13.594954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m02:06:13.596852 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m02:06:13.597835 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m02:06:13.598148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:14.431440 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.833 seconds
[0m02:06:14.434390 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m02:06:14.585722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97f3509-66d2-4bf4-8611-925b176c2b1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF394A3450>]}
[0m02:06:14.586268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:06:14.586795 [info ] [MainThread]: 
[0m02:06:14.590713 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:06:14.591534 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__100000 ............. [RUN]
[0m02:06:14.592965 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04'
[0m02:06:14.593771 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:06:14.611098 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:06:14.611932 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:06:14.632186 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:06:14.633407 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"
[0m02:06:14.633803 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:06:14.634169 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:06:15.465596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.831 seconds
[0m02:06:15.475838 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04: Close
[0m02:06:15.592001 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__100000 ............... [[31mFAIL 198[0m in 1.00s]
[0m02:06:15.595479 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04
[0m02:06:15.597853 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:06:15.598759 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__100000 ......... [RUN]
[0m02:06:15.599467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__100000.0bb9e2fe04, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d)
[0m02:06:15.599865 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:06:15.603366 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:06:15.604197 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:06:15.606708 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:06:15.608115 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"
[0m02:06:15.608815 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:06:15.609442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:16.298452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfe-0004-2cec-0002-7a6f00016ade
[0m02:06:16.298877 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m02:06:16.299311 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d: Close
[0m02:06:16.446686 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m02:06:16.447884 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__100000 .............. [[31mERROR[0m in 0.85s]
[0m02:06:16.449371 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d
[0m02:06:16.450145 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:06:16.450836 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__100000 ......... [RUN]
[0m02:06:16.452958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__100000.6ac89e800d, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd)
[0m02:06:16.453603 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:06:16.458809 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:06:16.459902 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:06:16.462431 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:06:16.463763 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"
[0m02:06:16.464236 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:06:16.464674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:17.215453 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfe-0004-2cf6-0000-00027a6fd471
[0m02:06:17.215925 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m02:06:17.216413 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd: Close
[0m02:06:17.354828 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m02:06:17.355961 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__100000 .............. [[31mERROR[0m in 0.90s]
[0m02:06:17.357868 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd
[0m02:06:17.359258 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:06:17.360277 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__100000 .............. [RUN]
[0m02:06:17.361380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__100000.d7885664cd, now test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d)
[0m02:06:17.362068 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:06:17.367366 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:06:17.368582 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:06:17.371098 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:06:17.372510 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"
[0m02:06:17.373019 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:06:17.373491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:18.275114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m02:06:18.282069 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d: Close
[0m02:06:18.417460 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__100000 ................ [[31mFAIL 199[0m in 1.06s]
[0m02:06:18.418368 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d
[0m02:06:18.418804 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:06:18.419244 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__10000000 .......... [RUN]
[0m02:06:18.419837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__100000.97438a2a0d, now test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07)
[0m02:06:18.420240 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:06:18.423830 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:06:18.424723 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:06:18.426789 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:06:18.427954 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m02:06:18.428373 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','10000000'
)



      
    ) dbt_internal_test
[0m02:06:18.428758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:19.318870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m02:06:19.322456 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: Close
[0m02:06:19.435369 [error] [Thread-1 (]: 5 of 23 FAIL 1 accepted_values_raw_data_model_volume__0__10000000 .............. [[31mFAIL 1[0m in 1.02s]
[0m02:06:19.436315 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m02:06:19.436787 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:06:19.437184 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__100000  [RUN]
[0m02:06:19.437823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e)
[0m02:06:19.438245 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:06:19.441933 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:06:19.442791 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:06:19.444760 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:06:19.445903 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"
[0m02:06:19.446313 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:06:19.446700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:20.432296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.985 seconds
[0m02:06:20.438902 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e: Close
[0m02:06:20.566559 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__100000 .. [[31mFAIL 200[0m in 1.13s]
[0m02:06:20.568867 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e
[0m02:06:20.570187 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:06:20.571713 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__100000  [RUN]
[0m02:06:20.573856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__100000.160ee0ab0e, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b)
[0m02:06:20.575036 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:06:20.584462 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:06:20.586152 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:06:20.589864 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:06:20.592017 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"
[0m02:06:20.592765 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','100000'
)



      
    ) dbt_internal_test
[0m02:06:20.593432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:21.709488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m02:06:21.711439 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b: Close
[0m02:06:21.889866 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__100000 .. [[31mFAIL 200[0m in 1.32s]
[0m02:06:21.891131 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b
[0m02:06:21.891774 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:06:21.892350 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m02:06:21.893270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__100000.39f3bd4a2b, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m02:06:21.893899 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:06:21.899108 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:06:21.900257 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:06:21.903043 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:06:21.904655 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m02:06:21.905291 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m02:06:21.905859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:22.820426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m02:06:22.823602 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m02:06:22.942994 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 1.05s]
[0m02:06:22.943915 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m02:06:22.944398 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:06:22.944796 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m02:06:22.945521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m02:06:22.945982 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:06:22.951902 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:06:22.952794 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:06:22.954862 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:06:22.956364 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m02:06:22.956909 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m02:06:22.957299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:23.730263 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m02:06:23.735918 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m02:06:23.883666 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.94s]
[0m02:06:23.885675 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m02:06:23.886750 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:06:23.887979 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m02:06:23.889456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m02:06:23.890424 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:06:23.898698 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:06:23.900255 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:06:23.903888 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:06:23.905574 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m02:06:23.906229 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m02:06:23.906823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:24.657693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m02:06:24.660329 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m02:06:24.774964 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.89s]
[0m02:06:24.776444 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m02:06:24.777268 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:06:24.777936 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m02:06:24.778958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m02:06:24.779612 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:06:24.785359 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:06:24.786665 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:06:24.790015 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:06:24.791515 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m02:06:24.792079 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m02:06:24.792487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:25.526879 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfe-0004-2ceb-0002-7a6f00014446
[0m02:06:25.528530 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m02:06:25.530279 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m02:06:25.676828 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m02:06:25.677965 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.90s]
[0m02:06:25.679402 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m02:06:25.680126 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:06:25.680782 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m02:06:25.681805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m02:06:25.682491 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:06:25.687950 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:06:25.689062 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:06:25.691529 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:06:25.692758 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m02:06:25.693273 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m02:06:25.693689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:26.404619 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85cfe-0004-2ced-0002-7a6f00010492
[0m02:06:26.405512 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m02:06:26.405966 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m02:06:26.570910 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m02:06:26.572048 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.89s]
[0m02:06:26.573659 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m02:06:26.574410 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:06:26.575092 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m02:06:26.576509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m02:06:26.577202 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:06:26.582412 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:06:26.583526 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:06:26.586027 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:06:26.587593 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m02:06:26.588054 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m02:06:26.588429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:27.329651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m02:06:27.336891 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m02:06:27.463835 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.89s]
[0m02:06:27.466989 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m02:06:27.468781 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:06:27.470770 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m02:06:27.473262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m02:06:27.473675 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:06:27.477285 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:06:27.478091 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:06:27.479917 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:06:27.480834 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m02:06:27.481236 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m02:06:27.481588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:28.193103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m02:06:28.196464 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m02:06:28.319040 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.85s]
[0m02:06:28.322307 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m02:06:28.324095 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:06:28.325980 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m02:06:28.328301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m02:06:28.329852 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:06:28.340295 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:06:28.342073 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:06:28.345660 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:06:28.347373 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m02:06:28.348088 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m02:06:28.348671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:29.085291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m02:06:29.091977 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m02:06:29.228564 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.90s]
[0m02:06:29.231718 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m02:06:29.233552 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:06:29.235370 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m02:06:29.238484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m02:06:29.240122 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:06:29.244484 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:06:29.245283 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:06:29.247187 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:06:29.248393 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m02:06:29.248869 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m02:06:29.249249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:29.951092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m02:06:29.953096 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m02:06:30.105925 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 0.87s]
[0m02:06:30.106919 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m02:06:30.107473 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:06:30.107997 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m02:06:30.108795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m02:06:30.109285 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:06:30.113468 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:06:30.114401 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:06:30.116567 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:06:30.117707 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m02:06:30.118280 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m02:06:30.118689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:31.100884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m02:06:31.103281 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m02:06:31.234114 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 1.12s]
[0m02:06:31.236314 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m02:06:31.237663 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:06:31.238757 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m02:06:31.240074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m02:06:31.241479 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:06:31.247273 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:06:31.248493 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:06:31.251425 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:06:31.252889 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m02:06:31.253438 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m02:06:31.254006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:32.022959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m02:06:32.029750 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m02:06:32.162619 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.92s]
[0m02:06:32.163516 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m02:06:32.163958 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:06:32.164355 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m02:06:32.165000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m02:06:32.165421 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:06:32.169229 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:06:32.170068 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:06:32.172017 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:06:32.172965 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m02:06:32.173351 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m02:06:32.173728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:33.149207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.975 seconds
[0m02:06:33.155968 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m02:06:33.286188 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 1.12s]
[0m02:06:33.289419 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m02:06:33.291431 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:06:33.293672 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m02:06:33.295977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m02:06:33.297497 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:06:33.311926 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:06:33.314605 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:06:33.319674 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:06:33.321698 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m02:06:33.322584 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m02:06:33.323266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:34.115998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m02:06:34.120680 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m02:06:34.276386 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.98s]
[0m02:06:34.277299 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m02:06:34.277737 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:06:34.278117 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m02:06:34.278813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m02:06:34.279223 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:06:34.285075 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:06:34.285920 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:06:34.287859 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:06:34.288912 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m02:06:34.289325 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m02:06:34.289688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:35.238874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m02:06:35.245799 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m02:06:35.375242 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 1.10s]
[0m02:06:35.376205 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m02:06:35.376692 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:06:35.377096 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m02:06:35.377773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m02:06:35.378178 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:06:35.381750 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:06:35.382618 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:06:35.384757 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:06:35.385911 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m02:06:35.386318 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m02:06:35.386695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:36.163289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m02:06:36.166882 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m02:06:36.296499 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 0.92s]
[0m02:06:36.299991 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m02:06:36.301846 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:06:36.303316 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m02:06:36.303993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m02:06:36.304369 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:06:36.307814 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:06:36.308609 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:06:36.310528 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:06:36.311573 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m02:06:36.311984 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m02:06:36.312372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:37.133522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.821 seconds
[0m02:06:37.137207 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m02:06:37.287401 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.98s]
[0m02:06:37.288326 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m02:06:37.290313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:37.290710 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m02:06:37.291023 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m02:06:37.291389 [info ] [MainThread]: 
[0m02:06:37.291924 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 24.80 seconds (24.80s).
[0m02:06:37.296540 [debug] [MainThread]: Command end result
[0m02:06:37.326134 [info ] [MainThread]: 
[0m02:06:37.326790 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m02:06:37.327290 [info ] [MainThread]: 
[0m02:06:37.327862 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__100000 (models\schema.yml)[0m
[0m02:06:37.328458 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m02:06:37.328940 [info ] [MainThread]: 
[0m02:06:37.329472 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__100000.sql
[0m02:06:37.329927 [info ] [MainThread]: 
[0m02:06:37.330457 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__100000.sql
[0m02:06:37.330949 [info ] [MainThread]: 
[0m02:06:37.331429 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__100000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__100000.sql
[0m02:06:37.331921 [info ] [MainThread]: 
[0m02:06:37.332480 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__100000 (models\schema.yml)[0m
[0m02:06:37.333031 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m02:06:37.333492 [info ] [MainThread]: 
[0m02:06:37.334021 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__100000.sql
[0m02:06:37.334480 [info ] [MainThread]: 
[0m02:06:37.335014 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__10000000 (models\schema.yml)[0m
[0m02:06:37.335541 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:06:37.335998 [info ] [MainThread]: 
[0m02:06:37.336533 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__10000000.sql
[0m02:06:37.336998 [info ] [MainThread]: 
[0m02:06:37.337529 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__100000 (models\schema.yml)[0m
[0m02:06:37.338059 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:06:37.338521 [info ] [MainThread]: 
[0m02:06:37.339075 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__100000.sql
[0m02:06:37.339544 [info ] [MainThread]: 
[0m02:06:37.340081 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__100000 (models\schema.yml)[0m
[0m02:06:37.340611 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m02:06:37.341059 [info ] [MainThread]: 
[0m02:06:37.341595 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__100000.sql
[0m02:06:37.342060 [info ] [MainThread]: 
[0m02:06:37.342595 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m02:06:37.343111 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m02:06:37.343551 [info ] [MainThread]: 
[0m02:06:37.344063 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m02:06:37.344523 [info ] [MainThread]: 
[0m02:06:37.345069 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m02:06:37.345559 [info ] [MainThread]: 
[0m02:06:37.346101 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m02:06:37.346580 [info ] [MainThread]: 
[0m02:06:37.347111 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m02:06:37.347639 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m02:06:37.348102 [info ] [MainThread]: 
[0m02:06:37.348555 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m02:06:37.349131 [info ] [MainThread]: 
[0m02:06:37.349725 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m02:06:37.350268 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m02:06:37.350704 [info ] [MainThread]: 
[0m02:06:37.351225 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m02:06:37.351681 [info ] [MainThread]: 
[0m02:06:37.352227 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m02:06:37.352755 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m02:06:37.353213 [info ] [MainThread]: 
[0m02:06:37.353743 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m02:06:37.354222 [info ] [MainThread]: 
[0m02:06:37.354722 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m02:06:37.355824 [debug] [MainThread]: Command `dbt test` failed at 02:06:37.355706 after 26.32 seconds
[0m02:06:37.356197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF27DCFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF393E7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF3972AAF0>]}
[0m02:06:37.356539 [debug] [MainThread]: Flushing usage events
[0m03:07:42.646663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B1EAAEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B21530190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B21530050>]}


============================== 03:07:42.651969 | c834b30e-b235-493e-81bc-fd7b20d09390 ==============================
[0m03:07:42.651969 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:07:42.652946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:07:44.285038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B20881E00>]}
[0m03:07:44.337361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2079E030>]}
[0m03:07:44.338920 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:07:44.347442 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:07:44.536386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:07:44.537314 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m03:07:44.752064 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:07:44.752755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B327C6750>]}
[0m03:07:44.998693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B329F3B60>]}
[0m03:07:45.132893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B32A0D7F0>]}
[0m03:07:45.133352 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m03:07:45.133867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B32C5B860>]}
[0m03:07:45.137133 [info ] [MainThread]: 
[0m03:07:45.137972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:07:45.143015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m03:07:45.157349 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m03:07:45.157739 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m03:07:45.158029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:46.238358 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.080 seconds
[0m03:07:46.244515 [debug] [ThreadPool]: On list_DEV: Close
[0m03:07:46.377180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m03:07:46.404165 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m03:07:46.404812 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m03:07:46.405313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:07:47.182787 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.777 seconds
[0m03:07:47.184737 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m03:07:47.323062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m03:07:47.324831 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m03:07:47.325152 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m03:07:47.325444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:07:48.092527 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.767 seconds
[0m03:07:48.099674 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m03:07:48.219551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B33D65CD0>]}
[0m03:07:48.221342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:07:48.222973 [info ] [MainThread]: 
[0m03:07:48.234497 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m03:07:48.236796 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m03:07:48.240258 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m03:07:48.241499 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m03:07:48.255705 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m03:07:48.257064 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m03:07:48.290706 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m03:07:48.292264 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m03:07:48.292673 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        COALESCE(open, 0) AS open,  -- Replace NULL with 0 for open price
        COALESCE(max_value, 0) AS high,  -- Replace NULL with 0 for max price
        COALESCE(min_value, 0) AS low,  -- Replace NULL with 0 for min price
        COALESCE(close, 0) AS close,  -- Replace NULL with 0 for close price
        CASE 
            WHEN volume < 0 THEN 0  -- Ensure volume is non-negative
            WHEN volume > 10000000 THEN 10000000  -- Cap volume to a max value of 10M
            ELSE volume 
        END AS volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m03:07:48.293043 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:07:49.228807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.936 seconds
[0m03:07:49.261266 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m03:07:49.385721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B216994F0>]}
[0m03:07:49.388051 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.14s]
[0m03:07:49.390913 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m03:07:49.392909 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m03:07:49.394455 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m03:07:49.396249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m03:07:49.397087 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m03:07:49.403019 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m03:07:49.404910 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m03:07:49.428952 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m03:07:49.431312 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m03:07:49.431755 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m03:07:49.432189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:07:51.647272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.215 seconds
[0m03:07:51.654608 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m03:07:51.777203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c834b30e-b235-493e-81bc-fd7b20d09390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B33E84410>]}
[0m03:07:51.779288 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.38s]
[0m03:07:51.782007 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m03:07:51.786546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:07:51.787711 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m03:07:51.788695 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m03:07:51.789747 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m03:07:51.790892 [info ] [MainThread]: 
[0m03:07:51.792240 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m03:07:51.794829 [debug] [MainThread]: Command end result
[0m03:07:51.832474 [info ] [MainThread]: 
[0m03:07:51.833129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:07:51.833613 [info ] [MainThread]: 
[0m03:07:51.834097 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:07:51.835263 [debug] [MainThread]: Command `dbt run` succeeded at 03:07:51.835121 after 9.33 seconds
[0m03:07:51.835646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B328EE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B32C4E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B21576C80>]}
[0m03:07:51.835994 [debug] [MainThread]: Flushing usage events
[0m03:07:58.238921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D47B62A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D4A5D0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D4A5D0050>]}


============================== 03:07:58.243402 | e370499f-042e-4ece-bbd4-a30370dcaa51 ==============================
[0m03:07:58.243402 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:07:58.244390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m03:07:59.134784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e370499f-042e-4ece-bbd4-a30370dcaa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D49929E00>]}
[0m03:07:59.187828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e370499f-042e-4ece-bbd4-a30370dcaa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D4984E030>]}
[0m03:07:59.189201 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:07:59.196768 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:07:59.369673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:07:59.370024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:07:59.421886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e370499f-042e-4ece-bbd4-a30370dcaa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5B880350>]}
[0m03:07:59.555943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e370499f-042e-4ece-bbd4-a30370dcaa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BC09220>]}
[0m03:07:59.556417 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m03:07:59.556973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e370499f-042e-4ece-bbd4-a30370dcaa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BC4DFD0>]}
[0m03:07:59.559674 [info ] [MainThread]: 
[0m03:07:59.560475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:07:59.564932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m03:07:59.582901 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m03:07:59.583297 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m03:07:59.583588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:00.514028 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.930 seconds
[0m03:08:00.516450 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m03:08:00.668521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m03:08:00.678014 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m03:08:00.679413 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m03:08:00.680688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:01.538914 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.858 seconds
[0m03:08:01.540702 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m03:08:01.701657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e370499f-042e-4ece-bbd4-a30370dcaa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BC27450>]}
[0m03:08:01.702208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:08:01.702700 [info ] [MainThread]: 
[0m03:08:01.706630 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b
[0m03:08:01.707113 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__1000000 ............ [RUN]
[0m03:08:01.707870 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b'
[0m03:08:01.708256 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b
[0m03:08:01.724315 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b"
[0m03:08:01.726537 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b
[0m03:08:01.748206 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b"
[0m03:08:01.751477 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b"
[0m03:08:01.751944 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','1000000'
)



      
    ) dbt_internal_test
[0m03:08:01.752350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:08:02.725268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m03:08:02.741782 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b: Close
[0m03:08:02.877303 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__1000000 .............. [[31mFAIL 198[0m in 1.17s]
[0m03:08:02.878592 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b
[0m03:08:02.879362 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7
[0m03:08:02.880310 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__1000000 ........ [RUN]
[0m03:08:02.881562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__1000000.69e59fb35b, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7)
[0m03:08:02.882185 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7
[0m03:08:02.889867 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7"
[0m03:08:02.892267 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7
[0m03:08:02.898915 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7"
[0m03:08:02.901056 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7"
[0m03:08:02.901881 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','1000000'
)



      
    ) dbt_internal_test
[0m03:08:02.902559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:03.627488 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d3c-0004-2ced-0002-7a6f000104a6
[0m03:08:03.628476 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m03:08:03.629505 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7: Close
[0m03:08:03.756497 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__1000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__1000000.sql
[0m03:08:03.757281 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__1000000 ............. [[31mERROR[0m in 0.88s]
[0m03:08:03.758291 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7
[0m03:08:03.759014 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596
[0m03:08:03.760813 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__1000000 ........ [RUN]
[0m03:08:03.761975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__1000000.a5527b57b7, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596)
[0m03:08:03.762539 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596
[0m03:08:03.766569 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596"
[0m03:08:03.767608 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596
[0m03:08:03.769998 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596"
[0m03:08:03.771376 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596"
[0m03:08:03.772041 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','1000000'
)



      
    ) dbt_internal_test
[0m03:08:03.772430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:04.456170 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d3c-0004-2ced-0002-7a6f000104aa
[0m03:08:04.456841 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m03:08:04.457512 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596: Close
[0m03:08:04.591641 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__1000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__1000000.sql
[0m03:08:04.592605 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__1000000 ............. [[31mERROR[0m in 0.83s]
[0m03:08:04.594009 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596
[0m03:08:04.594783 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603
[0m03:08:04.595465 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__1000000 ............. [RUN]
[0m03:08:04.596744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__1000000.69a1b4e596, now test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603)
[0m03:08:04.597384 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603
[0m03:08:04.602576 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603"
[0m03:08:04.603669 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603
[0m03:08:04.605582 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603"
[0m03:08:04.606833 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603"
[0m03:08:04.607229 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','1000000'
)



      
    ) dbt_internal_test
[0m03:08:04.607587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:05.565315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m03:08:05.567411 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603: Close
[0m03:08:05.693223 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__1000000 ............... [[31mFAIL 199[0m in 1.10s]
[0m03:08:05.696466 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603
[0m03:08:05.698565 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m03:08:05.700641 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__10000000 .......... [RUN]
[0m03:08:05.702903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__1000000.eac7cd0603, now test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07)
[0m03:08:05.704432 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m03:08:05.717846 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m03:08:05.719972 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m03:08:05.723897 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m03:08:05.726512 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"
[0m03:08:05.727206 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','10000000'
)



      
    ) dbt_internal_test
[0m03:08:05.727927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:06.752486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.024 seconds
[0m03:08:06.758763 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07: Close
[0m03:08:06.876064 [error] [Thread-1 (]: 5 of 23 FAIL 1 accepted_values_raw_data_model_volume__0__10000000 .............. [[31mFAIL 1[0m in 1.17s]
[0m03:08:06.877906 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07
[0m03:08:06.878367 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d
[0m03:08:06.878873 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__1000000  [RUN]
[0m03:08:06.879539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__10000000.277fa60c07, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d)
[0m03:08:06.879959 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d
[0m03:08:06.883574 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d"
[0m03:08:06.884643 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d
[0m03:08:06.886636 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d"
[0m03:08:06.887840 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d"
[0m03:08:06.888255 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','1000000'
)



      
    ) dbt_internal_test
[0m03:08:06.888634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:07.667527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m03:08:07.669522 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d: Close
[0m03:08:07.804709 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__1000000 . [[31mFAIL 200[0m in 0.92s]
[0m03:08:07.808008 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d
[0m03:08:07.809903 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121
[0m03:08:07.811514 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__1000000  [RUN]
[0m03:08:07.812186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__1000000.38a8228e3d, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121)
[0m03:08:07.812615 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121
[0m03:08:07.816232 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121"
[0m03:08:07.817225 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121
[0m03:08:07.819706 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121"
[0m03:08:07.821710 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121"
[0m03:08:07.822167 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','1000000'
)



      
    ) dbt_internal_test
[0m03:08:07.822560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:08.534833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m03:08:08.537408 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121: Close
[0m03:08:08.656635 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__1000000 . [[31mFAIL 200[0m in 0.84s]
[0m03:08:08.658681 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121
[0m03:08:08.659763 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:08:08.660781 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m03:08:08.662273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__1000000.043d502121, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m03:08:08.663358 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:08:08.670808 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:08:08.672648 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:08:08.676349 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:08:08.678210 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:08:08.678846 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m03:08:08.679390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:09.424844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m03:08:09.428039 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m03:08:09.543411 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 0.88s]
[0m03:08:09.544819 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:08:09.545284 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:08:09.545669 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m03:08:09.546294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m03:08:09.546691 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:08:09.553492 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:08:09.554774 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:08:09.557393 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:08:09.558673 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:08:09.559058 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m03:08:09.559441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:10.325524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m03:08:10.327399 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m03:08:10.434776 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.89s]
[0m03:08:10.435762 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:08:10.436235 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:08:10.436647 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m03:08:10.437287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m03:08:10.437679 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:08:10.443288 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:08:10.445170 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:08:10.447722 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:08:10.448932 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:08:10.449374 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m03:08:10.449792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:11.178645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.728 seconds
[0m03:08:11.185454 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m03:08:11.331823 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.89s]
[0m03:08:11.332752 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:08:11.333203 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:08:11.333605 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m03:08:11.334239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m03:08:11.334646 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:08:11.338363 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:08:11.339220 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:08:11.341147 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:08:11.342236 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:08:11.342678 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m03:08:11.343059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:12.009913 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d3c-0004-2cf6-0000-00027a6fd48d
[0m03:08:12.011682 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m03:08:12.013542 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m03:08:12.152036 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m03:08:12.152885 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.82s]
[0m03:08:12.154154 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:08:12.154866 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:08:12.155474 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m03:08:12.156425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m03:08:12.157057 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:08:12.162259 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:08:12.163503 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:08:12.166468 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:08:12.168257 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:08:12.168776 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m03:08:12.169225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:12.932021 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d3c-0004-2cf3-0000-00027a6fc485
[0m03:08:12.933461 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m03:08:12.934680 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m03:08:13.073160 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m03:08:13.074090 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.92s]
[0m03:08:13.076101 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:08:13.076867 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:08:13.077575 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m03:08:13.078453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m03:08:13.079096 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:08:13.085108 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:08:13.086597 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:08:13.090101 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:08:13.092053 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:08:13.092794 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m03:08:13.093395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:14.062776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m03:08:14.064901 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m03:08:14.188905 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 1.11s]
[0m03:08:14.192143 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:08:14.193748 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:08:14.195454 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m03:08:14.197716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m03:08:14.198932 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:08:14.207409 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:08:14.209123 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:08:14.213183 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:08:14.215473 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:08:14.216193 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m03:08:14.216836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:15.040014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m03:08:15.042326 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m03:08:15.184529 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.99s]
[0m03:08:15.185644 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:08:15.186195 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:08:15.186668 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m03:08:15.187389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m03:08:15.187954 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:08:15.193253 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:08:15.194427 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:08:15.196834 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:08:15.198294 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:08:15.198786 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m03:08:15.199202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:15.984558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m03:08:15.988248 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m03:08:16.163710 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.98s]
[0m03:08:16.165898 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:08:16.167102 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:08:16.168353 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m03:08:16.170220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m03:08:16.171408 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:08:16.180238 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:08:16.181909 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:08:16.185788 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:08:16.188058 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:08:16.188749 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m03:08:16.189294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:17.204100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.015 seconds
[0m03:08:17.206497 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m03:08:17.329926 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 1.16s]
[0m03:08:17.330899 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:08:17.331382 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:08:17.331825 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m03:08:17.332512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m03:08:17.332938 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:08:17.336940 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:08:17.337912 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:08:17.340835 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:08:17.342188 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:08:17.342665 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m03:08:17.343099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:18.141604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m03:08:18.143657 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m03:08:18.256979 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 0.92s]
[0m03:08:18.259793 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:08:18.261169 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:08:18.262881 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m03:08:18.264397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m03:08:18.265291 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:08:18.272119 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:08:18.274157 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:08:18.277482 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:08:18.279053 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:08:18.279591 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m03:08:18.280108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:18.966777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.686 seconds
[0m03:08:18.971647 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m03:08:19.111656 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.85s]
[0m03:08:19.112916 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:08:19.113620 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:08:19.114255 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m03:08:19.115325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m03:08:19.115969 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:08:19.121275 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:08:19.122613 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:08:19.125232 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:08:19.126490 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:08:19.126983 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m03:08:19.127434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:20.053248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m03:08:20.061084 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m03:08:20.195969 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 1.08s]
[0m03:08:20.197792 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:08:20.198740 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:08:20.199651 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m03:08:20.200886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m03:08:20.201704 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:08:20.209383 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:08:20.211323 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:08:20.215260 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:08:20.217062 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:08:20.217754 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m03:08:20.218429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:20.975726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m03:08:20.980753 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m03:08:21.117700 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.92s]
[0m03:08:21.120509 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:08:21.121969 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:08:21.123029 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m03:08:21.124357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m03:08:21.125317 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:08:21.134268 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:08:21.135352 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:08:21.138142 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:08:21.139969 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:08:21.140462 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m03:08:21.140890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:22.057969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.917 seconds
[0m03:08:22.064990 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m03:08:22.179722 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 1.06s]
[0m03:08:22.180967 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:08:22.181626 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:08:22.182174 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m03:08:22.183081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m03:08:22.183619 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:08:22.188951 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:08:22.190292 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:08:22.192434 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:08:22.193555 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:08:22.193949 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:08:22.194302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:23.308260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.114 seconds
[0m03:08:23.314205 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m03:08:23.438249 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 1.26s]
[0m03:08:23.439140 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:08:23.439557 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:08:23.439907 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m03:08:23.440481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m03:08:23.440828 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:08:23.444989 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:08:23.446147 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:08:23.448451 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:08:23.449588 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:08:23.449971 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:08:23.450322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:24.142974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m03:08:24.149662 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m03:08:24.264595 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.82s]
[0m03:08:24.265725 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:08:24.267311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:08:24.267724 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m03:08:24.268094 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m03:08:24.268545 [info ] [MainThread]: 
[0m03:08:24.269195 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 24.71 seconds (24.71s).
[0m03:08:24.275212 [debug] [MainThread]: Command end result
[0m03:08:24.308372 [info ] [MainThread]: 
[0m03:08:24.309014 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m03:08:24.309496 [info ] [MainThread]: 
[0m03:08:24.310065 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__1000000 (models\schema.yml)[0m
[0m03:08:24.310602 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m03:08:24.311064 [info ] [MainThread]: 
[0m03:08:24.311588 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__1000000.sql
[0m03:08:24.312073 [info ] [MainThread]: 
[0m03:08:24.312616 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__1000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__1000000.sql
[0m03:08:24.313076 [info ] [MainThread]: 
[0m03:08:24.313601 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__1000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__1000000.sql
[0m03:08:24.314093 [info ] [MainThread]: 
[0m03:08:24.314620 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__1000000 (models\schema.yml)[0m
[0m03:08:24.315193 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m03:08:24.315672 [info ] [MainThread]: 
[0m03:08:24.316199 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__1000000.sql
[0m03:08:24.316643 [info ] [MainThread]: 
[0m03:08:24.317170 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__10000000 (models\schema.yml)[0m
[0m03:08:24.317713 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m03:08:24.318166 [info ] [MainThread]: 
[0m03:08:24.318671 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__10000000.sql
[0m03:08:24.319087 [info ] [MainThread]: 
[0m03:08:24.319786 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__1000000 (models\schema.yml)[0m
[0m03:08:24.320428 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m03:08:24.320881 [info ] [MainThread]: 
[0m03:08:24.321486 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__1000000.sql
[0m03:08:24.321980 [info ] [MainThread]: 
[0m03:08:24.322534 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__1000000 (models\schema.yml)[0m
[0m03:08:24.323055 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m03:08:24.323489 [info ] [MainThread]: 
[0m03:08:24.323996 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__1000000.sql
[0m03:08:24.324502 [info ] [MainThread]: 
[0m03:08:24.325045 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m03:08:24.325543 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m03:08:24.325978 [info ] [MainThread]: 
[0m03:08:24.326474 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m03:08:24.326912 [info ] [MainThread]: 
[0m03:08:24.327432 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m03:08:24.327890 [info ] [MainThread]: 
[0m03:08:24.328401 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m03:08:24.328859 [info ] [MainThread]: 
[0m03:08:24.329362 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m03:08:24.329876 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m03:08:24.330312 [info ] [MainThread]: 
[0m03:08:24.330804 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m03:08:24.331172 [info ] [MainThread]: 
[0m03:08:24.331741 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m03:08:24.332229 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:08:24.332644 [info ] [MainThread]: 
[0m03:08:24.333154 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m03:08:24.333603 [info ] [MainThread]: 
[0m03:08:24.334117 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m03:08:24.334622 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:08:24.335056 [info ] [MainThread]: 
[0m03:08:24.335516 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m03:08:24.335967 [info ] [MainThread]: 
[0m03:08:24.336483 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m03:08:24.337632 [debug] [MainThread]: Command `dbt test` failed at 03:08:24.337501 after 26.19 seconds
[0m03:08:24.338007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D4A4FBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BB6B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D5BEAEAF0>]}
[0m03:08:24.338351 [debug] [MainThread]: Flushing usage events
[0m03:13:15.173501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949053EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019492FB0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019492FB0050>]}


============================== 03:13:15.177520 | df291dd8-2e13-4056-838e-1483a7d5c575 ==============================
[0m03:13:15.177520 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:13:15.178192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:13:16.124241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019492311E00>]}
[0m03:13:16.177570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001949222E030>]}
[0m03:13:16.179010 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:13:16.187353 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:13:16.347199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:13:16.348162 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m03:13:16.578869 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:13:16.579600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A42D6250>]}
[0m03:13:16.829233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A42BFD40>]}
[0m03:13:16.954733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A46F3CB0>]}
[0m03:13:16.955211 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m03:13:16.955806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A573B860>]}
[0m03:13:16.958015 [info ] [MainThread]: 
[0m03:13:16.958917 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:13:16.963230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m03:13:16.977254 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m03:13:16.977646 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m03:13:16.977944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:17.910748 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.933 seconds
[0m03:13:17.914197 [debug] [ThreadPool]: On list_DEV: Close
[0m03:13:18.029920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m03:13:18.060542 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m03:13:18.061093 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m03:13:18.061517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:18.874123 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.812 seconds
[0m03:13:18.880523 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m03:13:19.024068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m03:13:19.026893 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m03:13:19.027368 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m03:13:19.027732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:19.760262 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.732 seconds
[0m03:13:19.766628 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m03:13:19.908605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A5875CD0>]}
[0m03:13:19.910666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:19.912538 [info ] [MainThread]: 
[0m03:13:19.924103 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m03:13:19.926611 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m03:13:19.929159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m03:13:19.930284 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m03:13:19.946127 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m03:13:19.947376 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m03:13:19.978128 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m03:13:19.979641 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m03:13:19.980093 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        COALESCE(open, 0) AS open,  -- Replace NULL with 0 for open price
        COALESCE(max_value, 0) AS high,  -- Replace NULL with 0 for max price
        COALESCE(min_value, 0) AS low,  -- Replace NULL with 0 for min price
        COALESCE(close, 0) AS close,  -- Replace NULL with 0 for close price
        CASE 
            WHEN volume < 0 THEN 0  -- Ensure volume is non-negative
            WHEN volume > 10000000 THEN 10000000  -- Cap volume to a max value of 10M
            ELSE volume 
        END AS volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m03:13:19.980601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:13:20.881776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m03:13:20.923398 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m03:13:21.048331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194931194F0>]}
[0m03:13:21.050806 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.12s]
[0m03:13:21.054129 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m03:13:21.056152 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m03:13:21.057550 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m03:13:21.058563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m03:13:21.059014 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m03:13:21.062058 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m03:13:21.062926 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m03:13:21.083090 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m03:13:21.085743 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m03:13:21.086336 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m03:13:21.086832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:22.925772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.839 seconds
[0m03:13:22.928371 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m03:13:23.058287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df291dd8-2e13-4056-838e-1483a7d5c575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A5998690>]}
[0m03:13:23.059043 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.00s]
[0m03:13:23.059973 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m03:13:23.061897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:23.062601 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m03:13:23.063105 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m03:13:23.063523 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m03:13:23.064142 [info ] [MainThread]: 
[0m03:13:23.065102 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m03:13:23.066899 [debug] [MainThread]: Command end result
[0m03:13:23.116162 [info ] [MainThread]: 
[0m03:13:23.117445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:13:23.118380 [info ] [MainThread]: 
[0m03:13:23.119658 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:13:23.122285 [debug] [MainThread]: Command `dbt run` succeeded at 03:13:23.122034 after 8.09 seconds
[0m03:13:23.123463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194922AD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194A46CE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019492FF6C80>]}
[0m03:13:23.124477 [debug] [MainThread]: Flushing usage events
[0m03:13:28.172440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967012EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019672BA0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019672BA0050>]}


============================== 03:13:28.176334 | 792216b0-b362-4125-af74-3e414bd84a71 ==============================
[0m03:13:28.176334 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:13:28.177037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:13:29.036016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '792216b0-b362-4125-af74-3e414bd84a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019603EB9E00>]}
[0m03:13:29.088258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '792216b0-b362-4125-af74-3e414bd84a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019603DDE030>]}
[0m03:13:29.089592 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:13:29.097139 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:13:29.274638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:13:29.274999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:13:29.331372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '792216b0-b362-4125-af74-3e414bd84a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019603F90350>]}
[0m03:13:29.467013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '792216b0-b362-4125-af74-3e414bd84a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019604319220>]}
[0m03:13:29.467517 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m03:13:29.468073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792216b0-b362-4125-af74-3e414bd84a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960435DFD0>]}
[0m03:13:29.471365 [info ] [MainThread]: 
[0m03:13:29.472192 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:13:29.476491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m03:13:29.493573 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m03:13:29.494036 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m03:13:29.494321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:30.417448 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.923 seconds
[0m03:13:30.419501 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m03:13:30.555279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m03:13:30.559781 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m03:13:30.560198 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m03:13:30.560519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:31.298621 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.738 seconds
[0m03:13:31.303838 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m03:13:31.449221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '792216b0-b362-4125-af74-3e414bd84a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019604333450>]}
[0m03:13:31.450520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:31.451634 [info ] [MainThread]: 
[0m03:13:31.459131 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:13:31.460148 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__5000000 ............ [RUN]
[0m03:13:31.461506 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa'
[0m03:13:31.461865 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:13:31.476792 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"
[0m03:13:31.477830 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:13:31.498874 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"
[0m03:13:31.500409 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"
[0m03:13:31.500892 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:13:31.501275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:13:32.256006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.754 seconds
[0m03:13:32.273179 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa: Close
[0m03:13:32.399940 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__5000000 .............. [[31mFAIL 198[0m in 0.94s]
[0m03:13:32.403422 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:13:32.405214 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:13:32.407227 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__5000000 ........ [RUN]
[0m03:13:32.409581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f)
[0m03:13:32.410982 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:13:32.420580 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"
[0m03:13:32.422214 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:13:32.428172 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"
[0m03:13:32.430383 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"
[0m03:13:32.430949 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:13:32.431461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:33.280470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d41-0004-2ce7-0000-00027a6ff495
[0m03:13:33.280940 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m03:13:33.281416 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f: Close
[0m03:13:33.422343 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__5000000.sql
[0m03:13:33.422924 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__5000000 ............. [[31mERROR[0m in 1.01s]
[0m03:13:33.423754 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:13:33.424196 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:13:33.424574 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__5000000 ........ [RUN]
[0m03:13:33.426095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c)
[0m03:13:33.426692 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:13:33.432051 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"
[0m03:13:33.433531 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:13:33.436098 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"
[0m03:13:33.437467 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"
[0m03:13:33.437909 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:13:33.438409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:34.222593 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d41-0004-2ceb-0002-7a6f00014486
[0m03:13:34.223179 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m03:13:34.223826 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c: Close
[0m03:13:34.400520 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__5000000.sql
[0m03:13:34.401662 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__5000000 ............. [[31mERROR[0m in 0.98s]
[0m03:13:34.403409 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:13:34.404405 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:13:34.405116 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__5000000 ............. [RUN]
[0m03:13:34.406230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c, now test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db)
[0m03:13:34.406950 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:13:34.412472 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"
[0m03:13:34.414025 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:13:34.417377 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"
[0m03:13:34.419648 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"
[0m03:13:34.420343 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:13:34.420986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:35.156202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m03:13:35.158062 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db: Close
[0m03:13:35.291788 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__5000000 ............... [[31mFAIL 199[0m in 0.89s]
[0m03:13:35.295155 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:13:35.298189 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:13:35.300583 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__1000000000 ........ [RUN]
[0m03:13:35.303069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db, now test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284)
[0m03:13:35.304793 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:13:35.313453 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"
[0m03:13:35.315958 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:13:35.319827 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"
[0m03:13:35.322177 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"
[0m03:13:35.322826 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','1000000000'
)



      
    ) dbt_internal_test
[0m03:13:35.323411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:35.974043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m03:13:35.981229 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284: Close
[0m03:13:36.101216 [error] [Thread-1 (]: 5 of 23 FAIL 2 accepted_values_raw_data_model_volume__0__1000000000 ............ [[31mFAIL 2[0m in 0.80s]
[0m03:13:36.102828 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:13:36.103670 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:13:36.104424 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__5000000  [RUN]
[0m03:13:36.105570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86)
[0m03:13:36.106354 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:13:36.113153 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"
[0m03:13:36.115065 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:13:36.119110 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"
[0m03:13:36.121255 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"
[0m03:13:36.121975 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:13:36.122607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:36.912025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m03:13:36.914172 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86: Close
[0m03:13:37.053850 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__5000000 . [[31mFAIL 200[0m in 0.95s]
[0m03:13:37.055107 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:13:37.055566 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:13:37.055960 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__5000000  [RUN]
[0m03:13:37.056580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7)
[0m03:13:37.057000 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:13:37.060758 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"
[0m03:13:37.061833 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:13:37.063998 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"
[0m03:13:37.065393 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"
[0m03:13:37.065853 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:13:37.066254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:37.899250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m03:13:37.906764 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7: Close
[0m03:13:38.039355 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__5000000 . [[31mFAIL 200[0m in 0.98s]
[0m03:13:38.042959 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:13:38.044902 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:13:38.046363 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m03:13:38.048217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m03:13:38.049383 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:13:38.056695 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:13:38.058780 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:13:38.063431 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:13:38.065710 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:13:38.066325 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m03:13:38.066830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:38.849820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m03:13:38.856662 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m03:13:38.995847 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 0.95s]
[0m03:13:38.996799 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:13:38.997309 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:13:38.997720 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m03:13:38.998381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m03:13:38.998792 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:13:39.005112 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:13:39.006330 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:13:39.008702 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:13:39.009890 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:13:39.010293 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m03:13:39.010666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:39.813340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m03:13:39.820521 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m03:13:39.947730 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.95s]
[0m03:13:39.951206 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:13:39.953127 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:13:39.954934 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m03:13:39.956588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m03:13:39.957679 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:13:39.966213 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:13:39.967613 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:13:39.970767 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:13:39.972201 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:13:39.972809 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m03:13:39.973383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:40.830123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m03:13:40.832377 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m03:13:40.940174 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.98s]
[0m03:13:40.943483 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:13:40.945373 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:13:40.947230 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m03:13:40.949423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m03:13:40.950496 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:13:40.958689 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:13:40.960198 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:13:40.963717 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:13:40.965379 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:13:40.965987 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m03:13:40.966546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:41.768726 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d41-0004-2cec-0002-7a6f00016afe
[0m03:13:41.769885 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m03:13:41.771108 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m03:13:41.909350 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m03:13:41.909867 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.96s]
[0m03:13:41.910687 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:13:41.911198 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:13:41.911571 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m03:13:41.912195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m03:13:41.912559 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:13:41.915895 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:13:41.916645 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:13:41.918473 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:13:41.919440 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:13:41.919816 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m03:13:41.920169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:42.767568 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d41-0004-2cee-0002-7a6f0001709a
[0m03:13:42.769295 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m03:13:42.771083 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m03:13:42.902984 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m03:13:42.903511 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.99s]
[0m03:13:42.904330 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:13:42.904751 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:13:42.905125 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m03:13:42.905737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m03:13:42.906098 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:13:42.909785 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:13:42.910715 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:13:42.912704 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:13:42.913792 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:13:42.914176 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m03:13:42.914537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:43.674330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m03:13:43.678184 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m03:13:43.843758 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.94s]
[0m03:13:43.847004 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:13:43.848882 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:13:43.850749 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m03:13:43.853043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m03:13:43.854584 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:13:43.864754 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:13:43.866454 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:13:43.870269 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:13:43.872022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:13:43.872667 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m03:13:43.873222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:44.596612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m03:13:44.599815 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m03:13:44.714143 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.86s]
[0m03:13:44.715018 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:13:44.715428 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:13:44.715792 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m03:13:44.716364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m03:13:44.716725 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:13:44.720084 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:13:44.720863 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:13:44.722715 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:13:44.723712 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:13:44.724090 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m03:13:44.724446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:45.405252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m03:13:45.412343 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m03:13:45.534069 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.82s]
[0m03:13:45.535022 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:13:45.535471 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:13:45.535866 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m03:13:45.536473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m03:13:45.536874 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:13:45.540453 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:13:45.541307 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:13:45.543523 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:13:45.544667 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:13:45.545083 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m03:13:45.545471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:46.313013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m03:13:46.315756 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m03:13:46.458833 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 0.92s]
[0m03:13:46.461963 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:13:46.463863 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:13:46.465899 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m03:13:46.467933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m03:13:46.469219 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:13:46.475299 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:13:46.476231 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:13:46.478504 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:13:46.479889 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:13:46.480315 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m03:13:46.480693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:47.295995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.815 seconds
[0m03:13:47.299676 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m03:13:47.437399 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 0.97s]
[0m03:13:47.440628 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:13:47.442608 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:13:47.444564 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m03:13:47.446798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m03:13:47.448167 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:13:47.456841 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:13:47.458412 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:13:47.462846 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:13:47.464470 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:13:47.465067 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m03:13:47.465634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:48.173016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m03:13:48.179962 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m03:13:48.295048 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.85s]
[0m03:13:48.298271 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:13:48.300118 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:13:48.302112 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m03:13:48.304395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m03:13:48.305996 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:13:48.315318 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:13:48.317053 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:13:48.321538 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:13:48.323274 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:13:48.323874 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m03:13:48.324965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:49.030145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m03:13:49.036864 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m03:13:49.155998 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 0.85s]
[0m03:13:49.157672 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:13:49.158530 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:13:49.159299 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m03:13:49.160330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m03:13:49.161068 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:13:49.167590 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:13:49.168845 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:13:49.172018 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:13:49.173610 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:13:49.174327 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m03:13:49.174898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:49.979399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m03:13:49.986245 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m03:13:50.102509 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 0.94s]
[0m03:13:50.103930 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:13:50.104660 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:13:50.105307 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m03:13:50.106232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m03:13:50.106884 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:13:50.116948 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:13:50.118415 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:13:50.121218 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:13:50.122641 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:13:50.123181 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:50.123716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:50.846732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m03:13:50.851214 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m03:13:50.993939 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 0.89s]
[0m03:13:50.995059 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:13:50.995505 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:13:50.995868 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m03:13:50.996462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m03:13:50.996815 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:13:51.000115 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:13:51.000845 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:13:51.002673 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:13:51.003633 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:13:51.004010 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:51.004518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:51.755827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m03:13:51.762130 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m03:13:51.921227 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 0.92s]
[0m03:13:51.922219 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:13:51.922687 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:13:51.923102 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m03:13:51.923807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m03:13:51.924227 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:13:51.928003 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:13:51.928850 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:13:51.930753 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:13:51.931794 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:13:51.932155 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:51.932498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:52.710962 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m03:13:52.713481 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m03:13:52.827565 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.90s]
[0m03:13:52.829932 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:13:52.833489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:52.834503 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m03:13:52.835438 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m03:13:52.836451 [info ] [MainThread]: 
[0m03:13:52.837819 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 23.36 seconds (23.36s).
[0m03:13:52.846603 [debug] [MainThread]: Command end result
[0m03:13:52.876027 [info ] [MainThread]: 
[0m03:13:52.876767 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m03:13:52.877262 [info ] [MainThread]: 
[0m03:13:52.877834 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__5000000 (models\schema.yml)[0m
[0m03:13:52.878368 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m03:13:52.878823 [info ] [MainThread]: 
[0m03:13:52.879352 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__5000000.sql
[0m03:13:52.879829 [info ] [MainThread]: 
[0m03:13:52.880382 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__5000000.sql
[0m03:13:52.880868 [info ] [MainThread]: 
[0m03:13:52.881418 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__5000000.sql
[0m03:13:52.881907 [info ] [MainThread]: 
[0m03:13:52.882395 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__5000000 (models\schema.yml)[0m
[0m03:13:52.882876 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m03:13:52.883353 [info ] [MainThread]: 
[0m03:13:52.883884 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__5000000.sql
[0m03:13:52.884358 [info ] [MainThread]: 
[0m03:13:52.884907 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__1000000000 (models\schema.yml)[0m
[0m03:13:52.885430 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:13:52.885907 [info ] [MainThread]: 
[0m03:13:52.886435 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__1000000000.sql
[0m03:13:52.886883 [info ] [MainThread]: 
[0m03:13:52.887408 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__5000000 (models\schema.yml)[0m
[0m03:13:52.887920 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m03:13:52.888378 [info ] [MainThread]: 
[0m03:13:52.888893 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__5000000.sql
[0m03:13:52.889339 [info ] [MainThread]: 
[0m03:13:52.889802 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__5000000 (models\schema.yml)[0m
[0m03:13:52.890359 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m03:13:52.890820 [info ] [MainThread]: 
[0m03:13:52.891343 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__5000000.sql
[0m03:13:52.891815 [info ] [MainThread]: 
[0m03:13:52.892405 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m03:13:52.892931 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m03:13:52.893348 [info ] [MainThread]: 
[0m03:13:52.893901 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m03:13:52.894362 [info ] [MainThread]: 
[0m03:13:52.894907 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m03:13:52.895337 [info ] [MainThread]: 
[0m03:13:52.895875 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m03:13:52.896290 [info ] [MainThread]: 
[0m03:13:52.896830 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m03:13:52.897350 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m03:13:52.897811 [info ] [MainThread]: 
[0m03:13:52.898331 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m03:13:52.898769 [info ] [MainThread]: 
[0m03:13:52.899260 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m03:13:52.899854 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:13:52.900293 [info ] [MainThread]: 
[0m03:13:52.900809 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m03:13:52.901250 [info ] [MainThread]: 
[0m03:13:52.901763 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m03:13:52.902260 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:13:52.902706 [info ] [MainThread]: 
[0m03:13:52.903229 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m03:13:52.903704 [info ] [MainThread]: 
[0m03:13:52.904196 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m03:13:52.905238 [debug] [MainThread]: Command `dbt test` failed at 03:13:52.905122 after 24.83 seconds
[0m03:13:52.905605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019672ACBB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001960427B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196045BF120>]}
[0m03:13:52.905967 [debug] [MainThread]: Flushing usage events
[0m03:24:38.928069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B09BBEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B0C630190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B0C630050>]}


============================== 03:24:38.933630 | 3440cef8-5f23-48de-9589-0e158b6b9d4b ==============================
[0m03:24:38.933630 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:24:38.934973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m03:24:38.966299 [info ] [MainThread]: dbt version: 1.8.8
[0m03:24:38.966904 [info ] [MainThread]: python version: 3.13.0
[0m03:24:38.967426 [info ] [MainThread]: python path: C:\Users\mtann\AppData\Local\Programs\Python\Python313\python.exe
[0m03:24:38.967966 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m03:24:40.138741 [info ] [MainThread]: Using profiles dir at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt
[0m03:24:40.139286 [info ] [MainThread]: Using profiles.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\profiles.yml
[0m03:24:40.139677 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\dbt_project.yml
[0m03:24:40.140944 [info ] [MainThread]: adapter type: snowflake
[0m03:24:40.141393 [info ] [MainThread]: adapter version: 1.8.4
[0m03:24:40.224269 [info ] [MainThread]: Configuration:
[0m03:24:40.224827 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:24:40.225253 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:24:40.225741 [info ] [MainThread]: Required dependencies:
[0m03:24:40.226187 [debug] [MainThread]: Executing "git --help"
[0m03:24:40.287061 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:24:40.287541 [debug] [MainThread]: STDERR: "b''"
[0m03:24:40.287911 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:24:40.288350 [info ] [MainThread]: Connection:
[0m03:24:40.288856 [info ] [MainThread]:   account: mzuubyx-ctb21060
[0m03:24:40.289226 [info ] [MainThread]:   user: Mansi06
[0m03:24:40.289634 [info ] [MainThread]:   database: DEV
[0m03:24:40.290027 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m03:24:40.290413 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m03:24:40.290797 [info ] [MainThread]:   schema: raw_data
[0m03:24:40.291181 [info ] [MainThread]:   authenticator: None
[0m03:24:40.291566 [info ] [MainThread]:   oauth_client_id: None
[0m03:24:40.291951 [info ] [MainThread]:   query_tag: None
[0m03:24:40.292366 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:24:40.292772 [info ] [MainThread]:   host: None
[0m03:24:40.293165 [info ] [MainThread]:   port: None
[0m03:24:40.293568 [info ] [MainThread]:   proxy_host: None
[0m03:24:40.293975 [info ] [MainThread]:   proxy_port: None
[0m03:24:40.294391 [info ] [MainThread]:   protocol: None
[0m03:24:40.294805 [info ] [MainThread]:   connect_retries: 1
[0m03:24:40.295221 [info ] [MainThread]:   connect_timeout: None
[0m03:24:40.295628 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:24:40.296039 [info ] [MainThread]:   retry_all: False
[0m03:24:40.296429 [info ] [MainThread]:   insecure_mode: False
[0m03:24:40.296849 [info ] [MainThread]:   reuse_connections: None
[0m03:24:40.297467 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:24:40.298045 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:24:40.298650 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:24:40.298946 [debug] [MainThread]: On debug: select 1 as id
[0m03:24:40.299222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:24:41.228181 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.929 seconds
[0m03:24:41.232115 [debug] [MainThread]: On debug: Close
[0m03:24:41.362423 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:24:41.364567 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:24:41.368513 [debug] [MainThread]: Command `dbt debug` succeeded at 03:24:41.368337 after 2.54 seconds
[0m03:24:41.368881 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:24:41.369231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B1D8F8180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B1D8BE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011B0B958AF0>]}
[0m03:24:41.369643 [debug] [MainThread]: Flushing usage events
[0m03:27:26.179043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB96ED2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99950190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99950050>]}


============================== 03:27:26.182967 | 623db7cc-9afa-4652-9ac6-e4662183182b ==============================
[0m03:27:26.182967 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:27:26.183567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:27:27.214179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB98CA1E00>]}
[0m03:27:27.266501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB98BBE030>]}
[0m03:27:27.267964 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:27:27.275591 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:27:27.445362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:27:27.446213 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m03:27:27.652712 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:27:27.653312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAC0A650>]}
[0m03:27:27.863901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAABF3F20>]}
[0m03:27:27.987493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAC06350>]}
[0m03:27:27.987954 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m03:27:27.988473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAE9ED00>]}
[0m03:27:27.991374 [info ] [MainThread]: 
[0m03:27:27.992322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:27:27.996586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m03:27:28.010025 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m03:27:28.010419 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m03:27:28.010711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:28.876605 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.866 seconds
[0m03:27:28.882450 [debug] [ThreadPool]: On list_DEV: Close
[0m03:27:29.028729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m03:27:29.043069 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m03:27:29.043712 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m03:27:29.044148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:29.793582 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.749 seconds
[0m03:27:29.799927 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m03:27:29.948781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m03:27:29.950581 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m03:27:29.950919 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m03:27:29.951226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:30.739440 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.788 seconds
[0m03:27:30.745902 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m03:27:30.873830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAEACB90>]}
[0m03:27:30.874838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:30.875701 [info ] [MainThread]: 
[0m03:27:30.882706 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m03:27:30.883733 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m03:27:30.885065 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m03:27:30.885756 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m03:27:30.896821 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m03:27:30.898073 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m03:27:30.928758 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m03:27:30.930167 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m03:27:30.930584 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- models/raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        COALESCE(open, 0) AS open,  -- Replace NULL with 0 for open price
        COALESCE(max_value, 0) AS high,  -- Replace NULL with 0 for max price
        COALESCE(min_value, 0) AS low,  -- Replace NULL with 0 for min price
        COALESCE(close, 0) AS close,  -- Replace NULL with 0 for close price
        CASE 
            WHEN volume < 0 THEN 0  -- Ensure volume is non-negative
            WHEN volume > 10000000 THEN 10000000  -- Cap volume to a max value of 10M
            ELSE volume 
        END AS volume
    FROM 
        dev.raw_data.stock_data  -- This assumes your source data is defined in your `schema.yml` file
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m03:27:30.930978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:27:31.833185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m03:27:31.871100 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m03:27:32.015264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC296DB0>]}
[0m03:27:32.016591 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.13s]
[0m03:27:32.018273 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m03:27:32.019861 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m03:27:32.021412 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m03:27:32.023001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m03:27:32.023853 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m03:27:32.029594 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m03:27:32.031057 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m03:27:32.055822 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m03:27:32.058596 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m03:27:32.059101 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m03:27:32.059594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:33.588109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.528 seconds
[0m03:27:33.596407 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m03:27:33.712080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '623db7cc-9afa-4652-9ac6-e4662183182b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAC248F50>]}
[0m03:27:33.713249 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 1.69s]
[0m03:27:33.714943 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m03:27:33.717807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:33.718422 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m03:27:33.718911 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m03:27:33.719354 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m03:27:33.720147 [info ] [MainThread]: 
[0m03:27:33.721332 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m03:27:33.724559 [debug] [MainThread]: Command end result
[0m03:27:33.780523 [info ] [MainThread]: 
[0m03:27:33.782804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:33.784191 [info ] [MainThread]: 
[0m03:27:33.785673 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:27:33.788119 [debug] [MainThread]: Command `dbt run` succeeded at 03:27:33.787890 after 7.74 seconds
[0m03:27:33.789544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAD47950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBAAF7FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB99996C80>]}
[0m03:27:33.791552 [debug] [MainThread]: Flushing usage events
[0m03:27:39.035135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A1412A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A3E90190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A3E90050>]}


============================== 03:27:39.038968 | 15ceac3b-94c2-4886-98a6-5c75e537fc06 ==============================
[0m03:27:39.038968 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:27:39.039584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m03:27:39.057822 [info ] [MainThread]: dbt version: 1.8.8
[0m03:27:39.058418 [info ] [MainThread]: python version: 3.13.0
[0m03:27:39.058818 [info ] [MainThread]: python path: C:\Users\mtann\AppData\Local\Programs\Python\Python313\python.exe
[0m03:27:39.059263 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m03:27:39.858784 [info ] [MainThread]: Using profiles dir at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt
[0m03:27:39.859383 [info ] [MainThread]: Using profiles.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\profiles.yml
[0m03:27:39.859869 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\mtann\sjsu-data226-main\week8\airflow\dbt\dbt_project.yml
[0m03:27:39.861089 [info ] [MainThread]: adapter type: snowflake
[0m03:27:39.861585 [info ] [MainThread]: adapter version: 1.8.4
[0m03:27:39.945132 [info ] [MainThread]: Configuration:
[0m03:27:39.945715 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:27:39.946185 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:27:39.946657 [info ] [MainThread]: Required dependencies:
[0m03:27:39.947142 [debug] [MainThread]: Executing "git --help"
[0m03:27:39.977303 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:27:39.977785 [debug] [MainThread]: STDERR: "b''"
[0m03:27:39.978140 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:27:39.978634 [info ] [MainThread]: Connection:
[0m03:27:39.979116 [info ] [MainThread]:   account: mzuubyx-ctb21060
[0m03:27:39.979576 [info ] [MainThread]:   user: Mansi06
[0m03:27:39.980038 [info ] [MainThread]:   database: DEV
[0m03:27:39.980507 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m03:27:39.980964 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m03:27:39.981449 [info ] [MainThread]:   schema: raw_data
[0m03:27:39.981917 [info ] [MainThread]:   authenticator: None
[0m03:27:39.982404 [info ] [MainThread]:   oauth_client_id: None
[0m03:27:39.982958 [info ] [MainThread]:   query_tag: None
[0m03:27:39.983421 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:27:39.983882 [info ] [MainThread]:   host: None
[0m03:27:39.984341 [info ] [MainThread]:   port: None
[0m03:27:39.984808 [info ] [MainThread]:   proxy_host: None
[0m03:27:39.985276 [info ] [MainThread]:   proxy_port: None
[0m03:27:39.985701 [info ] [MainThread]:   protocol: None
[0m03:27:39.986139 [info ] [MainThread]:   connect_retries: 1
[0m03:27:39.986623 [info ] [MainThread]:   connect_timeout: None
[0m03:27:39.987023 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:27:39.987479 [info ] [MainThread]:   retry_all: False
[0m03:27:39.988004 [info ] [MainThread]:   insecure_mode: False
[0m03:27:39.988460 [info ] [MainThread]:   reuse_connections: None
[0m03:27:39.989131 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:27:39.989758 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:27:39.990384 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:27:39.990694 [debug] [MainThread]: On debug: select 1 as id
[0m03:27:39.990975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:27:40.860568 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.869 seconds
[0m03:27:40.864195 [debug] [MainThread]: On debug: Close
[0m03:27:41.006117 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:27:41.006958 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:27:41.008722 [debug] [MainThread]: Command `dbt debug` succeeded at 03:27:41.008463 after 2.07 seconds
[0m03:27:41.009296 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:27:41.009898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B5138180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192B5102210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A3198AF0>]}
[0m03:27:41.010497 [debug] [MainThread]: Flushing usage events
[0m03:27:48.630938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041C7AEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041F230190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041F230050>]}


============================== 03:27:48.634862 | 79e95b20-10b6-43f9-a685-75d41285d0cf ==============================
[0m03:27:48.634862 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:27:48.635523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:27:49.535255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79e95b20-10b6-43f9-a685-75d41285d0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041E581E00>]}
[0m03:27:49.586806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79e95b20-10b6-43f9-a685-75d41285d0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041E49E030>]}
[0m03:27:49.588205 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:27:49.596304 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:27:49.764221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:27:49.764609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:27:49.816941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79e95b20-10b6-43f9-a685-75d41285d0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020430524350>]}
[0m03:27:49.949596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79e95b20-10b6-43f9-a685-75d41285d0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204308A9220>]}
[0m03:27:49.950066 [info ] [MainThread]: Found 1 snapshot, 2 models, 23 data tests, 1 source, 454 macros
[0m03:27:49.950556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79e95b20-10b6-43f9-a685-75d41285d0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204308F1E10>]}
[0m03:27:49.953346 [info ] [MainThread]: 
[0m03:27:49.954225 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:27:49.958518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m03:27:49.976018 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m03:27:49.976422 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m03:27:49.976771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:50.932034 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.955 seconds
[0m03:27:50.933822 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m03:27:51.074014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m03:27:51.078000 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m03:27:51.078515 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m03:27:51.078978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:51.844838 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.766 seconds
[0m03:27:51.851371 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m03:27:51.991745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79e95b20-10b6-43f9-a685-75d41285d0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204308C7450>]}
[0m03:27:51.992282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:51.992810 [info ] [MainThread]: 
[0m03:27:51.996568 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:27:51.997111 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_raw_data_model_close__0__5000000 ............ [RUN]
[0m03:27:51.997920 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa'
[0m03:27:51.998324 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:27:52.013535 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"
[0m03:27:52.015046 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:27:52.035412 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"
[0m03:27:52.036917 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"
[0m03:27:52.037339 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        close as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by close

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:27:52.037725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:27:52.857855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m03:27:52.867112 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa: Close
[0m03:27:53.005847 [error] [Thread-1 (]: 1 of 23 FAIL 198 accepted_values_raw_data_model_close__0__5000000 .............. [[31mFAIL 198[0m in 1.01s]
[0m03:27:53.007374 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa
[0m03:27:53.007961 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:27:53.008485 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_raw_data_model_max_value__0__5000000 ........ [RUN]
[0m03:27:53.009103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_close__0__5000000.949996b5fa, now test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f)
[0m03:27:53.009522 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:27:53.012832 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"
[0m03:27:53.013877 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:27:53.016596 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"
[0m03:27:53.017816 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"
[0m03:27:53.018228 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        max_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by max_value

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:27:53.018615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:53.791381 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d4f-0004-2cf4-0002-7a6f00015456
[0m03:27:53.792010 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MAX_VALUE'
[0m03:27:53.792653 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f: Close
[0m03:27:53.939506 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_max_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__5000000.sql
[0m03:27:53.941389 [error] [Thread-1 (]: 2 of 23 ERROR accepted_values_raw_data_model_max_value__0__5000000 ............. [[31mERROR[0m in 0.93s]
[0m03:27:53.944194 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f
[0m03:27:53.945968 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:27:53.949834 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_raw_data_model_min_value__0__5000000 ........ [RUN]
[0m03:27:53.951938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_max_value__0__5000000.e580558a5f, now test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c)
[0m03:27:53.953326 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:27:53.970096 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"
[0m03:27:53.974676 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:27:53.985026 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"
[0m03:27:53.989093 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"
[0m03:27:53.990125 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        min_value as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by min_value

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:27:53.990968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:54.645763 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d4f-0004-2cf4-0002-7a6f0001545a
[0m03:27:54.646218 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'MIN_VALUE'
[0m03:27:54.646679 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c: Close
[0m03:27:54.794492 [debug] [Thread-1 (]: Database Error in test accepted_values_raw_data_model_min_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__5000000.sql
[0m03:27:54.795699 [error] [Thread-1 (]: 3 of 23 ERROR accepted_values_raw_data_model_min_value__0__5000000 ............. [[31mERROR[0m in 0.84s]
[0m03:27:54.797348 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c
[0m03:27:54.798210 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:27:54.798968 [info ] [Thread-1 (]: 4 of 23 START test accepted_values_raw_data_model_open__0__5000000 ............. [RUN]
[0m03:27:54.800067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_min_value__0__5000000.dc66e11b3c, now test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db)
[0m03:27:54.800790 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:27:54.806221 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"
[0m03:27:54.807392 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:27:54.810304 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"
[0m03:27:54.811906 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"
[0m03:27:54.812386 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        open as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by open

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:27:54.812840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:55.579648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m03:27:55.586724 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db: Close
[0m03:27:55.730074 [error] [Thread-1 (]: 4 of 23 FAIL 199 accepted_values_raw_data_model_open__0__5000000 ............... [[31mFAIL 199[0m in 0.93s]
[0m03:27:55.731031 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db
[0m03:27:55.731579 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:27:55.732008 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_raw_data_model_volume__0__1000000000 ........ [RUN]
[0m03:27:55.732760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_open__0__5000000.373bf049db, now test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284)
[0m03:27:55.733170 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:27:55.736847 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"
[0m03:27:55.737843 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:27:55.739986 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"
[0m03:27:55.741258 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"
[0m03:27:55.741686 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        volume as value_field,
        count(*) as n_records

    from DEV.raw_data.raw_data_model
    group by volume

)

select *
from all_values
where value_field not in (
    '0','1000000000'
)



      
    ) dbt_internal_test
[0m03:27:55.742077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:56.500918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m03:27:56.502713 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284: Close
[0m03:27:56.620119 [error] [Thread-1 (]: 5 of 23 FAIL 2 accepted_values_raw_data_model_volume__0__1000000000 ............ [[31mFAIL 2[0m in 0.89s]
[0m03:27:56.623244 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284
[0m03:27:56.625104 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:27:56.626943 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_transformations_moving_average_20__0__5000000  [RUN]
[0m03:27:56.629101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_raw_data_model_volume__0__1000000000.3158105284, now test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86)
[0m03:27:56.631060 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:27:56.638785 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"
[0m03:27:56.640439 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:27:56.643978 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"
[0m03:27:56.646429 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"
[0m03:27:56.647197 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_20 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_20

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:27:56.647703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:57.577717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m03:27:57.579643 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86: Close
[0m03:27:57.695411 [error] [Thread-1 (]: 6 of 23 FAIL 200 accepted_values_transformations_moving_average_20__0__5000000 . [[31mFAIL 200[0m in 1.07s]
[0m03:27:57.696313 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86
[0m03:27:57.696967 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:27:57.697380 [info ] [Thread-1 (]: 7 of 23 START test accepted_values_transformations_moving_average_50__0__5000000  [RUN]
[0m03:27:57.698278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_20__0__5000000.69a66fbb86, now test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7)
[0m03:27:57.698714 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:27:57.702557 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"
[0m03:27:57.703756 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:27:57.706255 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"
[0m03:27:57.708398 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"
[0m03:27:57.709073 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        moving_average_50 as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by moving_average_50

)

select *
from all_values
where value_field not in (
    '0','5000000'
)



      
    ) dbt_internal_test
[0m03:27:57.709631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:58.465156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m03:27:58.468597 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7: Close
[0m03:27:58.598903 [error] [Thread-1 (]: 7 of 23 FAIL 200 accepted_values_transformations_moving_average_50__0__5000000 . [[31mFAIL 200[0m in 0.90s]
[0m03:27:58.600325 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7
[0m03:27:58.600783 [debug] [Thread-1 (]: Began running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:27:58.601189 [info ] [Thread-1 (]: 8 of 23 START test accepted_values_transformations_rsi__0__100 ................. [RUN]
[0m03:27:58.601822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_moving_average_50__0__5000000.35e93d22f7, now test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4)
[0m03:27:58.602226 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:27:58.606052 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:27:58.607002 [debug] [Thread-1 (]: Began executing node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:27:58.609053 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:27:58.610263 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"
[0m03:27:58.610726 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rsi as value_field,
        count(*) as n_records

    from DEV.raw_data.transformations
    group by rsi

)

select *
from all_values
where value_field not in (
    '0','100'
)



      
    ) dbt_internal_test
[0m03:27:58.611158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:59.391072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m03:27:59.395010 [debug] [Thread-1 (]: On test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4: Close
[0m03:27:59.510381 [error] [Thread-1 (]: 8 of 23 FAIL 194 accepted_values_transformations_rsi__0__100 ................... [[31mFAIL 194[0m in 0.91s]
[0m03:27:59.513735 [debug] [Thread-1 (]: Finished running node test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4
[0m03:27:59.515521 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:27:59.517505 [info ] [Thread-1 (]: 9 of 23 START test not_null_raw_data_model_close ............................... [RUN]
[0m03:27:59.519270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.accepted_values_transformations_rsi__0__100.c0ad31e8f4, now test.stock_dbt.not_null_raw_data_model_close.bc47f52949)
[0m03:27:59.520546 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:27:59.526886 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:27:59.528483 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:27:59.531132 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:27:59.532748 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"
[0m03:27:59.533253 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_close.bc47f52949"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from DEV.raw_data.raw_data_model
where close is null



      
    ) dbt_internal_test
[0m03:27:59.533635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:00.276264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m03:28:00.282878 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_close.bc47f52949: Close
[0m03:28:00.409839 [info ] [Thread-1 (]: 9 of 23 PASS not_null_raw_data_model_close ..................................... [[32mPASS[0m in 0.89s]
[0m03:28:00.413163 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_close.bc47f52949
[0m03:28:00.415031 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:28:00.416978 [info ] [Thread-1 (]: 10 of 23 START test not_null_raw_data_model_date ............................... [RUN]
[0m03:28:00.418223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_close.bc47f52949, now test.stock_dbt.not_null_raw_data_model_date.43227680be)
[0m03:28:00.418635 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:28:00.422473 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:28:00.423345 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:28:00.425355 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:28:00.426581 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_date.43227680be"
[0m03:28:00.427221 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_date.43227680be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.raw_data_model
where date is null



      
    ) dbt_internal_test
[0m03:28:00.427694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:01.216220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m03:28:01.222432 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_date.43227680be: Close
[0m03:28:01.353178 [info ] [Thread-1 (]: 10 of 23 PASS not_null_raw_data_model_date ..................................... [[32mPASS[0m in 0.93s]
[0m03:28:01.356409 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_date.43227680be
[0m03:28:01.358309 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:28:01.360287 [info ] [Thread-1 (]: 11 of 23 START test not_null_raw_data_model_max_value .......................... [RUN]
[0m03:28:01.362701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_date.43227680be, now test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba)
[0m03:28:01.364205 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:28:01.374086 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:28:01.376369 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:28:01.380885 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:28:01.382528 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"
[0m03:28:01.383070 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select max_value
from DEV.raw_data.raw_data_model
where max_value is null



      
    ) dbt_internal_test
[0m03:28:01.383553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:02.110871 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d50-0004-2cf5-0002-7a6f00011422
[0m03:28:02.112038 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MAX_VALUE'
[0m03:28:02.113219 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba: Close
[0m03:28:02.275643 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m03:28:02.276215 [error] [Thread-1 (]: 11 of 23 ERROR not_null_raw_data_model_max_value ............................... [[31mERROR[0m in 0.91s]
[0m03:28:02.277032 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba
[0m03:28:02.277446 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:28:02.277807 [info ] [Thread-1 (]: 12 of 23 START test not_null_raw_data_model_min_value .......................... [RUN]
[0m03:28:02.278437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_max_value.ef2d73d8ba, now test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b)
[0m03:28:02.278808 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:28:02.282140 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:28:02.282911 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:28:02.284772 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:28:02.285873 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"
[0m03:28:02.286287 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select min_value
from DEV.raw_data.raw_data_model
where min_value is null



      
    ) dbt_internal_test
[0m03:28:02.286640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:03.062473 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d50-0004-2cf6-0000-00027a6fd4f1
[0m03:28:03.064005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'MIN_VALUE'
[0m03:28:03.065759 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b: Close
[0m03:28:03.220114 [debug] [Thread-1 (]: Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m03:28:03.221273 [error] [Thread-1 (]: 12 of 23 ERROR not_null_raw_data_model_min_value ............................... [[31mERROR[0m in 0.94s]
[0m03:28:03.222963 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b
[0m03:28:03.223751 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:28:03.224434 [info ] [Thread-1 (]: 13 of 23 START test not_null_raw_data_model_open ............................... [RUN]
[0m03:28:03.225450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_min_value.2a7f3e243b, now test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a)
[0m03:28:03.226319 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:28:03.231774 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:28:03.233009 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:28:03.235648 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:28:03.237276 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"
[0m03:28:03.237815 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select open
from DEV.raw_data.raw_data_model
where open is null



      
    ) dbt_internal_test
[0m03:28:03.238261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:04.036214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.798 seconds
[0m03:28:04.038408 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a: Close
[0m03:28:04.177107 [info ] [Thread-1 (]: 13 of 23 PASS not_null_raw_data_model_open ..................................... [[32mPASS[0m in 0.95s]
[0m03:28:04.180367 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a
[0m03:28:04.182109 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:28:04.184035 [info ] [Thread-1 (]: 14 of 23 START test not_null_raw_data_model_symbol ............................. [RUN]
[0m03:28:04.186327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_open.69aa4fcc9a, now test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f)
[0m03:28:04.187928 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:28:04.199527 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:28:04.201354 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:28:04.205179 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:28:04.207026 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"
[0m03:28:04.207717 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.raw_data_model
where symbol is null



      
    ) dbt_internal_test
[0m03:28:04.208469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:05.010543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m03:28:05.013170 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f: Close
[0m03:28:05.135264 [info ] [Thread-1 (]: 14 of 23 PASS not_null_raw_data_model_symbol ................................... [[32mPASS[0m in 0.95s]
[0m03:28:05.136748 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f
[0m03:28:05.137536 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:28:05.138259 [info ] [Thread-1 (]: 15 of 23 START test not_null_raw_data_model_volume ............................. [RUN]
[0m03:28:05.139248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_symbol.663f3b653f, now test.stock_dbt.not_null_raw_data_model_volume.ce135396be)
[0m03:28:05.139937 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:28:05.145659 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:28:05.146628 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:28:05.149266 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:28:05.150348 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"
[0m03:28:05.150763 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_raw_data_model_volume.ce135396be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume
from DEV.raw_data.raw_data_model
where volume is null



      
    ) dbt_internal_test
[0m03:28:05.151179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:05.884278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m03:28:05.886143 [debug] [Thread-1 (]: On test.stock_dbt.not_null_raw_data_model_volume.ce135396be: Close
[0m03:28:06.012533 [info ] [Thread-1 (]: 15 of 23 PASS not_null_raw_data_model_volume ................................... [[32mPASS[0m in 0.87s]
[0m03:28:06.013998 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_raw_data_model_volume.ce135396be
[0m03:28:06.014758 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:28:06.015434 [info ] [Thread-1 (]: 16 of 23 START test not_null_transformations_date .............................. [RUN]
[0m03:28:06.016445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_raw_data_model_volume.ce135396be, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m03:28:06.017132 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:28:06.023358 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:28:06.025450 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:28:06.029138 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:28:06.031055 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m03:28:06.031806 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m03:28:06.032481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:06.861330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m03:28:06.863131 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m03:28:07.012293 [info ] [Thread-1 (]: 16 of 23 PASS not_null_transformations_date .................................... [[32mPASS[0m in 1.00s]
[0m03:28:07.013234 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m03:28:07.013697 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:28:07.014095 [info ] [Thread-1 (]: 17 of 23 START test not_null_transformations_moving_average_20 ................. [RUN]
[0m03:28:07.014797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m03:28:07.015260 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:28:07.020545 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:28:07.021933 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:28:07.024562 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:28:07.026579 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m03:28:07.027406 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m03:28:07.028089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:07.793602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m03:28:07.800423 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m03:28:07.932142 [info ] [Thread-1 (]: 17 of 23 PASS not_null_transformations_moving_average_20 ....................... [[32mPASS[0m in 0.92s]
[0m03:28:07.935372 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m03:28:07.937245 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:28:07.939226 [info ] [Thread-1 (]: 18 of 23 START test not_null_transformations_moving_average_50 ................. [RUN]
[0m03:28:07.941725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m03:28:07.942247 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:28:07.945859 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:28:07.946807 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:28:07.948769 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:28:07.949829 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m03:28:07.950237 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m03:28:07.950634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:08.753987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m03:28:08.757734 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m03:28:08.872372 [info ] [Thread-1 (]: 18 of 23 PASS not_null_transformations_moving_average_50 ....................... [[32mPASS[0m in 0.93s]
[0m03:28:08.875349 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m03:28:08.877100 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:28:08.878828 [info ] [Thread-1 (]: 19 of 23 START test not_null_transformations_rsi ............................... [RUN]
[0m03:28:08.881164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m03:28:08.882735 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:28:08.893441 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:28:08.895438 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:28:08.899252 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:28:08.900961 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m03:28:08.901635 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m03:28:08.902266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:09.698913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m03:28:09.706075 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m03:28:09.832471 [info ] [Thread-1 (]: 19 of 23 PASS not_null_transformations_rsi ..................................... [[32mPASS[0m in 0.95s]
[0m03:28:09.835817 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m03:28:09.837645 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:28:09.839726 [info ] [Thread-1 (]: 20 of 23 START test not_null_transformations_symbol ............................ [RUN]
[0m03:28:09.842099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m03:28:09.843445 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:28:09.850256 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:28:09.851291 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:28:09.854196 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:28:09.855380 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m03:28:09.855803 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m03:28:09.856192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:10.723199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.867 seconds
[0m03:28:10.730002 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m03:28:10.864045 [info ] [Thread-1 (]: 20 of 23 PASS not_null_transformations_symbol .................................. [[32mPASS[0m in 1.02s]
[0m03:28:10.866951 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m03:28:10.868971 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:28:10.871645 [info ] [Thread-1 (]: 21 of 23 START test unique_raw_data_model_date ................................. [RUN]
[0m03:28:10.873977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_symbol.c0b2d06825, now test.stock_dbt.unique_raw_data_model_date.536ce37367)
[0m03:28:10.875012 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:28:10.886201 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:28:10.887569 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:28:10.890521 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:28:10.892104 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_date.536ce37367"
[0m03:28:10.892709 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_date.536ce37367"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m03:28:10.893173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:11.700170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m03:28:11.706956 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_date.536ce37367: Close
[0m03:28:11.829224 [error] [Thread-1 (]: 21 of 23 FAIL 100 unique_raw_data_model_date ................................... [[31mFAIL 100[0m in 0.95s]
[0m03:28:11.832433 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_date.536ce37367
[0m03:28:11.834413 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:28:11.836364 [info ] [Thread-1 (]: 22 of 23 START test unique_raw_data_model_symbol ............................... [RUN]
[0m03:28:11.838651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_date.536ce37367, now test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec)
[0m03:28:11.840320 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:28:11.850845 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:28:11.852903 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:28:11.857617 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:28:11.859483 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"
[0m03:28:11.860105 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.raw_data_model
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:28:11.860701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:12.586592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m03:28:12.590628 [debug] [Thread-1 (]: On test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec: Close
[0m03:28:12.754269 [error] [Thread-1 (]: 22 of 23 FAIL 2 unique_raw_data_model_symbol ................................... [[31mFAIL 2[0m in 0.92s]
[0m03:28:12.757592 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec
[0m03:28:12.759512 [debug] [Thread-1 (]: Began running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:28:12.761182 [info ] [Thread-1 (]: 23 of 23 START test unique_transformations_symbol .............................. [RUN]
[0m03:28:12.762833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.unique_raw_data_model_symbol.d5109aa2ec, now test.stock_dbt.unique_transformations_symbol.2bcfbcf557)
[0m03:28:12.763949 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:28:12.771602 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:28:12.773369 [debug] [Thread-1 (]: Began executing node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:28:12.777230 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:28:12.778984 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"
[0m03:28:12.779585 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.unique_transformations_symbol.2bcfbcf557"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from DEV.raw_data.transformations
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:28:12.780173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:13.591913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m03:28:13.595598 [debug] [Thread-1 (]: On test.stock_dbt.unique_transformations_symbol.2bcfbcf557: Close
[0m03:28:13.726678 [error] [Thread-1 (]: 23 of 23 FAIL 2 unique_transformations_symbol .................................. [[31mFAIL 2[0m in 0.96s]
[0m03:28:13.728314 [debug] [Thread-1 (]: Finished running node test.stock_dbt.unique_transformations_symbol.2bcfbcf557
[0m03:28:13.730431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:28:13.730948 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m03:28:13.731371 [debug] [MainThread]: Connection 'test.stock_dbt.unique_transformations_symbol.2bcfbcf557' was properly closed.
[0m03:28:13.731912 [info ] [MainThread]: 
[0m03:28:13.732702 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 23.78 seconds (23.78s).
[0m03:28:13.740870 [debug] [MainThread]: Command end result
[0m03:28:13.793378 [info ] [MainThread]: 
[0m03:28:13.794541 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m03:28:13.795867 [info ] [MainThread]: 
[0m03:28:13.797031 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_close__0__5000000 (models\schema.yml)[0m
[0m03:28:13.798248 [error] [MainThread]:   Got 198 results, configured to fail if != 0
[0m03:28:13.799098 [info ] [MainThread]: 
[0m03:28:13.799832 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_close__0__5000000.sql
[0m03:28:13.800386 [info ] [MainThread]: 
[0m03:28:13.801248 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_max_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_max_value__0__5000000.sql
[0m03:28:13.801973 [info ] [MainThread]: 
[0m03:28:13.802877 [error] [MainThread]:   Database Error in test accepted_values_raw_data_model_min_value__0__5000000 (models\schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\accepted_values_raw_data_model_min_value__0__5000000.sql
[0m03:28:13.804763 [info ] [MainThread]: 
[0m03:28:13.807122 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_open__0__5000000 (models\schema.yml)[0m
[0m03:28:13.808101 [error] [MainThread]:   Got 199 results, configured to fail if != 0
[0m03:28:13.808977 [info ] [MainThread]: 
[0m03:28:13.810019 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_open__0__5000000.sql
[0m03:28:13.811104 [info ] [MainThread]: 
[0m03:28:13.812332 [error] [MainThread]: [31mFailure in test accepted_values_raw_data_model_volume__0__1000000000 (models\schema.yml)[0m
[0m03:28:13.813264 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:28:13.813871 [info ] [MainThread]: 
[0m03:28:13.814660 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_raw_data_model_volume__0__1000000000.sql
[0m03:28:13.815620 [info ] [MainThread]: 
[0m03:28:13.816574 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_20__0__5000000 (models\schema.yml)[0m
[0m03:28:13.817395 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m03:28:13.817997 [info ] [MainThread]: 
[0m03:28:13.819466 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_20__0__5000000.sql
[0m03:28:13.821782 [info ] [MainThread]: 
[0m03:28:13.823652 [error] [MainThread]: [31mFailure in test accepted_values_transformations_moving_average_50__0__5000000 (models\schema.yml)[0m
[0m03:28:13.824489 [error] [MainThread]:   Got 200 results, configured to fail if != 0
[0m03:28:13.825063 [info ] [MainThread]: 
[0m03:28:13.825907 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_moving_average_50__0__5000000.sql
[0m03:28:13.826614 [info ] [MainThread]: 
[0m03:28:13.827418 [error] [MainThread]: [31mFailure in test accepted_values_transformations_rsi__0__100 (models\schema.yml)[0m
[0m03:28:13.828111 [error] [MainThread]:   Got 194 results, configured to fail if != 0
[0m03:28:13.828660 [info ] [MainThread]: 
[0m03:28:13.829489 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\accepted_values_transformations_rsi__0__100.sql
[0m03:28:13.831064 [info ] [MainThread]: 
[0m03:28:13.832645 [error] [MainThread]:   Database Error in test not_null_raw_data_model_max_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MAX_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_max_value.sql
[0m03:28:13.833936 [info ] [MainThread]: 
[0m03:28:13.835021 [error] [MainThread]:   Database Error in test not_null_raw_data_model_min_value (models\schema.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'MIN_VALUE'
  compiled code at target\run\stock_dbt\models\schema.yml\not_null_raw_data_model_min_value.sql
[0m03:28:13.835959 [info ] [MainThread]: 
[0m03:28:13.836727 [error] [MainThread]: [31mFailure in test unique_raw_data_model_date (models\schema.yml)[0m
[0m03:28:13.837897 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m03:28:13.839080 [info ] [MainThread]: 
[0m03:28:13.840144 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_date.sql
[0m03:28:13.840974 [info ] [MainThread]: 
[0m03:28:13.841769 [error] [MainThread]: [31mFailure in test unique_raw_data_model_symbol (models\schema.yml)[0m
[0m03:28:13.842517 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:28:13.843083 [info ] [MainThread]: 
[0m03:28:13.843967 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_raw_data_model_symbol.sql
[0m03:28:13.844650 [info ] [MainThread]: 
[0m03:28:13.845364 [error] [MainThread]: [31mFailure in test unique_transformations_symbol (models\schema.yml)[0m
[0m03:28:13.846112 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:28:13.847076 [info ] [MainThread]: 
[0m03:28:13.848249 [info ] [MainThread]:   compiled code at target\compiled\stock_dbt\models\schema.yml\unique_transformations_symbol.sql
[0m03:28:13.848824 [info ] [MainThread]: 
[0m03:28:13.849424 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=13 SKIP=0 TOTAL=23
[0m03:28:13.851057 [debug] [MainThread]: Command `dbt test` failed at 03:28:13.850860 after 25.32 seconds
[0m03:28:13.851684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002041F15FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043080B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020430B4B120>]}
[0m03:28:13.852197 [debug] [MainThread]: Flushing usage events
[0m11:06:33.394678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E20714EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E209BD0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E209BD0050>]}


============================== 11:06:33.419136 | 63ce3260-03c7-43ab-b8c4-51bae1ab7885 ==============================
[0m11:06:33.419136 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:06:33.421344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:06:35.786623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E208F19E00>]}
[0m11:06:35.845529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E208E3E030>]}
[0m11:06:35.847235 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:06:35.856302 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:06:36.118467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:06:36.119461 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\schema.yml
[0m11:06:36.119842 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://models\raw_data_model.sql
[0m11:06:36.503897 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:06:36.504668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21B22C450>]}
[0m11:06:36.770371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21B0773E0>]}
[0m11:06:36.914978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21C32F070>]}
[0m11:06:36.915561 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 454 macros
[0m11:06:36.916264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21C2C6C30>]}
[0m11:06:36.918528 [info ] [MainThread]: 
[0m11:06:36.919535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:36.924490 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m11:06:36.938690 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m11:06:36.939126 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m11:06:36.939464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:38.312563 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.373 seconds
[0m11:06:38.318841 [debug] [ThreadPool]: On list_DEV: Close
[0m11:06:38.500101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m11:06:38.532268 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m11:06:38.533360 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m11:06:38.534246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:40.155874 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.621 seconds
[0m11:06:40.163175 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m11:06:40.298658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m11:06:40.307844 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m11:06:40.309331 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m11:06:40.310582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:41.998038 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.687 seconds
[0m11:06:42.004601 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m11:06:42.138465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21C310DD0>]}
[0m11:06:42.140465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:42.142763 [info ] [MainThread]: 
[0m11:06:42.155475 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m11:06:42.157816 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m11:06:42.160596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.stock_dbt.raw_data_model'
[0m11:06:42.162351 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m11:06:42.187268 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m11:06:42.189695 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m11:06:42.261596 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m11:06:42.265412 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m11:06:42.266545 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view DEV.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        DEV.raw_data.stock_data  -- Refers to the source defined in schema.yml
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m11:06:42.267510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:44.045668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.778 seconds
[0m11:06:44.110429 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m11:06:44.226516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21C54F280>]}
[0m11:06:44.229348 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 2.06s]
[0m11:06:44.232837 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m11:06:44.236468 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m11:06:44.239052 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m11:06:44.241936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m11:06:44.243766 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m11:06:44.256557 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m11:06:44.260245 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m11:06:44.315889 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m11:06:44.322372 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m11:06:44.323587 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table DEV.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        DEV.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m11:06:44.324898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:46.912503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.587 seconds
[0m11:06:46.924599 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m11:06:47.072697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ce3260-03c7-43ab-b8c4-51bae1ab7885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21C6A6670>]}
[0m11:06:47.075181 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 2.83s]
[0m11:06:47.078644 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m11:06:47.083154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:47.084613 [debug] [MainThread]: Connection 'list_DEV' was properly closed.
[0m11:06:47.085924 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m11:06:47.087055 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m11:06:47.088309 [info ] [MainThread]: 
[0m11:06:47.090178 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 10.17 seconds (10.17s).
[0m11:06:47.094942 [debug] [MainThread]: Command end result
[0m11:06:47.170222 [info ] [MainThread]: 
[0m11:06:47.171586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:47.172626 [info ] [MainThread]: 
[0m11:06:47.173516 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:06:47.175695 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:47.175345 after 14.00 seconds
[0m11:06:47.176531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21B1798D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E21C297450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E209C16C80>]}
[0m11:06:47.177326 [debug] [MainThread]: Flushing usage events
[0m11:06:55.424723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027969A0EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002796C480190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002796C480050>]}


============================== 11:06:55.433939 | dd571d98-c867-42f0-8f37-bd7db80c53b0 ==============================
[0m11:06:55.433939 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:06:55.435525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:56.489761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd571d98-c867-42f0-8f37-bd7db80c53b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002796B7DDE00>]}
[0m11:06:56.545502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd571d98-c867-42f0-8f37-bd7db80c53b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002796B6FE030>]}
[0m11:06:56.547014 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:06:56.556116 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:06:56.777140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:56.777599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:56.829762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd571d98-c867-42f0-8f37-bd7db80c53b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797D780350>]}
[0m11:06:56.982761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd571d98-c867-42f0-8f37-bd7db80c53b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797DB208C0>]}
[0m11:06:56.983285 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 454 macros
[0m11:06:56.983910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd571d98-c867-42f0-8f37-bd7db80c53b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797D96BCB0>]}
[0m11:06:56.986141 [info ] [MainThread]: 
[0m11:06:56.987087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:56.991752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_raw_data'
[0m11:06:57.009139 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m11:06:57.009559 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m11:06:57.009873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:58.178356 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.168 seconds
[0m11:06:58.185383 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m11:06:58.329366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_raw_data, now list_dev_raw_data)
[0m11:06:58.339089 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m11:06:58.340580 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m11:06:58.341817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:59.303938 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.962 seconds
[0m11:06:59.310454 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m11:06:59.444722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd571d98-c867-42f0-8f37-bd7db80c53b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797DAF7A00>]}
[0m11:06:59.446519 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:59.447921 [info ] [MainThread]: 
[0m11:06:59.455583 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m11:06:59.456539 [info ] [Thread-1 (]: 1 of 5 START test not_null_transformations_date ................................ [RUN]
[0m11:06:59.457779 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.stock_dbt.not_null_transformations_date.eb21993fae'
[0m11:06:59.458344 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m11:06:59.478972 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m11:06:59.480626 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m11:06:59.503949 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m11:06:59.507051 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m11:06:59.507540 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from DEV.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m11:06:59.507970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:00.568503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.060 seconds
[0m11:07:00.601946 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m11:07:00.765866 [info ] [Thread-1 (]: 1 of 5 PASS not_null_transformations_date ...................................... [[32mPASS[0m in 1.31s]
[0m11:07:00.768044 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m11:07:00.769104 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m11:07:00.770233 [info ] [Thread-1 (]: 2 of 5 START test not_null_transformations_moving_average_20 ................... [RUN]
[0m11:07:00.771538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m11:07:00.772546 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m11:07:00.786084 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m11:07:00.789152 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m11:07:00.797434 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m11:07:00.801634 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m11:07:00.803376 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from DEV.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m11:07:00.805062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:02.683284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.878 seconds
[0m11:07:02.688506 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m11:07:02.892344 [info ] [Thread-1 (]: 2 of 5 PASS not_null_transformations_moving_average_20 ......................... [[32mPASS[0m in 2.12s]
[0m11:07:02.894769 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m11:07:02.896324 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m11:07:02.897232 [info ] [Thread-1 (]: 3 of 5 START test not_null_transformations_moving_average_50 ................... [RUN]
[0m11:07:02.898532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m11:07:02.899863 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m11:07:02.908642 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m11:07:02.911403 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m11:07:02.918140 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m11:07:02.921022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m11:07:02.921998 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from DEV.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m11:07:02.922932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:04.219183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.296 seconds
[0m11:07:04.226931 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m11:07:04.531737 [info ] [Thread-1 (]: 3 of 5 PASS not_null_transformations_moving_average_50 ......................... [[32mPASS[0m in 1.63s]
[0m11:07:04.535117 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m11:07:04.536870 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m11:07:04.538868 [info ] [Thread-1 (]: 4 of 5 START test not_null_transformations_rsi ................................. [RUN]
[0m11:07:04.541196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m11:07:04.542903 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m11:07:04.556810 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m11:07:04.559985 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m11:07:04.566634 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m11:07:04.569165 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m11:07:04.570153 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from DEV.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m11:07:04.571069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:06.266343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.695 seconds
[0m11:07:06.274488 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m11:07:06.418347 [info ] [Thread-1 (]: 4 of 5 PASS not_null_transformations_rsi ....................................... [[32mPASS[0m in 1.88s]
[0m11:07:06.422161 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m11:07:06.424737 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m11:07:06.427264 [info ] [Thread-1 (]: 5 of 5 START test not_null_transformations_symbol .............................. [RUN]
[0m11:07:06.430208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m11:07:06.432014 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m11:07:06.446897 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m11:07:06.450313 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m11:07:06.456893 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m11:07:06.461273 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m11:07:06.462458 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from DEV.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m11:07:06.463402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:07.784319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.320 seconds
[0m11:07:07.791646 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m11:07:07.934607 [info ] [Thread-1 (]: 5 of 5 PASS not_null_transformations_symbol .................................... [[32mPASS[0m in 1.51s]
[0m11:07:07.935817 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m11:07:07.939117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:07.939905 [debug] [MainThread]: Connection 'list_dev_raw_data' was properly closed.
[0m11:07:07.940369 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_transformations_symbol.c0b2d06825' was properly closed.
[0m11:07:07.940821 [info ] [MainThread]: 
[0m11:07:07.941631 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 10.95 seconds (10.95s).
[0m11:07:07.944530 [debug] [MainThread]: Command end result
[0m11:07:07.986419 [info ] [MainThread]: 
[0m11:07:07.987284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:07.987939 [info ] [MainThread]: 
[0m11:07:07.988634 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:07:07.990210 [debug] [MainThread]: Command `dbt test` succeeded at 11:07:07.990011 after 12.72 seconds
[0m11:07:07.990772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002796C3AFB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EDB7540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002797EDB7960>]}
[0m11:07:07.991361 [debug] [MainThread]: Flushing usage events
[0m11:07:17.810176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45DBDEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B460660190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B460660050>]}


============================== 11:07:17.819580 | 9dd4aeab-2dbc-450b-9b1e-31f409e6e374 ==============================
[0m11:07:17.819580 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:07:17.821211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\mtann\\sjsu-data226-main\\week8\\airflow\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m11:07:18.949764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45F9A9E00>]}
[0m11:07:19.003875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45F8CE030>]}
[0m11:07:19.005302 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:07:19.013741 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:07:19.175698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:19.176069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:19.228347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4718F4350>]}
[0m11:07:19.356334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4605A74D0>]}
[0m11:07:19.356868 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 454 macros
[0m11:07:19.357546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B45F926970>]}
[0m11:07:19.359501 [info ] [MainThread]: 
[0m11:07:19.360421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:19.361593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m11:07:19.376011 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m11:07:19.376431 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m11:07:19.376753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:20.561178 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.184 seconds
[0m11:07:20.571787 [debug] [ThreadPool]: On list_dev: Close
[0m11:07:20.737201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m11:07:20.757602 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m11:07:20.758546 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m11:07:20.759320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:21.836396 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.077 seconds
[0m11:07:21.843121 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m11:07:21.981797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_raw_data, now list_DEV_raw_data)
[0m11:07:21.990639 [debug] [ThreadPool]: Using snowflake connection "list_DEV_raw_data"
[0m11:07:21.991977 [debug] [ThreadPool]: On list_DEV_raw_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_DEV_raw_data"} */
show objects in DEV.raw_data limit 10000
[0m11:07:21.993394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:22.959532 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.966 seconds
[0m11:07:22.965975 [debug] [ThreadPool]: On list_DEV_raw_data: Close
[0m11:07:23.094696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B471B19BF0>]}
[0m11:07:23.096697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:23.098598 [info ] [MainThread]: 
[0m11:07:23.110617 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.raw_data_snapshot
[0m11:07:23.112599 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.raw_data.raw_data_snapshot ........................... [RUN]
[0m11:07:23.115142 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.stock_dbt.raw_data_snapshot'
[0m11:07:23.116924 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.raw_data_snapshot
[0m11:07:23.153333 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.raw_data_snapshot
[0m11:07:23.327839 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m11:07:23.328965 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        nullif(date, date) as dbt_valid_to
    from (
        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m11:07:23.329943 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:24.975066 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.645 seconds
[0m11:07:24.989961 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m11:07:24.991024 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:07:25.123795 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.131 seconds
[0m11:07:25.126102 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.raw_data_snapshot"
[0m11:07:25.133449 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m11:07:25.136098 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
create or replace transient table dev.raw_data.raw_data_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        nullif(date, date) as dbt_valid_to
    from (
        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data

    ) sbq



        );
[0m11:07:25.825449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m11:07:25.890479 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: Close
[0m11:07:26.038066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dd4aeab-2dbc-450b-9b1e-31f409e6e374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B471CAC950>]}
[0m11:07:26.041510 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dev.raw_data.raw_data_snapshot ........................... [[32mSUCCESS 1[0m in 2.92s]
[0m11:07:26.045013 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.raw_data_snapshot
[0m11:07:26.050543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:26.052083 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m11:07:26.053295 [debug] [MainThread]: Connection 'list_DEV_raw_data' was properly closed.
[0m11:07:26.054440 [debug] [MainThread]: Connection 'snapshot.stock_dbt.raw_data_snapshot' was properly closed.
[0m11:07:26.055812 [info ] [MainThread]: 
[0m11:07:26.057815 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m11:07:26.061260 [debug] [MainThread]: Command end result
[0m11:07:26.128748 [info ] [MainThread]: 
[0m11:07:26.130227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:26.131523 [info ] [MainThread]: 
[0m11:07:26.132587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:07:26.135832 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:07:26.135324 after 8.47 seconds
[0m11:07:26.137255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B471B2CCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B471D0D950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B471D0DB30>]}
[0m11:07:26.138609 [debug] [MainThread]: Flushing usage events
[0m19:09:12.052806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46d285a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b6cfb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b65b3b0>]}


============================== 19:09:12.082703 | ea04bc70-f8f2-4477-83d7-4fa0a0204ded ==============================
[0m19:09:12.082703 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:09:12.084357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:14.834177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4807dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46537bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46537d10>]}


============================== 19:09:14.844024 | 9b17f320-628f-4672-90cb-563fe3987967 ==============================
[0m19:09:14.844024 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:09:14.845812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:18.205542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a30a22c30>]}
[0m19:09:18.205541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa44a2be9f0>]}
[0m19:09:18.292628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b65bb30>]}
[0m19:09:18.295260 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:18.313752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a48ee98b0>]}
[0m19:09:18.319258 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:18.513268 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:18.587670 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:18.953345 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:09:18.954547 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:09:18.955133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46bf4cc80>]}
[0m19:09:18.956362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a28ac3fb0>]}
[0m19:09:20.574776 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:09:20.576326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a23733ad0>]}
[0m19:09:20.577003 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:09:20.578245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa448786780>]}
[0m19:09:21.341658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa44876b710>]}
[0m19:09:21.380151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2812f500>]}
[0m19:09:21.722058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a288536b0>]}
[0m19:09:21.724753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa449a0d460>]}
[0m19:09:21.726462 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m19:09:21.729403 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m19:09:21.730796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46d34500>]}
[0m19:09:21.734942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa44a1f82f0>]}
[0m19:09:21.742635 [info ] [MainThread]: 
[0m19:09:21.748374 [info ] [MainThread]: 
[0m19:09:21.748490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:21.755719 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:21.773913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:09:21.775064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:09:21.805647 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:09:21.806641 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:09:21.807590 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:09:21.808466 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:09:21.809297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:21.810077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:22.976262 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.166 seconds
[0m19:09:22.976161 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.167 seconds
[0m19:09:22.984701 [debug] [ThreadPool]: On list_dev: Close
[0m19:09:22.985477 [debug] [ThreadPool]: On list_dev: Close
[0m19:09:23.193746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:09:23.193987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:09:23.222883 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:09:23.223166 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:09:23.225300 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:09:23.225286 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:09:23.227150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:23.227157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:23.895545 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.668 seconds
[0m19:09:23.895525 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.668 seconds
[0m19:09:23.900825 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:09:23.900990 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:09:24.029083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46ccd8e30>]}
[0m19:09:24.030694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:24.033439 [info ] [MainThread]: 
[0m19:09:24.034370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a28996b70>]}
[0m19:09:24.036115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:24.037381 [info ] [MainThread]: 
[0m19:09:24.045324 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m19:09:24.047165 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m19:09:24.047832 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m19:09:24.049279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now model.stock_dbt.raw_data_model)
[0m19:09:24.049813 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m19:09:24.050844 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m19:09:24.051384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now model.stock_dbt.raw_data_model)
[0m19:09:24.052722 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m19:09:24.063593 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m19:09:24.067712 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m19:09:24.074459 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m19:09:24.075613 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m19:09:24.136834 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m19:09:24.139927 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m19:09:24.146830 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m19:09:24.148088 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m19:09:24.149260 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view dev.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        DEV.raw_data.stock_data  -- Refers to the source defined in schema.yml
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m19:09:24.150191 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view dev.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        DEV.raw_data.stock_data  -- Refers to the source defined in schema.yml
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m19:09:24.151037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:24.151679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:24.930644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m19:09:24.988366 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m19:09:25.039505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.888 seconds
[0m19:09:25.083721 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m19:09:25.132305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46bf4df40>]}
[0m19:09:25.134748 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.08s]
[0m19:09:25.136899 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m19:09:25.139853 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m19:09:25.141649 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m19:09:25.143215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m19:09:25.144828 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m19:09:25.152289 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m19:09:25.162755 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m19:09:25.203789 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m19:09:25.218241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46d36300>]}
[0m19:09:25.219494 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m19:09:25.220546 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.16s]
[0m19:09:25.221390 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table dev.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        dev.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m19:09:25.222420 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m19:09:25.223073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:25.225392 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m19:09:25.227364 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m19:09:25.229095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m19:09:25.232909 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m19:09:25.240528 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m19:09:25.250964 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m19:09:25.292852 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m19:09:25.306631 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m19:09:25.308434 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table dev.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        dev.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m19:09:25.310287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:26.661693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.351 seconds
[0m19:09:26.668212 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m19:09:26.695568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.472 seconds
[0m19:09:26.701870 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m19:09:26.827742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b17f320-628f-4672-90cb-563fe3987967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a2812f560>]}
[0m19:09:26.835648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea04bc70-f8f2-4477-83d7-4fa0a0204ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa449fb15e0>]}
[0m19:09:26.836026 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 1.60s]
[0m19:09:26.842702 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 1.69s]
[0m19:09:26.843301 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m19:09:26.849127 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m19:09:26.852690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:26.855114 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m19:09:26.855616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:26.857747 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m19:09:26.857587 [info ] [MainThread]: 
[0m19:09:26.859692 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m19:09:26.859715 [info ] [MainThread]: 
[0m19:09:26.861743 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m19:09:26.862731 [debug] [MainThread]: Command end result
[0m19:09:26.865920 [debug] [MainThread]: Command end result
[0m19:09:26.939463 [info ] [MainThread]: 
[0m19:09:26.940375 [info ] [MainThread]: 
[0m19:09:26.941277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:26.942092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:26.942842 [info ] [MainThread]: 
[0m19:09:26.943492 [info ] [MainThread]: 
[0m19:09:26.944195 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:09:26.944802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:09:26.946745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.069962, "process_user_time": 9.955063, "process_kernel_time": 9.579592, "process_mem_max_rss": "230460", "process_in_blocks": "6400", "process_out_blocks": "8"}
[0m19:09:26.947570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.258712, "process_user_time": 8.429624, "process_kernel_time": 5.381912, "process_mem_max_rss": "226148", "process_in_blocks": "3104", "process_out_blocks": "8"}
[0m19:09:26.949086 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:26.948912 after 15.07 seconds
[0m19:09:26.949356 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:26.949190 after 12.26 seconds
[0m19:09:26.950438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b2238c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b23c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46b8b25a0>]}
[0m19:09:26.950759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4652d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4698f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a22d27920>]}
[0m19:09:26.951841 [debug] [MainThread]: Flushing usage events
[0m19:09:26.952086 [debug] [MainThread]: Flushing usage events
[0m19:09:34.389732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f28231af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f298d09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f28233650>]}
[0m19:09:34.390388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8827779cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f882793fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f882a0f6300>]}


============================== 19:09:34.403214 | 3ac07f35-56ac-4c2a-9966-dd67efbfca82 ==============================
[0m19:09:34.403214 [info ] [MainThread]: Running with dbt=1.8.7


============================== 19:09:34.403744 | 0b8cfd0e-87db-40c1-995b-d2741da0a333 ==============================
[0m19:09:34.403744 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:09:34.405684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:09:34.406071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:09:35.903674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ac07f35-56ac-4c2a-9966-dd67efbfca82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f29147740>]}
[0m19:09:35.910805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b8cfd0e-87db-40c1-995b-d2741da0a333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8807bdfce0>]}
[0m19:09:35.974625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ac07f35-56ac-4c2a-9966-dd67efbfca82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f27dddaf0>]}
[0m19:09:35.976889 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:35.984652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b8cfd0e-87db-40c1-995b-d2741da0a333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805f8ab70>]}
[0m19:09:35.986617 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:36.114076 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:36.115401 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:36.367505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:36.367562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:36.369263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:36.369283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:36.436169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ac07f35-56ac-4c2a-9966-dd67efbfca82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f05f557f0>]}
[0m19:09:36.437347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b8cfd0e-87db-40c1-995b-d2741da0a333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880d50bec0>]}
[0m19:09:36.632706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b8cfd0e-87db-40c1-995b-d2741da0a333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88059b3b60>]}
[0m19:09:36.633594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ac07f35-56ac-4c2a-9966-dd67efbfca82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f05a596a0>]}
[0m19:09:36.634385 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m19:09:36.635143 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m19:09:36.635930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b8cfd0e-87db-40c1-995b-d2741da0a333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805e35af0>]}
[0m19:09:36.636693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac07f35-56ac-4c2a-9966-dd67efbfca82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f05c1d280>]}
[0m19:09:36.640342 [info ] [MainThread]: 
[0m19:09:36.640933 [info ] [MainThread]: 
[0m19:09:36.642383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:36.643591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:36.649854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m19:09:36.651039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m19:09:36.675366 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:09:36.675789 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:09:36.677199 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:09:36.677386 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:09:36.678789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:36.678805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:37.524954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.846 seconds
[0m19:09:37.525992 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.847 seconds
[0m19:09:37.537949 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:09:37.539563 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:09:37.687429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b8cfd0e-87db-40c1-995b-d2741da0a333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8805949580>]}
[0m19:09:37.689440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ac07f35-56ac-4c2a-9966-dd67efbfca82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f05c37ce0>]}
[0m19:09:37.692502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:37.695217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:37.698055 [info ] [MainThread]: 
[0m19:09:37.700270 [info ] [MainThread]: 
[0m19:09:37.738952 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:37.743778 [info ] [Thread-1 (]: 1 of 5 START test not_null_transformations_date ................................ [RUN]
[0m19:09:37.749913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m19:09:37.751843 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:37.754460 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:37.756678 [info ] [Thread-1 (]: 1 of 5 START test not_null_transformations_date ................................ [RUN]
[0m19:09:37.762805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m19:09:37.767536 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:37.856445 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:09:37.864662 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:09:37.873916 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:37.876313 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:37.917033 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:09:37.920310 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:09:37.928300 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:09:37.929754 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:09:37.930474 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m19:09:37.931476 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m19:09:37.932205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:37.933329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:38.746389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m19:09:38.747408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m19:09:38.764992 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m19:09:38.765099 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m19:09:38.898961 [info ] [Thread-1 (]: 1 of 5 PASS not_null_transformations_date ...................................... [[32mPASS[0m in 1.14s]
[0m19:09:38.899276 [info ] [Thread-1 (]: 1 of 5 PASS not_null_transformations_date ...................................... [[32mPASS[0m in 1.15s]
[0m19:09:38.905063 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:38.905270 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:09:38.911173 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:38.911086 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:38.917389 [info ] [Thread-1 (]: 2 of 5 START test not_null_transformations_moving_average_20 ................... [RUN]
[0m19:09:38.917277 [info ] [Thread-1 (]: 2 of 5 START test not_null_transformations_moving_average_20 ................... [RUN]
[0m19:09:38.922653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m19:09:38.922945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m19:09:38.928629 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:38.929714 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:38.953085 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:09:38.952853 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:09:38.984050 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:38.989320 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:38.998719 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:09:39.004030 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:09:39.028462 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:09:39.032770 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:09:39.033375 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from dev.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m19:09:39.037976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:39.037651 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from dev.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m19:09:39.042935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:39.770244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m19:09:39.779315 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m19:09:39.940741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.898 seconds
[0m19:09:39.953381 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m19:09:39.993951 [info ] [Thread-1 (]: 2 of 5 PASS not_null_transformations_moving_average_20 ......................... [[32mPASS[0m in 1.07s]
[0m19:09:39.998723 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:40.001742 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:40.004886 [info ] [Thread-1 (]: 3 of 5 START test not_null_transformations_moving_average_50 ................... [RUN]
[0m19:09:40.008098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m19:09:40.011543 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:40.026363 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:09:40.053259 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:40.062504 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:09:40.091045 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:09:40.094319 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from dev.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m19:09:40.097611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:40.105804 [info ] [Thread-1 (]: 2 of 5 PASS not_null_transformations_moving_average_20 ......................... [[32mPASS[0m in 1.18s]
[0m19:09:40.114287 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:09:40.117889 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:40.120911 [info ] [Thread-1 (]: 3 of 5 START test not_null_transformations_moving_average_50 ................... [RUN]
[0m19:09:40.124055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m19:09:40.127985 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:40.141792 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:09:40.167908 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:40.179354 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:09:40.208381 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:09:40.211511 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from dev.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m19:09:40.214082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:40.996450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m19:09:40.996453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m19:09:41.001845 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m19:09:41.002185 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m19:09:41.134261 [info ] [Thread-1 (]: 3 of 5 PASS not_null_transformations_moving_average_50 ......................... [[32mPASS[0m in 1.01s]
[0m19:09:41.134263 [info ] [Thread-1 (]: 3 of 5 PASS not_null_transformations_moving_average_50 ......................... [[32mPASS[0m in 1.13s]
[0m19:09:41.136415 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:41.136457 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:09:41.138400 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.138404 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.140173 [info ] [Thread-1 (]: 4 of 5 START test not_null_transformations_rsi ................................. [RUN]
[0m19:09:41.140280 [info ] [Thread-1 (]: 4 of 5 START test not_null_transformations_rsi ................................. [RUN]
[0m19:09:41.142318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m19:09:41.142539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m19:09:41.144601 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.144562 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.151637 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:09:41.151619 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:09:41.161704 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.163325 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.166602 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:09:41.168226 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:09:41.176085 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:09:41.178849 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m19:09:41.179195 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:09:41.180589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:41.180747 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m19:09:41.182576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:41.796110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m19:09:41.799957 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m19:09:41.929527 [info ] [Thread-1 (]: 4 of 5 PASS not_null_transformations_rsi ....................................... [[32mPASS[0m in 0.79s]
[0m19:09:41.931690 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:41.933318 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:41.934976 [info ] [Thread-1 (]: 5 of 5 START test not_null_transformations_symbol .............................. [RUN]
[0m19:09:41.936580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m19:09:41.938121 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:41.945497 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:09:41.958616 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:41.964126 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:09:41.977022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m19:09:41.977620 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:09:41.979220 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m19:09:41.980992 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m19:09:41.980812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:42.178837 [info ] [Thread-1 (]: 4 of 5 PASS not_null_transformations_rsi ....................................... [[32mPASS[0m in 1.04s]
[0m19:09:42.180902 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:09:42.182541 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:42.184005 [info ] [Thread-1 (]: 5 of 5 START test not_null_transformations_symbol .............................. [RUN]
[0m19:09:42.185558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m19:09:42.187022 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:42.193363 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:09:42.205725 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:42.210169 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:09:42.223175 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:09:42.225271 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m19:09:42.227202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:42.487871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m19:09:42.492176 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m19:09:42.632735 [info ] [Thread-1 (]: 5 of 5 PASS not_null_transformations_symbol .................................... [[32mPASS[0m in 0.69s]
[0m19:09:42.637312 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:42.643333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:42.646043 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_transformations_symbol.c0b2d06825' was properly closed.
[0m19:09:42.648056 [info ] [MainThread]: 
[0m19:09:42.650103 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m19:09:42.653476 [debug] [MainThread]: Command end result
[0m19:09:42.746271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m19:09:42.750673 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m19:09:42.750710 [info ] [MainThread]: 
[0m19:09:42.752685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:42.754277 [info ] [MainThread]: 
[0m19:09:42.756078 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:09:42.758831 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.521338, "process_user_time": 5.488537, "process_kernel_time": 0.942062, "process_mem_max_rss": "218828", "process_in_blocks": "2792", "process_out_blocks": "8"}
[0m19:09:42.760700 [debug] [MainThread]: Command `dbt test` succeeded at 19:09:42.760531 after 8.52 seconds
[0m19:09:42.762407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88283f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88282aaab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88283b0d10>]}
[0m19:09:42.763917 [debug] [MainThread]: Flushing usage events
[0m19:09:42.902579 [info ] [Thread-1 (]: 5 of 5 PASS not_null_transformations_symbol .................................... [[32mPASS[0m in 0.72s]
[0m19:09:42.910188 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:09:42.917513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:42.920051 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_transformations_symbol.c0b2d06825' was properly closed.
[0m19:09:42.922461 [info ] [MainThread]: 
[0m19:09:42.924676 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m19:09:42.928944 [debug] [MainThread]: Command end result
[0m19:09:43.003899 [info ] [MainThread]: 
[0m19:09:43.005560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:43.006997 [info ] [MainThread]: 
[0m19:09:43.009311 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:09:43.011713 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.786589, "process_user_time": 5.628044, "process_kernel_time": 0.901676, "process_mem_max_rss": "226988", "process_in_blocks": "3024", "process_out_blocks": "8"}
[0m19:09:43.013485 [debug] [MainThread]: Command `dbt test` succeeded at 19:09:43.013280 after 8.79 seconds
[0m19:09:43.015163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f28a5b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f27b965d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f06fddf10>]}
[0m19:09:43.016679 [debug] [MainThread]: Flushing usage events
[0m19:09:48.323778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa29bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa5a3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfa77e2a0>]}


============================== 19:09:48.335184 | 53c51137-c002-4153-9c2f-6caeda67c3bf ==============================
[0m19:09:48.335184 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:09:48.338044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:09:48.331714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca17abec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca17ab9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca17ab8f0>]}


============================== 19:09:48.344414 | 801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6 ==============================
[0m19:09:48.344414 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:09:48.346101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:09:50.131753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c84b37ad0>]}
[0m19:09:50.131753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcde90d0>]}
[0m19:09:50.205182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcf91fd1f0>]}
[0m19:09:50.204946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca28a3740>]}
[0m19:09:50.207626 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:50.208381 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:09:50.344702 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:50.349388 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:09:50.559840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:50.559950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:50.561331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:50.561348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:50.630376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdcaf0c50>]}
[0m19:09:50.632081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c84201bb0>]}
[0m19:09:50.798449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc634320>]}
[0m19:09:50.799095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c7fe34140>]}
[0m19:09:50.800264 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m19:09:50.800655 [info ] [MainThread]: Found 2 models, 1 snapshot, 5 data tests, 1 source, 459 macros
[0m19:09:50.802729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcf9ecffe0>]}
[0m19:09:50.803548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c843e86e0>]}
[0m19:09:50.806798 [info ] [MainThread]: 
[0m19:09:50.807313 [info ] [MainThread]: 
[0m19:09:50.808898 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:50.809534 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:50.812452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:09:50.813249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:09:50.837217 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:09:50.838999 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:09:50.839778 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:09:50.840654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:50.841546 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:09:50.843073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:51.539470 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.696 seconds
[0m19:09:51.548247 [debug] [ThreadPool]: On list_dev: Close
[0m19:09:51.583017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.742 seconds
[0m19:09:51.589543 [debug] [ThreadPool]: On list_dev: Close
[0m19:09:51.690487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:09:51.726399 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:09:51.729891 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:09:51.733303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:51.757576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:09:51.799490 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:09:51.802919 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:09:51.805628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:09:52.577337 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.772 seconds
[0m19:09:52.577617 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.844 seconds
[0m19:09:52.589502 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:09:52.590041 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:09:52.733551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8c041400>]}
[0m19:09:52.740385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:52.744604 [info ] [MainThread]: 
[0m19:09:52.752676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc6f8200>]}
[0m19:09:52.758567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:52.766581 [info ] [MainThread]: 
[0m19:09:52.850487 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:52.856782 [info ] [Thread-1 (]: 1 of 1 START snapshot raw_data.raw_data_snapshot ............................... [RUN]
[0m19:09:52.861721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now snapshot.stock_dbt.raw_data_snapshot)
[0m19:09:52.866569 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:52.872932 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:52.878370 [info ] [Thread-1 (]: 1 of 1 START snapshot raw_data.raw_data_snapshot ............................... [RUN]
[0m19:09:52.884724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now snapshot.stock_dbt.raw_data_snapshot)
[0m19:09:52.890093 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:52.913326 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:52.937168 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:53.041898 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:53.043655 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:09:53.044983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:53.048220 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:53.049560 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:09:53.052611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:09:53.596083 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.545 seconds
[0m19:09:53.614550 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.569 seconds
[0m19:09:53.775647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:53.778439 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
create or replace temporary table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m19:09:53.787824 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:53.790971 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
create or replace temporary table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m19:09:54.825045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.044 seconds
[0m19:09:54.838807 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:54.842109 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:09:54.926124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.132 seconds
[0m19:09:54.937710 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:54.940638 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:09:54.977752 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.133 seconds
[0m19:09:54.988264 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:54.990312 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:09:55.054748 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.111 seconds
[0m19:09:55.061481 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.063340 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:09:55.122810 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.130 seconds
[0m19:09:55.137209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.140507 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:09:55.147170 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.082 seconds
[0m19:09:55.161734 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.165136 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:09:55.255356 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.112 seconds
[0m19:09:55.265882 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.269083 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:09:55.276996 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.108 seconds
[0m19:09:55.288300 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.291000 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:09:55.345213 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.073 seconds
[0m19:09:55.381831 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.388263 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:09:55.390222 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.097 seconds
[0m19:09:55.408515 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.410805 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:09:55.496415 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.083 seconds
[0m19:09:55.504578 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.114 seconds
[0m19:09:55.539420 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.541555 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:09:55.545032 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.546988 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        symbol as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(symbol as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        symbol as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:09:55.683227 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.139 seconds
[0m19:09:55.714568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.720225 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:09:55.806859 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.257 seconds
[0m19:09:55.837687 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.113 seconds
[0m19:09:55.842304 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.843659 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.847486 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:09:55.886324 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.891604 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
BEGIN
[0m19:09:55.935931 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m19:09:55.939019 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.961087 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:55.963882 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
BEGIN
[0m19:09:56.035749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m19:09:56.039015 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:56.041979 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
merge into "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:09:56.107327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m19:09:56.112587 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:09:56.118262 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
merge into "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:09:56.581130 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f1d-0004-2cf6-0000-00027a6fd51d
[0m19:09:56.583118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m19:09:56.585517 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: Close
[0m19:09:56.593129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85f1d-0004-2cf3-0000-00027a6fc4e5
[0m19:09:56.594917 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m19:09:56.596498 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: Close
[0m19:09:56.737013 [debug] [Thread-1 (]: Database Error in snapshot raw_data_snapshot (snapshots/raw_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/stock_dbt/snapshots/raw_data_snapshot.sql
[0m19:09:56.745171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '801898d5-c3e0-4c8a-8a0e-c0ac12a91bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c7f5c6c90>]}
[0m19:09:56.749526 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting raw_data.raw_data_snapshot ........................... [[31mERROR[0m in 3.88s]
[0m19:09:56.753294 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:56.755287 [debug] [Thread-1 (]: Database Error in snapshot raw_data_snapshot (snapshots/raw_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/stock_dbt/snapshots/raw_data_snapshot.sql
[0m19:09:56.759106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53c51137-c002-4153-9c2f-6caeda67c3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc4e7920>]}
[0m19:09:56.759143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:56.760842 [debug] [MainThread]: Connection 'snapshot.stock_dbt.raw_data_snapshot' was properly closed.
[0m19:09:56.761639 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting raw_data.raw_data_snapshot ........................... [[31mERROR[0m in 3.87s]
[0m19:09:56.762318 [info ] [MainThread]: 
[0m19:09:56.763790 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.raw_data_snapshot
[0m19:09:56.763979 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.95 seconds (5.95s).
[0m19:09:56.766531 [debug] [MainThread]: Command end result
[0m19:09:56.769047 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:56.770517 [debug] [MainThread]: Connection 'snapshot.stock_dbt.raw_data_snapshot' was properly closed.
[0m19:09:56.772040 [info ] [MainThread]: 
[0m19:09:56.773442 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m19:09:56.775773 [debug] [MainThread]: Command end result
[0m19:09:56.832937 [info ] [MainThread]: 
[0m19:09:56.835005 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:09:56.836608 [info ] [MainThread]: 
[0m19:09:56.838410 [error] [MainThread]:   Database Error in snapshot raw_data_snapshot (snapshots/raw_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/stock_dbt/snapshots/raw_data_snapshot.sql
[0m19:09:56.839750 [info ] [MainThread]: 
[0m19:09:56.841359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:09:56.843710 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.678084, "process_user_time": 5.566892, "process_kernel_time": 1.374295, "process_mem_max_rss": "224648", "process_in_blocks": "1040", "process_out_blocks": "8", "command_success": false}
[0m19:09:56.845407 [debug] [MainThread]: Command `dbt snapshot` failed at 19:09:56.845212 after 8.68 seconds
[0m19:09:56.847109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca1ea06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c84a42c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c843caf90>]}
[0m19:09:56.847684 [info ] [MainThread]: 
[0m19:09:56.848547 [debug] [MainThread]: Flushing usage events
[0m19:09:56.849500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:09:56.851289 [info ] [MainThread]: 
[0m19:09:56.853113 [error] [MainThread]:   Database Error in snapshot raw_data_snapshot (snapshots/raw_data_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target/run/stock_dbt/snapshots/raw_data_snapshot.sql
[0m19:09:56.855641 [info ] [MainThread]: 
[0m19:09:56.857711 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:09:56.860195 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 8.70462, "process_user_time": 5.62318, "process_kernel_time": 1.218522, "process_mem_max_rss": "218736", "process_in_blocks": "304", "process_out_blocks": "8", "command_success": false}
[0m19:09:56.861928 [debug] [MainThread]: Command `dbt snapshot` failed at 19:09:56.861755 after 8.71 seconds
[0m19:09:56.863374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcfb153e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcde5e4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcde5e5010>]}
[0m19:09:56.864894 [debug] [MainThread]: Flushing usage events
[0m19:16:19.271324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4141c7bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4141c7bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4141c7bdd0>]}


============================== 19:16:19.285667 | 0308c99b-6311-4715-b30a-95b8a309bb37 ==============================
[0m19:16:19.285667 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:19.289105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:16:20.583855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4143303ce0>]}
[0m19:16:20.649399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f412c26af90>]}
[0m19:16:20.651347 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:20.767244 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:21.047069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:21.049066 [debug] [MainThread]: Partial parsing: updated file: stock_dbt://snapshots/raw_data_snapshot.sql
[0m19:16:21.392786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4124118830>]}
[0m19:16:21.618714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411ff40d10>]}
[0m19:16:21.621569 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m19:16:21.623880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4143102030>]}
[0m19:16:21.629920 [info ] [MainThread]: 
[0m19:16:21.633468 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:21.647371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:16:21.674083 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:16:21.676104 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:16:21.677767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:22.617914 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.940 seconds
[0m19:16:22.624174 [debug] [ThreadPool]: On list_dev: Close
[0m19:16:22.765694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:16:22.796742 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:16:22.800162 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:16:22.802883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:23.329546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.527 seconds
[0m19:16:23.332676 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:16:23.491519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4124119af0>]}
[0m19:16:23.493593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:23.495731 [info ] [MainThread]: 
[0m19:16:23.507359 [debug] [Thread-1 (]: Began running node model.stock_dbt.raw_data_model
[0m19:16:23.509412 [info ] [Thread-1 (]: 1 of 2 START sql view model raw_data.raw_data_model ............................ [RUN]
[0m19:16:23.511426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now model.stock_dbt.raw_data_model)
[0m19:16:23.513214 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.raw_data_model
[0m19:16:23.522942 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.raw_data_model"
[0m19:16:23.535323 [debug] [Thread-1 (]: Began executing node model.stock_dbt.raw_data_model
[0m19:16:23.571996 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.raw_data_model"
[0m19:16:23.584371 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.raw_data_model"
[0m19:16:23.585759 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.raw_data_model"} */
create or replace   view dev.raw_data.raw_data_model
  
   as (
    -- raw_data_model.sql

WITH raw_data AS (
    SELECT
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM 
        DEV.raw_data.stock_data  -- Refers to the source defined in schema.yml
)

SELECT
    date,
    symbol,
    open,
    high,
    low,
    close,
    volume
FROM raw_data
  );
[0m19:16:23.586983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:24.353843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m19:16:24.385199 [debug] [Thread-1 (]: On model.stock_dbt.raw_data_model: Close
[0m19:16:24.530344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411f55f260>]}
[0m19:16:24.532179 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw_data.raw_data_model ....................... [[32mSUCCESS 1[0m in 1.02s]
[0m19:16:24.533665 [debug] [Thread-1 (]: Finished running node model.stock_dbt.raw_data_model
[0m19:16:24.535727 [debug] [Thread-1 (]: Began running node model.stock_dbt.transformations
[0m19:16:24.537151 [info ] [Thread-1 (]: 2 of 2 START sql table model raw_data.transformations .......................... [RUN]
[0m19:16:24.538674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_dbt.raw_data_model, now model.stock_dbt.transformations)
[0m19:16:24.539984 [debug] [Thread-1 (]: Began compiling node model.stock_dbt.transformations
[0m19:16:24.545408 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_dbt.transformations"
[0m19:16:24.554062 [debug] [Thread-1 (]: Began executing node model.stock_dbt.transformations
[0m19:16:24.583132 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_dbt.transformations"
[0m19:16:24.596793 [debug] [Thread-1 (]: Using snowflake connection "model.stock_dbt.transformations"
[0m19:16:24.598601 [debug] [Thread-1 (]: On model.stock_dbt.transformations: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "model.stock_dbt.transformations"} */
create or replace transient table dev.raw_data.transformations
         as
        (WITH source_data AS (
    SELECT 
        date,
        symbol,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM 
        dev.raw_data.raw_data_model  -- This refers to the raw data model created by dbt
),

-- Calculate 20-day moving average (MA)
ma_20 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 19 PRECEDING AND CURRENT ROW) AS moving_average_20
    FROM source_data
),

-- Calculate 50-day moving average (MA)
ma_50 AS (
    SELECT
        date,
        symbol,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW) AS moving_average_50
    FROM source_data
),

-- Calculate the RSI (Relative Strength Index)
rsi_calc AS (
    SELECT 
        date,
        symbol,
        close,
        -- Calculate the gains and losses based on LAG()
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close,
        CASE
            WHEN close > LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN close - LAG(close) OVER (PARTITION BY symbol ORDER BY date)
            ELSE 0
        END AS gain,
        CASE
            WHEN close < LAG(close) OVER (PARTITION BY symbol ORDER BY date) THEN LAG(close) OVER (PARTITION BY symbol ORDER BY date) - close
            ELSE 0
        END AS loss
    FROM source_data
),

-- Calculate the final RSI
rsi_final AS (
    SELECT
        date,
        symbol,
        -- Calculate average gains and losses
        AVG(gain) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain,
        AVG(loss) OVER (PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss
    FROM rsi_calc
)

SELECT 
    s.date,
    s.symbol,
    ma_20.moving_average_20,
    ma_50.moving_average_50,
    -- Calculate RSI based on average gain and loss
    CASE
        WHEN avg_loss = 0 THEN 100
        ELSE 100 - (100 / (1 + (avg_gain / avg_loss)))
    END AS rsi
FROM source_data s
LEFT JOIN ma_20 ON s.date = ma_20.date AND s.symbol = ma_20.symbol
LEFT JOIN ma_50 ON s.date = ma_50.date AND s.symbol = ma_50.symbol
LEFT JOIN rsi_final ON s.date = rsi_final.date AND s.symbol = rsi_final.symbol
        );
[0m19:16:24.600208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:25.743040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570edf8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570d80e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570d65fec0>]}


============================== 19:16:25.751901 | 36c6579d-c355-4eff-ac1f-91724a0d560a ==============================
[0m19:16:25.751901 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:25.753558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:16:25.991899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.392 seconds
[0m19:16:25.996225 [debug] [Thread-1 (]: On model.stock_dbt.transformations: Close
[0m19:16:26.123913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0308c99b-6311-4715-b30a-95b8a309bb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411f4467b0>]}
[0m19:16:26.126238 [info ] [Thread-1 (]: 2 of 2 OK created sql table model raw_data.transformations ..................... [[32mSUCCESS 1[0m in 1.59s]
[0m19:16:26.128650 [debug] [Thread-1 (]: Finished running node model.stock_dbt.transformations
[0m19:16:26.131530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:26.132953 [debug] [MainThread]: Connection 'model.stock_dbt.transformations' was properly closed.
[0m19:16:26.134238 [info ] [MainThread]: 
[0m19:16:26.135596 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m19:16:26.137534 [debug] [MainThread]: Command end result
[0m19:16:26.206272 [info ] [MainThread]: 
[0m19:16:26.208118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:26.210285 [info ] [MainThread]: 
[0m19:16:26.212123 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:16:26.214024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0709724, "process_user_time": 5.015125, "process_kernel_time": 1.184126, "process_mem_max_rss": "227664", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m19:16:26.215803 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:26.215638 after 7.07 seconds
[0m19:16:26.217370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4145c7aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411ff85be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4141d03e00>]}
[0m19:16:26.218846 [debug] [MainThread]: Flushing usage events
[0m19:16:26.937913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56ebf30aa0>]}
[0m19:16:27.033419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56f0189370>]}
[0m19:16:27.035972 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:27.197443 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:27.432401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:27.434027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:27.501569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570dfca4e0>]}
[0m19:16:27.701667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56eb8bc050>]}
[0m19:16:27.703762 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m19:16:27.705422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56eb8b2fc0>]}
[0m19:16:27.709844 [info ] [MainThread]: 
[0m19:16:27.712070 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:27.714624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:16:27.736075 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:16:27.737601 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:16:27.738893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:28.375560 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.636 seconds
[0m19:16:28.379674 [debug] [ThreadPool]: On list_dev: Close
[0m19:16:28.506905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:16:28.518795 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:16:28.520427 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:16:28.521790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:29.269496 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.748 seconds
[0m19:16:29.272796 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:16:29.409041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570ec00fb0>]}
[0m19:16:29.412187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:29.413855 [info ] [MainThread]: 
[0m19:16:29.424565 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:29.426994 [info ] [Thread-1 (]: 1 of 1 START snapshot raw_data.raw_data_snapshot ............................... [RUN]
[0m19:16:29.428836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now snapshot.stock_dbt.raw_data_snapshot)
[0m19:16:29.430176 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:29.441759 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:29.511485 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:29.513013 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:16:29.514345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:29.940438 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.426 seconds
[0m19:16:30.016171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:30.018872 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
create or replace temporary table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m19:16:30.895743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff027c80770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0270bf230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0289e8140>]}


============================== 19:16:30.905341 | d97d5c41-8a48-4a9a-a705-80d95e1b68c7 ==============================
[0m19:16:30.905341 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:30.907685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:16:31.013516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.993 seconds
[0m19:16:31.022771 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:31.030382 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:16:31.139475 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.107 seconds
[0m19:16:31.151763 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:31.153524 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:16:31.318733 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.164 seconds
[0m19:16:31.325688 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:31.327326 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:16:31.403844 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.075 seconds
[0m19:16:31.409413 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:31.411037 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:16:31.543609 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.131 seconds
[0m19:16:31.552414 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:31.553767 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:16:31.830478 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.275 seconds
[0m19:16:31.866062 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:31.867757 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:16:32.052551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd97d5c41-8a48-4a9a-a705-80d95e1b68c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff009739ac0>]}
[0m19:16:32.123808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd97d5c41-8a48-4a9a-a705-80d95e1b68c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00cba7ce0>]}
[0m19:16:32.126299 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:32.137432 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.268 seconds
[0m19:16:32.148568 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:32.150217 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:16:32.240103 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m19:16:32.242507 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:32.252984 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:32.254462 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
BEGIN
[0m19:16:32.257118 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:32.372079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m19:16:32.373910 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:32.375748 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
merge into "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:16:32.481063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:32.482754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:32.546560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd97d5c41-8a48-4a9a-a705-80d95e1b68c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0093fb140>]}
[0m19:16:32.731286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd97d5c41-8a48-4a9a-a705-80d95e1b68c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff008f81160>]}
[0m19:16:32.732920 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m19:16:32.734582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97d5c41-8a48-4a9a-a705-80d95e1b68c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0093fb3b0>]}
[0m19:16:32.737899 [info ] [MainThread]: 
[0m19:16:32.739911 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:32.746682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_raw_data'
[0m19:16:32.769078 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:16:32.770935 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:16:32.772507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:32.966324 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.589 seconds
[0m19:16:32.968426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:32.970018 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
COMMIT
[0m19:16:33.332273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m19:16:33.376742 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: Close
[0m19:16:33.516845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c6579d-c355-4eff-ac1f-91724a0d560a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570ddfe090>]}
[0m19:16:33.519674 [info ] [Thread-1 (]: 1 of 1 OK snapshotted raw_data.raw_data_snapshot ............................... [[32mSUCCESS 0[0m in 4.09s]
[0m19:16:33.521792 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:33.525845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:33.527697 [debug] [MainThread]: Connection 'snapshot.stock_dbt.raw_data_snapshot' was properly closed.
[0m19:16:33.529419 [info ] [MainThread]: 
[0m19:16:33.530972 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.82 seconds (5.82s).
[0m19:16:33.532933 [debug] [MainThread]: Command end result
[0m19:16:33.560052 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.787 seconds
[0m19:16:33.565014 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:16:33.627788 [info ] [MainThread]: 
[0m19:16:33.629435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:33.630885 [info ] [MainThread]: 
[0m19:16:33.632290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:16:33.634595 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.016495, "process_user_time": 4.599696, "process_kernel_time": 1.117496, "process_mem_max_rss": "226716", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m19:16:33.636356 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:16:33.636191 after 8.02 seconds
[0m19:16:33.637881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570d61e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57111c2de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570d14bd70>]}
[0m19:16:33.639498 [debug] [MainThread]: Flushing usage events
[0m19:16:33.699903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97d5c41-8a48-4a9a-a705-80d95e1b68c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff009a51b50>]}
[0m19:16:33.703854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:33.707165 [info ] [MainThread]: 
[0m19:16:33.726485 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:16:33.729101 [info ] [Thread-1 (]: 1 of 5 START test not_null_transformations_date ................................ [RUN]
[0m19:16:33.731174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now test.stock_dbt.not_null_transformations_date.eb21993fae)
[0m19:16:33.732926 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:16:33.758416 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:16:33.771857 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:16:33.797315 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:16:33.808767 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_date.eb21993fae"
[0m19:16:33.810088 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_date.eb21993fae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.raw_data.transformations
where date is null



      
    ) dbt_internal_test
[0m19:16:33.811499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:34.492310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m19:16:34.507190 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_date.eb21993fae: Close
[0m19:16:34.622651 [info ] [Thread-1 (]: 1 of 5 PASS not_null_transformations_date ...................................... [[32mPASS[0m in 0.89s]
[0m19:16:34.627275 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_date.eb21993fae
[0m19:16:34.630571 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:16:34.633697 [info ] [Thread-1 (]: 2 of 5 START test not_null_transformations_moving_average_20 ................... [RUN]
[0m19:16:34.636674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_date.eb21993fae, now test.stock_dbt.not_null_transformations_moving_average_20.222d613303)
[0m19:16:34.639449 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:16:34.648379 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:16:34.664128 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:16:34.669492 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:16:34.685210 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"
[0m19:16:34.687135 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_20.222d613303"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_20
from dev.raw_data.transformations
where moving_average_20 is null



      
    ) dbt_internal_test
[0m19:16:34.689263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:35.314484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m19:16:35.321890 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_20.222d613303: Close
[0m19:16:35.450298 [info ] [Thread-1 (]: 2 of 5 PASS not_null_transformations_moving_average_20 ......................... [[32mPASS[0m in 0.81s]
[0m19:16:35.454569 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_20.222d613303
[0m19:16:35.457862 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:16:35.461187 [info ] [Thread-1 (]: 3 of 5 START test not_null_transformations_moving_average_50 ................... [RUN]
[0m19:16:35.464498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_20.222d613303, now test.stock_dbt.not_null_transformations_moving_average_50.dfac235456)
[0m19:16:35.467524 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:16:35.480526 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:16:35.508993 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:16:35.517184 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:16:35.544986 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"
[0m19:16:35.548145 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_moving_average_50.dfac235456"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_50
from dev.raw_data.transformations
where moving_average_50 is null



      
    ) dbt_internal_test
[0m19:16:35.551308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:36.279203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m19:16:36.291299 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_moving_average_50.dfac235456: Close
[0m19:16:36.425915 [info ] [Thread-1 (]: 3 of 5 PASS not_null_transformations_moving_average_50 ......................... [[32mPASS[0m in 0.96s]
[0m19:16:36.429370 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_moving_average_50.dfac235456
[0m19:16:36.431772 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:16:36.433828 [info ] [Thread-1 (]: 4 of 5 START test not_null_transformations_rsi ................................. [RUN]
[0m19:16:36.435988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_moving_average_50.dfac235456, now test.stock_dbt.not_null_transformations_rsi.06d0e42287)
[0m19:16:36.438103 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:16:36.448983 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:16:36.462850 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:16:36.467178 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:16:36.480806 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_rsi.06d0e42287"
[0m19:16:36.482393 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_rsi.06d0e42287"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi
from dev.raw_data.transformations
where rsi is null



      
    ) dbt_internal_test
[0m19:16:36.483840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:37.011931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m19:16:37.022114 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_rsi.06d0e42287: Close
[0m19:16:37.163219 [info ] [Thread-1 (]: 4 of 5 PASS not_null_transformations_rsi ....................................... [[32mPASS[0m in 0.73s]
[0m19:16:37.167985 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_rsi.06d0e42287
[0m19:16:37.171554 [debug] [Thread-1 (]: Began running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:16:37.176961 [info ] [Thread-1 (]: 5 of 5 START test not_null_transformations_symbol .............................. [RUN]
[0m19:16:37.180167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_dbt.not_null_transformations_rsi.06d0e42287, now test.stock_dbt.not_null_transformations_symbol.c0b2d06825)
[0m19:16:37.182974 [debug] [Thread-1 (]: Began compiling node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:16:37.199115 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:16:37.223309 [debug] [Thread-1 (]: Began executing node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:16:37.230354 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:16:37.244415 [debug] [Thread-1 (]: Using snowflake connection "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"
[0m19:16:37.246460 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "test.stock_dbt.not_null_transformations_symbol.c0b2d06825"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.raw_data.transformations
where symbol is null



      
    ) dbt_internal_test
[0m19:16:37.248413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:38.078938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m19:16:38.085639 [debug] [Thread-1 (]: On test.stock_dbt.not_null_transformations_symbol.c0b2d06825: Close
[0m19:16:38.271496 [info ] [Thread-1 (]: 5 of 5 PASS not_null_transformations_symbol .................................... [[32mPASS[0m in 1.09s]
[0m19:16:38.275422 [debug] [Thread-1 (]: Finished running node test.stock_dbt.not_null_transformations_symbol.c0b2d06825
[0m19:16:38.280164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:38.282232 [debug] [MainThread]: Connection 'test.stock_dbt.not_null_transformations_symbol.c0b2d06825' was properly closed.
[0m19:16:38.284161 [info ] [MainThread]: 
[0m19:16:38.286392 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m19:16:38.292516 [debug] [MainThread]: Command end result
[0m19:16:38.415366 [info ] [MainThread]: 
[0m19:16:38.417257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:38.419088 [info ] [MainThread]: 
[0m19:16:38.421254 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:16:38.424643 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.672399, "process_user_time": 4.998562, "process_kernel_time": 1.019601, "process_mem_max_rss": "229620", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m19:16:38.426610 [debug] [MainThread]: Command `dbt test` succeeded at 19:16:38.426375 after 7.67 seconds
[0m19:16:38.428510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff02685c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00cba6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff026ed26c0>]}
[0m19:16:38.430252 [debug] [MainThread]: Flushing usage events
[0m19:16:43.486541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade7fcc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade8fd51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade97d17c0>]}


============================== 19:16:43.494959 | ea563c81-e3bb-4199-852a-328d148e9115 ==============================
[0m19:16:43.494959 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:43.496627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt --project-dir /opt/airflow/dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:16:44.567470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdaa2360>]}
[0m19:16:44.640989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadcdaa1400>]}
[0m19:16:44.643077 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:16:44.750907 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:44.948381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:44.950033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:45.025285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc6322b70>]}
[0m19:16:45.225938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc609f770>]}
[0m19:16:45.227474 [info ] [MainThread]: Found 2 models, 5 data tests, 1 snapshot, 1 source, 459 macros
[0m19:16:45.228715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd2062d50>]}
[0m19:16:45.231958 [info ] [MainThread]: 
[0m19:16:45.234069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:45.236360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m19:16:45.255109 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m19:16:45.257676 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m19:16:45.260210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:45.969675 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.709 seconds
[0m19:16:45.976033 [debug] [ThreadPool]: On list_dev: Close
[0m19:16:46.151084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_raw_data)
[0m19:16:46.195261 [debug] [ThreadPool]: Using snowflake connection "list_dev_raw_data"
[0m19:16:46.198194 [debug] [ThreadPool]: On list_dev_raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "connection_name": "list_dev_raw_data"} */
show objects in dev.raw_data limit 10000
[0m19:16:46.201126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:46.817742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.615 seconds
[0m19:16:46.830427 [debug] [ThreadPool]: On list_dev_raw_data: Close
[0m19:16:46.965549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadc5ecc080>]}
[0m19:16:46.972036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:46.976528 [info ] [MainThread]: 
[0m19:16:47.022771 [debug] [Thread-1 (]: Began running node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:47.028159 [info ] [Thread-1 (]: 1 of 1 START snapshot raw_data.raw_data_snapshot ............................... [RUN]
[0m19:16:47.033196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_raw_data, now snapshot.stock_dbt.raw_data_snapshot)
[0m19:16:47.038631 [debug] [Thread-1 (]: Began compiling node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:47.078275 [debug] [Thread-1 (]: Began executing node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:47.182970 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:47.185090 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:16:47.186602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:47.676390 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.489 seconds
[0m19:16:47.764020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:47.766242 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
create or replace temporary table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m19:16:48.523520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m19:16:48.538774 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:48.543762 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:16:48.655198 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.107 seconds
[0m19:16:48.676874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:48.682233 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:16:48.791074 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.103 seconds
[0m19:16:48.811016 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:48.815840 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:16:48.923502 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.103 seconds
[0m19:16:48.943071 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:48.948093 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
[0m19:16:49.093586 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.140 seconds
[0m19:16:49.128427 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:49.131474 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
describe table "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp"
[0m19:16:49.344659 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.210 seconds
[0m19:16:49.485603 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:49.489950 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        

    with snapshot_query as (

        

    

    SELECT 
        date,
        symbol,
        open,
        max_value AS high,
        min_value AS low,
        close,
        volume
    FROM DEV.raw_data.stock_data


    ),

    snapshotted_data as (

        select *, 
    
        date as dbt_unique_key
    

        from "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        date as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m19:16:49.860934 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.367 seconds
[0m19:16:49.895061 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:49.900818 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m19:16:50.002391 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m19:16:50.006815 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:50.039306 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:50.042895 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
BEGIN
[0m19:16:50.266398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m19:16:50.273080 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:50.277842 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
merge into "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "DEV"."RAW_DATA"."RAW_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("DATE", "SYMBOL", "OPEN", "HIGH", "LOW", "CLOSE", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:16:51.086026 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.803 seconds
[0m19:16:51.093690 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_dbt.raw_data_snapshot"
[0m19:16:51.100418 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "stock_dbt", "target_name": "dev", "node_id": "snapshot.stock_dbt.raw_data_snapshot"} */
COMMIT
[0m19:16:51.493033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m19:16:51.551039 [debug] [Thread-1 (]: On snapshot.stock_dbt.raw_data_snapshot: Close
[0m19:16:51.690124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea563c81-e3bb-4199-852a-328d148e9115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade848e0c0>]}
[0m19:16:51.696360 [info ] [Thread-1 (]: 1 of 1 OK snapshotted raw_data.raw_data_snapshot ............................... [[32mSUCCESS 0[0m in 4.65s]
[0m19:16:51.702850 [debug] [Thread-1 (]: Finished running node snapshot.stock_dbt.raw_data_snapshot
[0m19:16:51.712849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:51.718059 [debug] [MainThread]: Connection 'snapshot.stock_dbt.raw_data_snapshot' was properly closed.
[0m19:16:51.723031 [info ] [MainThread]: 
[0m19:16:51.727580 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m19:16:51.734093 [debug] [MainThread]: Command end result
[0m19:16:51.878764 [info ] [MainThread]: 
[0m19:16:51.882205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:51.884484 [info ] [MainThread]: 
[0m19:16:51.886584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:16:51.889363 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.548654, "process_user_time": 5.04079, "process_kernel_time": 1.133432, "process_mem_max_rss": "226712", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m19:16:51.891255 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:16:51.891013 after 8.55 seconds
[0m19:16:51.893015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade7fcc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade9667b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fade7b82690>]}
[0m19:16:51.894634 [debug] [MainThread]: Flushing usage events
